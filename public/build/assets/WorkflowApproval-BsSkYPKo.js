import{c as n,a as p,u,h as E,w as M,b as e,d as f,o as r,F as c,g as v,n as O,t as i,e as h,x as q,y as Q,j as x,v as w,k as g,s as C,m as A,O as G,B as H}from"./app-CGAYEMLV.js";import{k as j,h as J,_ as K}from"./AppLayout-pcWSJUwb.js";import{r as X}from"./QuestionMarkCircleIcon-BPSqCWfZ.js";import{r as W}from"./PlusIcon-CRPNCjk5.js";import{r as Y}from"./PencilIcon-C0B6P2aO.js";import{r as F}from"./TrashIcon-DGDSkdoX.js";import{r as Z}from"./UserIcon-CWgtNxmy.js";import{r as ee}from"./ShieldCheckIcon-DzXXDVxC.js";import{r as te}from"./ChevronUpIcon-DAc9eV50.js";/* empty css            */import"./XMarkIcon-CDfMTWhX.js";import"./SunIcon-CR0rIyXt.js";import"./WrenchScrewdriverIcon-D52asUGE.js";import"./DocumentPlusIcon-DVpTdb5w.js";import"./TruckIcon-D3spUp-g.js";import"./DocumentTextIcon-DPNDbCJ2.js";import"./ShoppingCartIcon-Cb0EUpxa.js";import"./MapPinIcon-k7_OKdPW.js";import"./SparklesIcon-Bd4AX5UM.js";import"./CubeIcon-CdhOWFeo.js";import"./ClockIcon-DDq8GnAr.js";import"./CheckCircleIcon-NDF4lCA2.js";const se={class:"p-6 space-y-6"},oe={class:"flex items-center justify-between"},le={class:"flex items-center gap-3"},ae={class:"p-2 bg-gradient-to-br from-violet-600 to-purple-600 rounded-xl shadow-lg"},re={class:"flex items-center gap-2"},ne={href:"/guide/workflow-approval.html",target:"_blank",class:"flex items-center gap-2 px-4 py-2 bg-slate-100 dark:bg-slate-700 hover:bg-slate-200 dark:hover:bg-slate-600 text-slate-700 dark:text-slate-300 font-semibold rounded-xl transition-all"},de={class:"space-y-4"},ie={class:"p-4 flex items-center justify-between"},ue={class:"flex items-center gap-4"},pe={class:"font-bold text-slate-900 dark:text-white"},ce={class:"text-sm text-slate-500"},me={key:0},be={class:"flex items-center gap-2"},ve=["onClick"],xe=["onClick"],ge=["onClick"],_e={class:"px-4 pb-4"},fe={class:"flex items-center gap-2 flex-wrap"},he={class:"flex items-center gap-2 px-3 py-1.5 bg-slate-100 dark:bg-slate-700 rounded-lg"},ye={class:"text-sm font-medium text-slate-700 dark:text-slate-300"},ke={key:0,class:"text-slate-400"},we={key:0,class:"glass-card rounded-2xl p-12 text-center"},Ce={key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4"},Ae={class:"bg-white dark:bg-slate-800 rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto"},Ue={class:"p-6 border-b border-slate-200 dark:border-slate-700"},$e={class:"text-xl font-bold text-slate-900 dark:text-white"},Ve={class:"p-6 space-y-6"},Se={class:"grid grid-cols-2 gap-4"},Oe={class:"col-span-2"},je=["value"],We={class:"p-4 bg-slate-50 dark:bg-slate-700/50 rounded-xl"},Fe={class:"flex items-center gap-2"},Te=["value"],Ne=["value"],De={class:"flex items-center justify-between mb-3"},Pe={class:"space-y-3"},Be={class:"flex flex-col gap-1"},Ie=["onClick","disabled"],Re=["onClick","disabled"],Le={class:"w-8 h-8 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center font-bold text-sm"},ze=["onUpdate:modelValue"],Ee=["onUpdate:modelValue"],Me={value:""},qe=["value"],Qe=["value"],Ge=["onClick","disabled"],He={class:"p-6 border-t border-slate-200 dark:border-slate-700 flex justify-end gap-3"},Je=["disabled"],_t={__name:"WorkflowApproval",props:{workflows:Array,documentTypes:Object,conditionOperators:Object,users:Array,roles:Array},setup(m){const U=m,y=A(!1),b=A(null),_=A(!1),k=()=>({name:"",document_type:"PurchaseOrder",description:"",is_active:!0,condition_field:"total",condition_operator:">",condition_value:null,priority:0,steps:[{approver_type:"role",approver_id:null,can_skip:!1,timeout_days:null}]}),l=G(k()),T={PurchaseOrder:[{value:"total",label:"Total Amount"},{value:"subtotal",label:"Subtotal"}],PurchaseRequest:[{value:"total",label:"Total Amount"}],SalesOrder:[{value:"total",label:"Total Amount"},{value:"subtotal",label:"Subtotal"}],SalesQuotation:[{value:"total",label:"Total Amount"}]},N=H(()=>T[l.document_type]||[]),$=(o=null)=>{o?(b.value=o,Object.assign(l,{name:o.name,document_type:o.document_type,description:o.description||"",is_active:o.is_active,condition_field:o.condition_field||"total",condition_operator:o.condition_operator||">",condition_value:o.condition_value,priority:o.priority,steps:o.steps.map(t=>({approver_type:t.approver_type,approver_id:t.approver_id,can_skip:t.can_skip,timeout_days:t.timeout_days}))})):(b.value=null,Object.assign(l,k())),y.value=!0},V=()=>{y.value=!1,b.value=null,Object.assign(l,k())},D=()=>{l.steps.push({approver_type:"role",approver_id:null,can_skip:!1,timeout_days:null})},P=o=>{l.steps.length>1&&l.steps.splice(o,1)},S=(o,t)=>{const s=o+t;if(s>=0&&s<l.steps.length){const a=l.steps[o];l.steps[o]=l.steps[s],l.steps[s]=a}},B=()=>{_.value=!0;const o=b.value?route("settings.workflow.update",b.value.id):route("settings.workflow.store"),t=b.value?"put":"post";C[t](o,l,{onSuccess:()=>V(),onFinish:()=>_.value=!1})},I=o=>{confirm("Are you sure you want to delete this workflow?")&&C.delete(route("settings.workflow.destroy",o.id))},R=o=>{C.post(route("settings.workflow.toggle",o.id))},L=o=>{if(o.approver_type==="user"){const t=U.users.find(s=>s.id===o.approver_id);return t?t.name:"Unknown User"}else{const t=U.roles.find(s=>s.id===o.approver_id);return t?t.name:"Unknown Role"}},z=o=>o?new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(o):"-";return(o,t)=>(r(),n(c,null,[p(u(E),{title:"Workflow Approval"}),p(K,{title:"Workflow Approval"},{default:M(()=>[e("div",se,[e("div",oe,[e("div",le,[e("div",ae,[p(u(j),{class:"h-6 w-6 text-white"})]),t[7]||(t[7]=e("div",null,[e("h2",{class:"text-xl font-bold text-slate-900 dark:text-white"},"Workflow Approval"),e("p",{class:"text-sm text-slate-500 dark:text-slate-400"},"Configure multi-level approval chains for documents")],-1))]),e("div",re,[e("a",ne,[p(u(X),{class:"h-5 w-5"}),t[8]||(t[8]=f(" Panduan ",-1))]),e("button",{onClick:t[0]||(t[0]=s=>$()),class:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white font-semibold rounded-xl shadow-lg transition-all"},[p(u(W),{class:"h-5 w-5"}),t[9]||(t[9]=f(" Add Workflow ",-1))])])]),e("div",de,[(r(!0),n(c,null,v(m.workflows,s=>(r(),n("div",{key:s.id,class:"glass-card rounded-2xl overflow-hidden"},[e("div",ie,[e("div",ue,[e("div",{class:O(["w-3 h-3 rounded-full",s.is_active?"bg-green-500":"bg-slate-400"])},null,2),e("div",null,[e("h3",pe,i(s.name),1),e("p",ce,[f(i(m.documentTypes[s.document_type])+" ",1),s.condition_field&&s.condition_value?(r(),n("span",me," — "+i(s.condition_field)+" "+i(s.condition_operator)+" "+i(z(s.condition_value)),1)):h("",!0)])])]),e("div",be,[e("button",{onClick:a=>R(s),class:O(["px-3 py-1.5 rounded-lg text-sm font-medium transition-colors",s.is_active?"bg-green-100 text-green-700 hover:bg-green-200":"bg-slate-100 text-slate-600 hover:bg-slate-200"])},i(s.is_active?"Active":"Inactive"),11,ve),e("button",{onClick:a=>$(s),class:"p-2 text-slate-500 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors"},[p(u(Y),{class:"h-5 w-5"})],8,xe),e("button",{onClick:a=>I(s),class:"p-2 text-slate-500 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors"},[p(u(F),{class:"h-5 w-5"})],8,ge)])]),e("div",_e,[e("div",fe,[(r(!0),n(c,null,v(s.steps,(a,d)=>(r(),n(c,{key:d},[e("div",he,[(r(),q(Q(a.approver_type==="user"?u(Z):u(ee)),{class:"h-4 w-4 text-slate-500"})),e("span",ye,i(L(a)),1)]),d<s.steps.length-1?(r(),n("span",ke,"→")):h("",!0)],64))),128))])])]))),128)),m.workflows.length===0?(r(),n("div",we,[p(u(j),{class:"h-12 w-12 text-slate-400 mx-auto mb-4"}),t[10]||(t[10]=e("h3",{class:"font-semibold text-slate-600 dark:text-slate-400"},"No workflows configured",-1)),t[11]||(t[11]=e("p",{class:"text-sm text-slate-500 mt-1"},"Create your first workflow to enable document approvals",-1))])):h("",!0)]),y.value?(r(),n("div",Ce,[e("div",Ae,[e("div",Ue,[e("h3",$e,i(b.value?"Edit Workflow":"New Workflow"),1)]),e("div",Ve,[e("div",Se,[e("div",Oe,[t[12]||(t[12]=e("label",{class:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1"},"Workflow Name",-1)),x(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>l.name=s),type:"text",class:"w-full px-4 py-2 rounded-xl border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-900 dark:text-white focus:ring-2 focus:ring-blue-500",placeholder:"e.g. Large PO Approval"},null,512),[[w,l.name]])]),e("div",null,[t[13]||(t[13]=e("label",{class:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1"},"Document Type",-1)),x(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>l.document_type=s),class:"w-full px-4 py-2 rounded-xl border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-900 dark:text-white focus:ring-2 focus:ring-blue-500"},[(r(!0),n(c,null,v(m.documentTypes,(s,a)=>(r(),n("option",{key:a,value:a},i(s),9,je))),128))],512),[[g,l.document_type]])]),e("div",null,[t[14]||(t[14]=e("label",{class:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1"},"Priority",-1)),x(e("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>l.priority=s),type:"number",class:"w-full px-4 py-2 rounded-xl border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-900 dark:text-white focus:ring-2 focus:ring-blue-500",placeholder:"0"},null,512),[[w,l.priority,void 0,{number:!0}]])])]),e("div",We,[t[15]||(t[15]=e("label",{class:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-3"},"Condition (Optional)",-1)),e("div",Fe,[x(e("select",{"onUpdate:modelValue":t[4]||(t[4]=s=>l.condition_field=s),class:"px-3 py-2 rounded-lg border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-900 dark:text-white"},[(r(!0),n(c,null,v(N.value,s=>(r(),n("option",{key:s.value,value:s.value},i(s.label),9,Te))),128))],512),[[g,l.condition_field]]),x(e("select",{"onUpdate:modelValue":t[5]||(t[5]=s=>l.condition_operator=s),class:"px-3 py-2 rounded-lg border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-900 dark:text-white"},[(r(!0),n(c,null,v(m.conditionOperators,(s,a)=>(r(),n("option",{key:a,value:a},i(a)+" ("+i(s)+")",9,Ne))),128))],512),[[g,l.condition_operator]]),x(e("input",{"onUpdate:modelValue":t[6]||(t[6]=s=>l.condition_value=s),type:"number",class:"flex-1 px-3 py-2 rounded-lg border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-900 dark:text-white",placeholder:"Value (e.g. 50000000)"},null,512),[[w,l.condition_value,void 0,{number:!0}]])]),t[16]||(t[16]=e("p",{class:"text-xs text-slate-500 mt-2"},"Leave value empty to apply this workflow to all documents of this type",-1))]),e("div",null,[e("div",De,[t[18]||(t[18]=e("label",{class:"text-sm font-medium text-slate-700 dark:text-slate-300"},"Approval Steps",-1)),e("button",{onClick:D,type:"button",class:"text-sm text-blue-600 hover:text-blue-700 font-medium flex items-center gap-1"},[p(u(W),{class:"h-4 w-4"}),t[17]||(t[17]=f(" Add Step ",-1))])]),e("div",Pe,[(r(!0),n(c,null,v(l.steps,(s,a)=>(r(),n("div",{key:a,class:"flex items-center gap-3 p-3 bg-slate-50 dark:bg-slate-700/50 rounded-xl"},[e("div",Be,[e("button",{onClick:d=>S(a,-1),disabled:a===0,class:"p-1 text-slate-400 hover:text-slate-600 disabled:opacity-30"},[p(u(te),{class:"h-4 w-4"})],8,Ie),e("button",{onClick:d=>S(a,1),disabled:a===l.steps.length-1,class:"p-1 text-slate-400 hover:text-slate-600 disabled:opacity-30"},[p(u(J),{class:"h-4 w-4"})],8,Re)]),e("div",Le,i(a+1),1),x(e("select",{"onUpdate:modelValue":d=>s.approver_type=d,class:"px-3 py-2 rounded-lg border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-900 dark:text-white"},[...t[19]||(t[19]=[e("option",{value:"user"},"User",-1),e("option",{value:"role"},"Role",-1)])],8,ze),[[g,s.approver_type]]),x(e("select",{"onUpdate:modelValue":d=>s.approver_id=d,class:"flex-1 px-3 py-2 rounded-lg border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-900 dark:text-white"},[e("option",Me,"Select "+i(s.approver_type==="user"?"User":"Role"),1),s.approver_type==="user"?(r(!0),n(c,{key:0},v(m.users,d=>(r(),n("option",{key:d.id,value:d.id},i(d.name),9,qe))),128)):(r(!0),n(c,{key:1},v(m.roles,d=>(r(),n("option",{key:d.id,value:d.id},i(d.name),9,Qe))),128))],8,Ee),[[g,s.approver_id]]),e("button",{onClick:d=>P(a),disabled:l.steps.length<=1,class:"p-2 text-slate-400 hover:text-red-500 disabled:opacity-30"},[p(u(F),{class:"h-5 w-5"})],8,Ge)]))),128))])])]),e("div",He,[e("button",{onClick:V,class:"px-4 py-2 text-slate-600 hover:bg-slate-100 rounded-xl transition-colors"}," Cancel "),e("button",{onClick:B,disabled:_.value||!l.name||l.steps.some(s=>!s.approver_id),class:"px-6 py-2 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white font-semibold rounded-xl shadow-lg transition-all disabled:opacity-50"},i(_.value?"Saving...":b.value?"Update":"Create"),9,Je)])])])):h("",!0)])]),_:1})],64))}};export{_t as default};
