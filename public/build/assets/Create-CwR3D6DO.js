import{f as A,C as D,c as d,a as o,u as r,h as M,w as g,b as e,l as y,d as h,i as B,j as p,o as n,F as f,g as w,t as m,k as T,v as c,e as S,n as P,z as I,B as O,m as j}from"./app-BTAJ41wv.js";import{_ as F}from"./AppLayout-BCibAEMC.js";import{a as L}from"./helpers-DnzC1tLX.js";import{_ as V}from"./SearchableSelect-CHQBA0X8.js";import{_ as z}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{r as E}from"./ArrowLeftIcon-CPIts35J.js";import{r as G}from"./PlusIcon-DW9RnPH0.js";import{r as J}from"./CalendarIcon-DXPqIyV9.js";import{r as _}from"./TruckIcon-B3V2yp2Y.js";import{r as K}from"./UserIcon-C-doam-j.js";import{r as Q}from"./MapPinIcon-8glMaH6V.js";import{r as R}from"./TrashIcon-C45Fwwza.js";/* empty css            */import"./XMarkIcon-DicknEfS.js";import"./SunIcon-DiirzqGB.js";import"./WrenchScrewdriverIcon-DtqsjiHd.js";import"./DocumentPlusIcon-CEFQa3Ky.js";import"./DocumentTextIcon-BYfCv1H3.js";import"./ShoppingCartIcon-W7ARKyC8.js";import"./SparklesIcon-Cku5r5l2.js";import"./CubeIcon-DSu9RNJ8.js";import"./ClockIcon-W3FgrKI1.js";import"./CheckCircleIcon-CwjMhm97.js";import"./ShieldCheckIcon-BylQTbVF.js";import"./transition-C5Skt4Hw.js";const W={class:"max-w-full px-4 sm:px-6 lg:px-8 mx-auto"},H={class:"grid grid-cols-1 xl:grid-cols-12 gap-6"},X={class:"xl:col-span-4 space-y-6"},Y={class:"glass-card rounded-2xl p-6 border border-slate-200 dark:border-slate-800 shadow-sm"},Z={class:"flex items-center gap-2 mb-4"},ee={class:"space-y-4"},te=["value"],se={class:"relative"},ae={class:"glass-card rounded-2xl p-6 border border-slate-200 dark:border-slate-800 shadow-sm"},re={class:"flex items-center gap-2 mb-4"},le={class:"space-y-4"},oe={key:0},ie={class:"relative"},de={class:"glass-card rounded-2xl p-6 border border-slate-200 dark:border-slate-800 shadow-sm"},ne={class:"flex items-center gap-2 mb-4"},pe={class:"xl:col-span-8 space-y-6"},ue={class:"glass-card rounded-2xl overflow-hidden border border-slate-200 dark:border-slate-800 shadow-sm min-h-[400px]"},me={class:"overflow-x-auto max-h-[600px] overflow-y-auto custom-scrollbar relative"},ce={class:"w-full text-left"},xe={class:"divide-y divide-slate-100 dark:divide-slate-800/50"},be={class:"px-6 py-4"},ge={class:"text-sm font-bold text-slate-900 dark:text-white"},he={class:"text-[10px] text-slate-500 font-mono"},fe={class:"px-6 py-4 text-center"},_e={class:"text-xs font-bold px-2.5 py-1 rounded-lg bg-blue-500/10 text-blue-500"},ve={class:"px-6 py-4 text-center"},ke=["onUpdate:modelValue","max"],ye={class:"px-6 py-4 text-xs text-slate-500 font-medium"},we={class:"px-6 py-4"},Se=["onUpdate:modelValue"],Oe={class:"px-6 py-4 text-right"},Ve=["onClick"],Ce={key:0},Ne={colspan:"6",class:"px-6 py-12 text-center"},Ue={key:0,class:"flex flex-col items-center gap-3"},$e={key:1,class:"flex flex-col items-center gap-2"},qe={class:"flex items-center justify-between glass-card rounded-2xl p-6 border border-slate-200 dark:border-slate-800 shadow-lg"},Ae={class:"flex items-center gap-3"},De=["disabled"],Me={__name:"Create",props:{salesOrder:Object,salesOrders:Array,vehicles:Array,warehouses:Array},setup(v){const u=v,C=O(()=>u.salesOrders.map(l=>({id:l.id,label:`${l.so_number} - ${l.customer?.name}`}))),N=O(()=>[...u.vehicles.map(l=>({id:l.id,label:`${l.license_plate} - ${l.driver_name||"No Driver"}`})),{id:"manual",label:"Input Manual (No Truk Baru)"}]),a=A({sales_order_id:u.salesOrder?.id||"",warehouse_id:u.salesOrder?.warehouse_id||"",delivery_date:new Date().toISOString().split("T")[0],shipping_address:u.salesOrder?.shipping_address||"",vehicle_id:"",vehicle_number:"",driver_name:"",items:[]}),b=j(!1),k=async l=>{if(l){b.value=!0;try{const s=(await I.get(route("sales.deliveries.so-items",l))).data;a.warehouse_id=s.warehouse_id,a.shipping_address=s.shipping_address,s.items.length===0&&alert("Tidak ada item yang tersisa untuk dikirim pada Sales Order ini."),a.items=s.items.map(i=>({sales_order_item_id:i.sales_order_item_id,product_id:i.product_id,name:i.name,sku:i.sku,qty_ordered:i.qty_ordered,remaining:i.remaining,qty_delivered:i.remaining,unit_name:i.unit_name,notes:""}))}catch(t){console.error("Error fetching SO Items:",t),alert("Gagal memuat item Sales Order.")}finally{b.value=!1}}},U=()=>{const l=u.vehicles.find(t=>t.id===a.vehicle_id);l?(a.vehicle_number=l.license_plate,a.driver_name=l.driver_name||""):a.vehicle_id!=="manual"&&(a.vehicle_number="",a.driver_name="")},$=l=>{a.items.splice(l,1)},q=()=>{a.post(route("sales.deliveries.store"),{onSuccess:()=>{},onError:l=>{console.error(l)}})};return D(()=>{a.sales_order_id&&k(a.sales_order_id)}),(l,t)=>(n(),d(f,null,[o(r(M),{title:"Create Delivery Order"}),o(F,{title:"Deliveries"},{default:g(()=>[e("div",W,[o(r(y),{href:l.route("sales.deliveries.index"),class:"inline-flex items-center gap-2 mb-4 text-sm text-slate-500 dark:text-slate-400 hover:text-slate-900 dark:text-white transition-colors"},{default:g(()=>[o(r(E),{class:"h-4 w-4"}),t[7]||(t[7]=h(" Back to List ",-1))]),_:1},8,["href"]),t[24]||(t[24]=e("div",{class:"flex items-center justify-between mb-6"},[e("div",null,[e("h2",{class:"text-2xl font-bold text-slate-900 dark:text-white tracking-tight"},"Create New Delivery"),e("p",{class:"text-sm text-slate-500 mt-1"},"Siapkan Surat Jalan baru untuk pengiriman barang ke customer.")])],-1)),e("form",{onSubmit:B(q,["prevent"]),class:"space-y-6"},[e("div",H,[e("div",X,[e("div",Y,[e("div",Z,[o(r(G),{class:"h-5 w-5 text-blue-500"}),t[8]||(t[8]=e("h3",{class:"text-sm font-bold text-slate-900 dark:text-white uppercase tracking-widest"},"Reference & Date",-1))]),e("div",ee,[e("div",null,[t[9]||(t[9]=e("label",{class:"block text-[10px] font-bold text-slate-500 uppercase tracking-tighter mb-1.5"},"Sales Order",-1)),o(V,{modelValue:r(a).sales_order_id,"onUpdate:modelValue":t[0]||(t[0]=s=>r(a).sales_order_id=s),options:C.value,placeholder:"Cari No SO...",onChange:k,required:""},null,8,["modelValue","options"])]),e("div",null,[t[11]||(t[11]=e("label",{class:"block text-[10px] font-bold text-slate-500 uppercase tracking-tighter mb-1.5"},"Warehouse Pengirim",-1)),p(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>r(a).warehouse_id=s),class:"w-full rounded-xl border-0 bg-slate-50 dark:bg-slate-800 py-2.5 text-sm text-slate-900 dark:text-white focus:ring-2 focus:ring-blue-500/50",required:""},[t[10]||(t[10]=e("option",{value:""},"Pilih Gudang",-1)),(n(!0),d(f,null,w(v.warehouses,s=>(n(),d("option",{key:s.id,value:s.id},m(s.name),9,te))),128))],512),[[T,r(a).warehouse_id]])]),e("div",null,[t[12]||(t[12]=e("label",{class:"block text-[10px] font-bold text-slate-500 uppercase tracking-tighter mb-1.5"},"Tanggal Kirim",-1)),e("div",se,[o(r(J),{class:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400"}),p(e("input",{type:"date","onUpdate:modelValue":t[2]||(t[2]=s=>r(a).delivery_date=s),class:"w-full rounded-xl border-0 bg-slate-50 dark:bg-slate-800 py-2.5 pl-10 text-sm text-slate-900 dark:text-white focus:ring-2 focus:ring-blue-500/50 shadow-sm",required:""},null,512),[[c,r(a).delivery_date]])])])])]),e("div",ae,[e("div",re,[o(r(_),{class:"h-5 w-5 text-emerald-500"}),t[13]||(t[13]=e("h3",{class:"text-sm font-bold text-slate-900 dark:text-white uppercase tracking-widest"},"Fleet & Driver",-1))]),e("div",le,[e("div",null,[t[14]||(t[14]=e("label",{class:"block text-[10px] font-bold text-slate-500 uppercase tracking-tighter mb-1.5"},"Pilih Armada",-1)),o(V,{modelValue:r(a).vehicle_id,"onUpdate:modelValue":t[3]||(t[3]=s=>r(a).vehicle_id=s),options:N.value,placeholder:"Pilih Truk...",onChange:U},null,8,["modelValue","options"])]),r(a).vehicle_id==="manual"?(n(),d("div",oe,[t[15]||(t[15]=e("label",{class:"block text-[10px] font-bold text-slate-500 uppercase tracking-tighter mb-1.5"},"Input No Truk Manual",-1)),p(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>r(a).vehicle_number=s),type:"text",placeholder:"e.g. B 1234 ABC",class:"w-full rounded-xl border-0 bg-slate-50 dark:bg-slate-800 text-sm text-slate-900 dark:text-white focus:ring-2 focus:ring-blue-500/50 shadow-sm",required:""},null,512),[[c,r(a).vehicle_number]])])):S("",!0),e("div",null,[t[16]||(t[16]=e("label",{class:"block text-[10px] font-bold text-slate-500 uppercase tracking-tighter mb-1.5"},"Sopir (Driver)",-1)),e("div",ie,[o(r(K),{class:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400"}),p(e("input",{"onUpdate:modelValue":t[5]||(t[5]=s=>r(a).driver_name=s),type:"text",placeholder:"Nama Sopir...",class:"w-full rounded-xl border-0 bg-slate-50 dark:bg-slate-800 py-2.5 pl-10 text-sm text-slate-900 dark:text-white focus:ring-2 focus:ring-blue-500/50 shadow-sm",required:""},null,512),[[c,r(a).driver_name]])])])])]),e("div",de,[e("div",ne,[o(r(Q),{class:"h-5 w-5 text-amber-500"}),t[17]||(t[17]=e("h3",{class:"text-sm font-bold text-slate-900 dark:text-white uppercase tracking-widest"},"Shipping Address",-1))]),p(e("textarea",{"onUpdate:modelValue":t[6]||(t[6]=s=>r(a).shipping_address=s),rows:"3",class:"w-full rounded-xl border-0 bg-slate-50 dark:bg-slate-800 text-sm text-slate-900 dark:text-white focus:ring-2 focus:ring-blue-500/50 shadow-sm",placeholder:"Alamat lengkap pengiriman..."},null,512),[[c,r(a).shipping_address]])])]),e("div",pe,[e("div",ue,[t[21]||(t[21]=e("div",{class:"px-6 py-4 border-b border-slate-200 dark:border-slate-800 bg-slate-50 dark:bg-slate-900 dark:bg-slate-800/30"},[e("h3",{class:"text-[10px] font-bold text-slate-900 dark:text-white uppercase tracking-widest"},"Items to Ship")],-1)),e("div",me,[e("table",ce,[t[20]||(t[20]=e("thead",{class:"sticky top-0 z-10 bg-slate-50 dark:bg-slate-900 shadow-sm"},[e("tr",null,[e("th",{class:"px-6 py-3 text-[10px] font-bold text-slate-500 uppercase tracking-tighter"},"Product"),e("th",{class:"px-6 py-3 text-[10px] font-bold text-slate-500 uppercase text-center tracking-tighter"},"Sisa SO"),e("th",{class:"px-6 py-3 text-[10px] font-bold text-slate-500 uppercase text-center tracking-tighter"},"Qty Kirim"),e("th",{class:"px-6 py-3 text-[10px] font-bold text-slate-500 uppercase tracking-tighter"},"UOM"),e("th",{class:"px-6 py-3 text-[10px] font-bold text-slate-500 uppercase tracking-tighter"},"Notes"),e("th",{class:"px-6 py-3 text-[10px] font-bold text-slate-500 uppercase text-right tracking-tighter"})])],-1)),e("tbody",xe,[(n(!0),d(f,null,w(r(a).items,(s,i)=>(n(),d("tr",{key:i,class:"hover:bg-slate-50 dark:hover:bg-slate-800/20 transition-colors"},[e("td",be,[e("div",ge,m(s.name),1),e("div",he,m(s.sku),1)]),e("td",fe,[e("span",_e,m(r(L)(s.remaining)),1)]),e("td",ve,[p(e("input",{"onUpdate:modelValue":x=>s.qty_delivered=x,type:"number",step:"any",min:"0.0001",max:s.remaining,class:P(["w-24 rounded-lg border-0 bg-slate-50 dark:bg-slate-800 text-sm font-bold text-center focus:ring-1 focus:ring-blue-500",{"text-red-500 ring-1 ring-red-500/50 bg-red-500/5":s.qty_delivered>s.remaining}])},null,10,ke),[[c,s.qty_delivered]])]),e("td",ye,m(s.unit_name),1),e("td",we,[p(e("input",{"onUpdate:modelValue":x=>s.notes=x,type:"text",placeholder:"...",class:"w-full rounded-lg border-0 bg-slate-50 dark:bg-slate-800 text-xs focus:ring-1 focus:ring-blue-500"},null,8,Se),[[c,s.notes]])]),e("td",Oe,[e("button",{type:"button",onClick:x=>$(i),class:"p-1.5 text-slate-400 hover:text-red-500 transition-colors"},[o(r(R),{class:"h-4 w-4"})],8,Ve)])]))),128)),r(a).items.length===0?(n(),d("tr",Ce,[e("td",Ne,[b.value?(n(),d("div",Ue,[...t[18]||(t[18]=[e("div",{class:"h-8 w-8 animate-spin rounded-full border-4 border-blue-500 border-t-transparent"},null,-1),e("span",{class:"text-sm text-slate-500"},"Memuat item Sales Order...",-1)])])):(n(),d("div",$e,[o(r(_),{class:"h-10 w-10 text-slate-200 dark:text-slate-800"}),t[19]||(t[19]=e("span",{class:"text-sm text-slate-500 italic"},"Pilih Sales Order terlebih dahulu untuk memuat item pengiriman.",-1))]))])])):S("",!0)])])])]),e("div",qe,[t[23]||(t[23]=e("div",{class:"text-xs text-slate-500 italic"}," * Pastikan armada dan Qty kirim sudah sesuai sebelum menyimpan Draft. ",-1)),e("div",Ae,[o(r(y),{href:l.route("sales.deliveries.index"),class:"rounded-xl px-6 py-2.5 text-sm font-bold text-slate-600 dark:text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-800 transition-all"},{default:g(()=>[...t[22]||(t[22]=[h(" Batal ",-1)])]),_:1},8,["href"]),e("button",{type:"submit",disabled:r(a).processing||r(a).items.length===0,class:"inline-flex items-center gap-2 rounded-xl bg-gradient-to-r from-blue-600 to-blue-500 px-8 py-2.5 text-sm font-bold text-white shadow-lg shadow-blue-500/20 hover:from-blue-500 hover:to-blue-400 transition-all disabled:opacity-50 active:scale-95"},[o(r(_),{class:"h-5 w-5"}),h(" "+m(r(a).processing?"Menyimpan...":"SIMPAN SURAT JALAN"),1)],8,De)])])])])],32)])]),_:1})],64))}},ot=z(Me,[["__scopeId","data-v-e48f90b4"]]);export{ot as default};
