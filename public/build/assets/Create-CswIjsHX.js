import{f as V,x as P,w as k,b as t,a as x,u as r,l as R,t as o,i as B,d as c,j as p,v as g,o as i,c as n,e as m,F as y,g as D,n as I,m as T,B as h}from"./app-7tom90NC.js";import{P as q}from"./PortalLayout-CkfTGwfm.js";import{r as j}from"./ArrowLeftIcon-B0Vvht0s.js";import{r as S}from"./DocumentTextIcon-Bh0-DCGV.js";import{r as O}from"./CheckCircleIcon-PZ17nj8X.js";import{r as U}from"./SunIcon-DOlfT932.js";/* empty css            */import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./XMarkIcon-uYjd2y5c.js";import"./ShoppingCartIcon-BXUuisJx.js";import"./TruckIcon-TSeoOXO2.js";import"./CalendarIcon-DJPWFw--.js";import"./FolderIcon-pzuQ5XFD.js";import"./ArchiveBoxIcon-CGkMdSj8.js";import"./QuestionMarkCircleIcon-jNHpb_Ii.js";import"./ChevronRightIcon-CSzCB-Qg.js";import"./ChevronLeftIcon-iP_sct6C.js";import"./ArrowRightOnRectangleIcon-KuF-gvR_.js";const A={class:"max-w-5xl mx-auto"},F={class:"flex items-center gap-4 mb-6"},$={class:"text-sm text-slate-500"},E={class:"bg-white dark:bg-slate-800 rounded-2xl shadow-sm border border-slate-200 dark:border-slate-700 p-6"},M={class:"font-bold text-slate-800 dark:text-white mb-4 flex items-center gap-2"},z={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},G={key:0,class:"text-red-500 text-xs mt-1"},Q={class:"md:col-span-3"},H={class:"bg-white dark:bg-slate-800 rounded-2xl shadow-sm border border-slate-200 dark:border-slate-700 overflow-hidden"},J={class:"p-6 border-b border-slate-200 dark:border-slate-700"},K={class:"font-bold text-slate-800 dark:text-white flex items-center gap-2"},W={class:"divide-y divide-slate-200 dark:divide-slate-700"},X=["onClick"],Y={class:"flex items-center gap-4"},Z={key:0,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",class:"w-3.5 h-3.5 text-white"},tt={class:"font-bold text-slate-900 dark:text-white"},et={class:"text-xs text-slate-500"},st={class:"text-right"},ot={class:"font-bold text-slate-900 dark:text-white"},rt={class:"text-xs text-slate-500"},lt={key:0,class:"p-8 text-center text-slate-500"},at={key:0,class:"bg-white dark:bg-slate-800 rounded-2xl shadow-sm border border-slate-200 dark:border-slate-700 overflow-hidden"},dt={class:"p-6 border-b border-slate-200 dark:border-slate-700"},it={class:"font-bold text-slate-800 dark:text-white flex items-center gap-2"},nt={class:"overflow-x-auto"},ut={class:"w-full text-left text-sm text-slate-600 dark:text-slate-400"},ct={class:"divide-y divide-slate-200 dark:divide-slate-700"},xt={class:"px-6 py-4"},bt={class:"font-bold text-slate-900 dark:text-white"},pt={class:"text-xs text-slate-500"},gt={class:"px-6 py-4 text-center font-bold text-slate-900 dark:text-white"},mt={class:"px-6 py-4 text-right font-mono"},ht={class:"px-6 py-4 text-right font-bold text-slate-900 dark:text-white"},vt={class:"bg-slate-50 dark:bg-slate-800/50"},ft={class:"px-6 py-3 text-right font-bold text-slate-900 dark:text-white"},_t={colspan:"3",class:"px-6 py-3 text-right font-bold text-slate-500"},wt={class:"px-6 py-3 text-right font-bold text-slate-900 dark:text-white"},kt={class:"bg-indigo-50 dark:bg-indigo-900/20"},yt={class:"px-6 py-4 text-right font-bold text-indigo-600 dark:text-indigo-300 text-lg"},Dt={class:"flex justify-end"},It=["disabled"],zt={__name:"Create",props:{order:Object,deliveries:Array},setup(u){const b=u,a=T([]),N=d=>{a.value.includes(d)?a.value=a.value.filter(e=>e!==d):a.value.push(d)},f=h(()=>{let d=[];return b.deliveries&&b.deliveries.forEach(e=>{a.value.includes(e.id)&&e.items.forEach(s=>{d.push({grn_number:e.grn_number,delivery_note:e.delivery_note_number,receipt_date:e.receipt_date,product_name:s.product_name,qty:s.qty,unit_price:s.unit_price,subtotal:s.subtotal})})}),d}),v=h(()=>f.value.reduce((d,e)=>d+e.subtotal,0)),_=h(()=>v.value*(b.order.tax_percent/100)),L=h(()=>v.value+_.value),l=V({purchase_order_id:b.order.id,invoice_number:"",invoice_date:new Date().toISOString().split("T")[0],due_date:new Date(new Date().setDate(new Date().getDate()+30)).toISOString().split("T")[0],notes:"",selected_gr_ids:[]}),C=()=>{l.selected_gr_ids=a.value,confirm("Are you sure you want to submit this invoice?")&&l.post(route("portal.invoices.store"))};return(d,e)=>(i(),P(q,{title:"Create Invoice"},{default:k(()=>[t("div",A,[t("div",F,[x(r(R),{href:d.route("portal.purchase-orders.show",u.order.id),class:"p-2 rounded-xl bg-slate-100 dark:bg-slate-800 text-slate-500 hover:text-slate-700 dark:hover:text-white transition-colors"},{default:k(()=>[x(r(j),{class:"h-5 w-5"})]),_:1},8,["href"]),t("div",null,[e[4]||(e[4]=t("h1",{class:"text-2xl font-bold text-slate-900 dark:text-white"},"Create Invoice",-1)),t("p",$," For PO #"+o(u.order.po_number)+" • "+o(u.order.warehouse?.name),1)])]),t("form",{onSubmit:B(C,["prevent"]),class:"space-y-6"},[t("div",E,[t("h2",M,[x(r(S),{class:"w-5 h-5 text-indigo-500"}),e[5]||(e[5]=c(" Invoice Details ",-1))]),t("div",z,[t("div",null,[e[6]||(e[6]=t("label",{class:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1"},[c(" Invoice Number "),t("span",{class:"text-red-500"},"*")],-1)),p(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>r(l).invoice_number=s),type:"text",required:"",class:"w-full px-3 py-2 rounded-lg border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-900 text-slate-900 dark:text-white focus:ring-2 focus:ring-indigo-500 outline-none",placeholder:"e.g., INV-2026/001"},null,512),[[g,r(l).invoice_number]]),r(l).errors.invoice_number?(i(),n("p",G,o(r(l).errors.invoice_number),1)):m("",!0)]),t("div",null,[e[7]||(e[7]=t("label",{class:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1"},[c(" Invoice Date "),t("span",{class:"text-red-500"},"*")],-1)),p(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>r(l).invoice_date=s),type:"date",required:"",class:"w-full px-3 py-2 rounded-lg border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-900 text-slate-900 dark:text-white focus:ring-2 focus:ring-indigo-500 outline-none"},null,512),[[g,r(l).invoice_date]])]),t("div",null,[e[8]||(e[8]=t("label",{class:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1"},[c(" Due Date "),t("span",{class:"text-red-500"},"*")],-1)),p(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>r(l).due_date=s),type:"date",required:"",class:"w-full px-3 py-2 rounded-lg border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-900 text-slate-900 dark:text-white focus:ring-2 focus:ring-indigo-500 outline-none"},null,512),[[g,r(l).due_date]])]),t("div",Q,[e[9]||(e[9]=t("label",{class:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1"}," Notes / Payment Instructions ",-1)),p(t("textarea",{"onUpdate:modelValue":e[3]||(e[3]=s=>r(l).notes=s),rows:"2",class:"w-full px-3 py-2 rounded-lg border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-900 text-slate-900 dark:text-white focus:ring-2 focus:ring-indigo-500 outline-none",placeholder:"e.g., Bank details..."},null,512),[[g,r(l).notes]])])])]),t("div",H,[t("div",J,[t("h2",K,[x(r(O),{class:"w-5 h-5 text-indigo-500"}),e[10]||(e[10]=c(" Select Deliveries to Invoice ",-1))]),e[11]||(e[11]=t("p",{class:"text-sm text-slate-500 mt-1"},"Check the delivery notes you want to include in this invoice.",-1))]),t("div",W,[(i(!0),n(y,null,D(u.deliveries,s=>(i(),n("div",{key:s.id,onClick:w=>N(s.id),class:I(["p-4 flex items-center justify-between cursor-pointer hover:bg-slate-50 dark:hover:bg-slate-700/50 transition-colors",{"bg-indigo-50 dark:bg-indigo-900/20":a.value.includes(s.id)}])},[t("div",Y,[t("div",{class:I(["w-5 h-5 rounded border flex items-center justify-center transition-colors",a.value.includes(s.id)?"bg-indigo-600 border-indigo-600":"border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-800"])},[a.value.includes(s.id)?(i(),n("svg",Z,[...e[12]||(e[12]=[t("path",{"fill-rule":"evenodd",d:"M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.05-.143z","clip-rule":"evenodd"},null,-1)])])):m("",!0)],2),t("div",null,[t("p",tt,o(s.delivery_note_number),1),t("p",et,o(new Date(s.receipt_date).toLocaleDateString())+" • GRN: "+o(s.grn_number),1)])]),t("div",st,[t("p",ot,"Rp "+o(Number(s.total_value).toLocaleString("id-ID")),1),t("p",rt,o(s.items_count)+" Items",1)])],10,X))),128)),u.deliveries.length===0?(i(),n("div",lt," No uninvoiced deliveries found for this PO. ")):m("",!0)])]),a.value.length>0?(i(),n("div",at,[t("div",dt,[t("h2",it,[x(r(U),{class:"w-5 h-5 text-indigo-500"}),e[13]||(e[13]=c(" Invoice Items Preview ",-1))])]),t("div",nt,[t("table",ut,[e[16]||(e[16]=t("thead",{class:"bg-slate-50 dark:bg-slate-700/50 uppercase text-xs font-bold text-slate-500"},[t("tr",null,[t("th",{class:"px-6 py-4"},"Product / Delivery Ref"),t("th",{class:"px-6 py-4 text-center"},"Qty"),t("th",{class:"px-6 py-4 text-right"},"Unit Price"),t("th",{class:"px-6 py-4 text-right"},"Total")])],-1)),t("tbody",ct,[(i(!0),n(y,null,D(f.value,(s,w)=>(i(),n("tr",{key:w},[t("td",xt,[t("p",bt,o(s.product_name),1),t("p",pt," DN: "+o(s.delivery_note)+" • "+o(new Date(s.receipt_date).toLocaleDateString()),1)]),t("td",gt,o(Number(s.qty).toLocaleString("id-ID")),1),t("td",mt," Rp "+o(Number(s.unit_price).toLocaleString("id-ID")),1),t("td",ht," Rp "+o(Number(s.subtotal).toLocaleString("id-ID")),1)]))),128))]),t("tfoot",vt,[t("tr",null,[e[14]||(e[14]=t("td",{colspan:"3",class:"px-6 py-3 text-right font-bold text-slate-500"},"Subtotal",-1)),t("td",ft,"Rp "+o(Number(v.value).toLocaleString("id-ID")),1)]),t("tr",null,[t("td",_t,"Tax ("+o(u.order.tax_percent)+"%)",1),t("td",wt,"Rp "+o(Number(_.value).toLocaleString("id-ID")),1)]),t("tr",kt,[e[15]||(e[15]=t("td",{colspan:"3",class:"px-6 py-4 text-right font-bold text-indigo-900 dark:text-indigo-100 uppercase"},"Grand Total",-1)),t("td",yt,"Rp "+o(Number(L.value).toLocaleString("id-ID")),1)])])])])])):m("",!0),t("div",Dt,[t("button",{type:"submit",disabled:r(l).processing||a.value.length===0,class:"px-6 py-3 rounded-xl bg-indigo-600 text-white font-bold hover:bg-indigo-700 transition-colors shadow-lg shadow-indigo-500/30 flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed"},[x(r(S),{class:"w-5 h-5"}),e[17]||(e[17]=c(" Submit Invoice ",-1))],8,It)])],32)])]),_:1}))}};export{zt as default};
