import{f as N,c as n,a as i,u as l,h as Q,w as f,b as e,l as w,d as k,i as D,j as x,o as u,F as v,g as h,t as m,k as I,v as b,n as j,e as _,B as q}from"./app-CCf7_9Wg.js";import{_ as B}from"./AppLayout-DZBJxE3M.js";import{_ as O}from"./SearchableSelect-DyABdx9H.js";import{f as y}from"./helpers-DnzC1tLX.js";import{r as T}from"./ArrowLeftIcon-OrItRHgU.js";import{r as A}from"./PlusIcon-DfyUIl2L.js";import{r as M}from"./TrashIcon-B66GDzTT.js";/* empty css            */import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./XMarkIcon-CejSBq9U.js";import"./SunIcon-Bj99B8bH.js";import"./WrenchScrewdriverIcon-Be-5iMcN.js";import"./DocumentPlusIcon-Dg_SJ0Za.js";import"./TruckIcon-CP1ruPvc.js";import"./DocumentTextIcon-DAuPJloc.js";import"./ShoppingCartIcon-BGHNwEaG.js";import"./MapPinIcon-BD-RCOsg.js";import"./SparklesIcon-D6GXJKho.js";import"./CubeIcon-DIqd0BOs.js";import"./ClockIcon-D9nlDPF9.js";import"./CheckCircleIcon-Dg6WzkyV.js";import"./ShieldCheckIcon-DedchYL6.js";import"./transition-B-aoZj_6.js";const z={class:"max-w-full px-4 sm:px-6 lg:px-8 mx-auto"},L={class:"grid grid-cols-1 xl:grid-cols-12 gap-6"},E={class:"xl:col-span-4 glass-card rounded-2xl p-6 space-y-4"},R=["value"],W=["value"],G={class:"xl:col-span-8 glass-card rounded-2xl p-6"},H={class:"flex items-center justify-between mb-4"},J={class:"space-y-2 max-h-[600px] overflow-y-auto custom-scrollbar relative pr-2"},K={class:"col-span-12 sm:col-span-5"},X={class:"col-span-4 sm:col-span-2"},Y=["onUpdate:modelValue"],Z={class:"col-span-4 sm:col-span-2"},tt=["onUpdate:modelValue"],et={key:0,class:"mt-1 flex items-center gap-1"},st=["title"],lt={class:"col-span-4 sm:col-span-2"},ot={class:"w-full text-xs text-slate-900 dark:text-white font-bold text-right truncate"},at={class:"col-span-12 sm:col-span-1 flex justify-end"},rt=["onClick"],dt={class:"mt-4 pt-4 border-t border-slate-200 dark:border-slate-800 flex justify-end"},nt={class:"text-right"},it={class:"text-xl font-bold text-slate-900 dark:text-white"},ut={class:"glass-card rounded-2xl p-6"},pt={class:"flex justify-end gap-3"},ct=["disabled"],Bt={__name:"Create",props:{customers:Array,products:Array,quotationNumber:String},setup(g){const c=g,a=N({customer_id:"",quotation_date:new Date().toISOString().split("T")[0],valid_until:new Date(Date.now()+720*60*60*1e3).toISOString().split("T")[0],notes:"",items:[{product_id:"",qty:1,unit_price:0}]}),S=q(()=>c.products?c.products.filter(o=>o&&!o.name.startsWith("SO-")).map(o=>({id:o.id,label:`[${o.sku||"#"+o.id}] ${o.name}`})):[]),V=()=>{a.items.push({product_id:"",qty:1,unit_price:0})},C=(o,t)=>{if(!c.products)return;const s=c.products.find(d=>d.id===o.product_id);s&&(a.items[t].unit_price=parseFloat(s.selling_price||s.price||0))},p=o=>{if(!o.product_id||!c.products)return null;const t=c.products.find(F=>F.id===o.product_id);if(!t)return null;const s=parseFloat(t.selling_price||t.price||0);if(s===0)return null;const d=parseFloat(o.unit_price||0);if(d===s)return{pct:0,standard:s,color:"text-emerald-500",bg:"bg-emerald-500/10",label:"Standard price"};const r=(d-s)/s*100;return Math.abs(r)<=5?{pct:r,standard:s,color:"text-amber-500",bg:"bg-amber-500/10",label:`${r>0?"+":""}${r.toFixed(1)}%`}:{pct:r,standard:s,color:"text-red-500",bg:"bg-red-500/10",label:`${r>0?"+":""}${r.toFixed(1)}%`}},U=o=>{a.items.splice(o,1)},$=q(()=>a.items.reduce((o,t)=>o+t.qty*t.unit_price,0)),P=()=>{a.post("/sales/quotations")};return(o,t)=>(u(),n(v,null,[i(l(Q),{title:"Create Quotation"}),i(B,{title:"Quotations"},{default:f(()=>[e("div",z,[i(l(w),{href:"/sales/quotations",class:"inline-flex items-center gap-2 mb-4 text-sm text-slate-500 dark:text-slate-400 hover:text-slate-900 dark:text-white"},{default:f(()=>[i(l(T),{class:"h-4 w-4"}),t[4]||(t[4]=k(" Back to List ",-1))]),_:1}),e("form",{onSubmit:D(P,["prevent"]),class:"space-y-6"},[e("div",L,[e("div",E,[t[10]||(t[10]=e("h3",{class:"text-lg font-semibold text-slate-900 dark:text-white mb-4"},"Quotation Info",-1)),e("div",null,[t[5]||(t[5]=e("label",{class:"block text-sm font-medium text-slate-500 dark:text-slate-400 mb-1"},"Quotation Number",-1)),e("input",{type:"text",value:g.quotationNumber,class:"w-full rounded-xl border-0 bg-slate-50 dark:bg-slate-900 dark:bg-slate-800/50 py-2.5 text-slate-500 dark:text-slate-400 cursor-not-allowed",disabled:""},null,8,R)]),e("div",null,[t[7]||(t[7]=e("label",{class:"block text-sm font-medium text-slate-500 dark:text-slate-400 mb-1"},"Customer",-1)),x(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>l(a).customer_id=s),class:"w-full rounded-xl border-0 bg-slate-50 dark:bg-slate-800 py-2.5 text-slate-900 dark:text-white focus:ring-2 focus:ring-blue-500/50",required:""},[t[6]||(t[6]=e("option",{value:""},"Select Customer",-1)),(u(!0),n(v,null,h(g.customers,s=>(u(),n("option",{key:s.id,value:s.id},m(s.name),9,W))),128))],512),[[I,l(a).customer_id]])]),e("div",null,[t[8]||(t[8]=e("label",{class:"block text-sm font-medium text-slate-500 dark:text-slate-400 mb-1"},"Quotation Date",-1)),x(e("input",{type:"date","onUpdate:modelValue":t[1]||(t[1]=s=>l(a).quotation_date=s),class:"w-full rounded-xl border-0 bg-slate-50 dark:bg-slate-800 py-2.5 text-slate-900 dark:text-white focus:ring-2 focus:ring-blue-500/50",required:""},null,512),[[b,l(a).quotation_date]])]),e("div",null,[t[9]||(t[9]=e("label",{class:"block text-sm font-medium text-slate-500 dark:text-slate-400 mb-1"},"Valid Until",-1)),x(e("input",{type:"date","onUpdate:modelValue":t[2]||(t[2]=s=>l(a).valid_until=s),class:"w-full rounded-xl border-0 bg-slate-50 dark:bg-slate-800 py-2.5 text-slate-900 dark:text-white focus:ring-2 focus:ring-blue-500/50",required:""},null,512),[[b,l(a).valid_until]])])]),e("div",G,[e("div",H,[t[12]||(t[12]=e("h3",{class:"text-lg font-semibold text-slate-900 dark:text-white"},"Items",-1)),e("button",{type:"button",onClick:V,class:"text-sm font-medium text-blue-400 hover:text-blue-300 flex items-center gap-1"},[i(l(A),{class:"h-4 w-4"}),t[11]||(t[11]=k(" Add Item ",-1))])]),e("div",J,[t[17]||(t[17]=e("div",{class:"hidden sm:grid grid-cols-12 gap-3 px-3 py-2 bg-slate-50 dark:bg-slate-900 dark:bg-slate-800/50 rounded-lg sticky top-0 z-10"},[e("div",{class:"col-span-5 text-[10px] font-bold text-slate-500 uppercase tracking-widest"},"Product"),e("div",{class:"col-span-2 text-[10px] font-bold text-slate-500 uppercase tracking-widest text-center"},"Qty"),e("div",{class:"col-span-2 text-[10px] font-bold text-slate-500 uppercase tracking-widest text-right"},"Unit Price"),e("div",{class:"col-span-2 text-[10px] font-bold text-slate-500 uppercase tracking-widest text-right"},"Subtotal"),e("div",{class:"col-span-1"})],-1)),(u(!0),n(v,null,h(l(a).items,(s,d)=>(u(),n("div",{key:d,class:"grid grid-cols-12 gap-3 items-center bg-slate-50 dark:bg-slate-800/10 p-2 rounded-xl hover:bg-slate-50 dark:hover:bg-slate-800/50 dark:bg-slate-800/30 transition-colors"},[e("div",K,[t[13]||(t[13]=e("label",{class:"sm:hidden block text-[10px] font-bold text-slate-500 uppercase mb-1"},"Product",-1)),i(O,{modelValue:s.product_id,"onUpdate:modelValue":r=>s.product_id=r,options:S.value,placeholder:"Search Product...",onChange:r=>C(s,d)},null,8,["modelValue","onUpdate:modelValue","options","onChange"])]),e("div",X,[t[14]||(t[14]=e("label",{class:"sm:hidden block text-[10px] font-bold text-slate-500 uppercase mb-1 text-center"},"Qty",-1)),x(e("input",{type:"number","onUpdate:modelValue":r=>s.qty=r,min:"0.0001",step:"any",class:"w-full rounded-lg border-0 bg-slate-50 dark:bg-slate-800 py-2.5 text-xs text-slate-900 dark:text-white focus:ring-1 focus:ring-blue-500 text-center",required:""},null,8,Y),[[b,s.qty]])]),e("div",Z,[t[15]||(t[15]=e("label",{class:"sm:hidden block text-[10px] font-bold text-slate-500 uppercase mb-1 text-right"},"Price",-1)),x(e("input",{type:"number","onUpdate:modelValue":r=>s.unit_price=r,step:"any",class:"w-full rounded-lg border-0 bg-slate-50 dark:bg-slate-800 py-2.5 text-xs text-slate-900 dark:text-white focus:ring-1 focus:ring-blue-500 text-right",required:""},null,8,tt),[[b,s.unit_price]]),p(s)?(u(),n("div",et,[e("span",{class:j(["inline-flex items-center rounded-full px-1.5 py-0.5 text-[10px] font-bold",[p(s).color,p(s).bg]])},m(p(s).label),3),p(s).pct!==0?(u(),n("span",{key:0,class:"text-[10px] text-slate-500 truncate",title:"Standard: Rp "+p(s).standard}," Std: "+m(l(y)(p(s).standard)),9,st)):_("",!0)])):_("",!0)]),e("div",lt,[t[16]||(t[16]=e("label",{class:"sm:hidden block text-[10px] font-bold text-slate-500 uppercase mb-1 text-right"},"Subtotal",-1)),e("div",ot,m(l(y)(s.qty*s.unit_price)),1)]),e("div",at,[l(a).items.length>1?(u(),n("button",{key:0,type:"button",onClick:r=>U(d),class:"p-2 text-slate-600 hover:text-red-400"},[i(l(M),{class:"h-4 w-4"})],8,rt)):_("",!0)])]))),128))]),e("div",dt,[e("div",nt,[t[18]||(t[18]=e("p",{class:"text-sm text-slate-500 dark:text-slate-400"},"Total",-1)),e("p",it,m(l(y)($.value)),1)])])])]),e("div",ut,[t[19]||(t[19]=e("label",{class:"block text-sm font-medium text-slate-500 dark:text-slate-400 mb-2"},"Notes",-1)),x(e("textarea",{"onUpdate:modelValue":t[3]||(t[3]=s=>l(a).notes=s),rows:"2",class:"w-full rounded-xl border-0 bg-slate-50 dark:bg-slate-800 text-slate-900 dark:text-white focus:ring-2 focus:ring-blue-500/50",placeholder:"Optional notes..."},null,512),[[b,l(a).notes]])]),e("div",pt,[i(l(w),{href:"/sales/quotations",class:"px-6 py-2.5 rounded-xl bg-slate-50 dark:bg-slate-800 text-sm font-semibold text-slate-600 dark:text-slate-300 hover:bg-slate-700"},{default:f(()=>[...t[20]||(t[20]=[k("Cancel",-1)])]),_:1}),e("button",{type:"submit",class:"px-6 py-2.5 rounded-xl bg-blue-600 text-sm font-semibold text-white dark:text-white hover:bg-blue-500 shadow-lg shadow-blue-900/20",disabled:l(a).processing},m(l(a).processing?"Saving...":"Save Quotation"),9,ct)])],32)])]),_:1})],64))}};export{Bt as default};
