import{f as E,m as X,q as C,c as n,a as g,u as r,h as M,w as $,b as t,l as W,t as m,i as R,j as i,v as p,o as u,F as k,g as v,k as S,d as z,n as y,e as V,B as _}from"./app-BTAJ41wv.js";import{_ as G}from"./AppLayout-BCibAEMC.js";import{_ as L}from"./SearchableSelect-CHQBA0X8.js";import{a as Q,f as w}from"./helpers-DnzC1tLX.js";import{r as H}from"./ArrowLeftIcon-CPIts35J.js";import{r as J}from"./PlusIcon-DW9RnPH0.js";import{r as K}from"./TrashIcon-C45Fwwza.js";/* empty css            */import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./XMarkIcon-DicknEfS.js";import"./SunIcon-DiirzqGB.js";import"./WrenchScrewdriverIcon-DtqsjiHd.js";import"./DocumentPlusIcon-CEFQa3Ky.js";import"./TruckIcon-B3V2yp2Y.js";import"./DocumentTextIcon-BYfCv1H3.js";import"./ShoppingCartIcon-W7ARKyC8.js";import"./MapPinIcon-8glMaH6V.js";import"./SparklesIcon-Cku5r5l2.js";import"./CubeIcon-DSu9RNJ8.js";import"./ClockIcon-W3FgrKI1.js";import"./CheckCircleIcon-CwjMhm97.js";import"./ShieldCheckIcon-BylQTbVF.js";import"./transition-C5Skt4Hw.js";const Y={class:"max-w-full px-4 sm:px-6 lg:px-8 mx-auto space-y-6"},Z={class:"flex items-center gap-4"},tt={class:"text-2xl font-bold text-slate-900 dark:text-white"},et={class:"grid grid-cols-1 lg:grid-cols-12 gap-6"},st={class:"lg:col-span-9 space-y-6"},lt={class:"rounded-2xl glass-card p-6 space-y-4"},rt={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},at=["value"],ot=["value"],dt={class:"rounded-2xl glass-card overflow-hidden"},it={class:"p-4 border-b border-slate-200 dark:border-slate-800 flex justify-between items-center"},nt={class:"overflow-x-auto max-h-[600px] overflow-y-auto relative"},ut={class:"w-full text-left text-sm text-slate-500 dark:text-slate-400"},pt={class:"divide-y divide-slate-100 dark:divide-slate-800"},ct={class:"px-4 py-2"},xt={class:"px-4 py-2"},mt=["onUpdate:modelValue"],bt={class:"px-4 py-2"},ft=["onUpdate:modelValue"],gt=["value"],_t={class:"px-4 py-2"},kt=["onUpdate:modelValue"],yt={key:0,class:"mt-1 flex items-center gap-1"},vt=["title"],wt={class:"px-4 py-2"},ht=["onUpdate:modelValue"],Ot={class:"px-4 py-2 text-right font-medium text-slate-900 dark:text-white"},St={class:"px-4 py-2 text-center"},Vt=["onClick"],Ut={class:"flex justify-between items-start"},Dt={class:"w-1/2 space-y-4"},qt={class:"space-y-2"},Ct={class:"space-y-2"},$t={class:"w-1/3 space-y-3 bg-white dark:bg-slate-950 p-4 rounded-xl border border-slate-200 dark:border-slate-800"},Ft={class:"flex justify-between text-sm"},Nt={class:"text-slate-900 dark:text-white font-medium"},Pt={class:"flex justify-between items-center text-sm"},At={class:"flex justify-between items-center text-sm"},jt={class:"pt-3 border-t border-slate-200 dark:border-slate-800 flex justify-between text-base font-bold"},It={class:"text-emerald-400"},Tt={class:"lg:col-span-3 space-y-6"},Bt={key:0,class:"rounded-2xl bg-white dark:bg-slate-950/50 border border-slate-200 dark:border-slate-800 p-6 space-y-4"},Et={class:"space-y-1"},Xt={class:"text-sm font-bold text-slate-900 dark:text-white"},Mt={class:"text-xs text-slate-500 dark:text-slate-400 leading-relaxed"},Wt={class:"rounded-2xl glass-card p-6 space-y-4"},Rt={class:"flex items-center justify-between mb-2"},zt={class:"flex items-center gap-2 cursor-pointer group"},Gt={class:"space-y-4"},Lt=["disabled"],Qt=["disabled"],Ht={class:"flex items-center gap-4"},Jt=["disabled"],Kt={key:0},Yt={key:1},we={__name:"Form",props:{salesOrder:Object,soNumber:String,customers:Array,warehouses:Array,products:Array,units:Array,aiData:Object},setup(x){const o=x,l=E({so_number:o.salesOrder?.so_number||o.soNumber,customer_po_number:o.salesOrder?.customer_po_number||o.aiData?.po_number||"",customer_id:o.salesOrder?.customer_id||o.aiData?.matched_customer_id||"",warehouse_id:o.salesOrder?.warehouse_id||"",order_date:o.salesOrder?.order_date?new Date(o.salesOrder.order_date).toISOString().split("T")[0]:o.aiData?.po_date||new Date().toISOString().split("T")[0],delivery_date:o.salesOrder?.delivery_date?new Date(o.salesOrder.delivery_date).toISOString().split("T")[0]:o.aiData?.delivery_date||"",discount_percent:o.salesOrder?.discount_percent||0,tax_percent:o.salesOrder?.tax_percent||11,notes:o.salesOrder?.notes||(o.aiData?"Extracted via AI Gemini":""),shipping_name:o.salesOrder?.shipping_name||"",shipping_address:o.salesOrder?.shipping_address||"",items:o.salesOrder?.items?.map(a=>({id:a.id,product_id:a.product_id,qty:parseFloat(a.qty),unit_id:a.unit_id,unit_price:parseFloat(a.unit_price),discount_percent:parseFloat(a.discount_percent)}))||o.aiData?.items?.map(a=>({product_id:a.matched_product_id||"",qty:parseFloat(a.qty||1),unit_id:o.products?.find(e=>e.id===a.matched_product_id)?.unit_id||"",unit_price:parseFloat(a.unit_price||0),discount_percent:0,description:a.description}))||[{product_id:"",qty:1,unit_id:"",unit_price:0,discount_percent:0}]}),b=X(!o.salesOrder);C(()=>l.customer_id,a=>{if(b.value&&a){const e=o.customers.find(s=>s.id===a);e&&(l.shipping_name=e.name,l.shipping_address=e.full_address||"")}}),C(b,a=>{if(a&&l.customer_id){const e=o.customers.find(s=>s.id===l.customer_id);e&&(l.shipping_name=e.name,l.shipping_address=e.full_address||"")}});const F=_(()=>o.products?o.products.filter(a=>a&&!a.name.startsWith("SO-")).map(a=>({id:a.id,label:`[${a.sku||"#"+a.id}] ${a.name}`})):[]),U=_(()=>{const a=o.products||[];return l.items.map(e=>{const s=a.find(O=>O.id===e.product_id),c=(e.qty||0)*(e.unit_price||0),d=c*((e.discount_percent||0)/100),q=c-d;return{...e,product:s,subtotal:q}})}),h=_(()=>U.value.reduce((a,e)=>a+e.subtotal,0)),N=_(()=>h.value*((l.discount_percent||0)/100)),D=_(()=>h.value-N.value),P=_(()=>D.value*((l.tax_percent||0)/100)),A=_(()=>D.value+P.value),j=()=>{l.items.push({product_id:"",qty:1,unit_id:"",unit_price:0,discount_percent:0})},I=a=>{l.items.splice(a,1)},T=(a,e)=>{if(!o.products)return;const s=o.products.find(c=>c.id===a.product_id);s&&(l.items[e].unit_id=s.unit?.id||s.sales_unit_id,l.items[e].unit_price=parseFloat(s.selling_price||s.price||0))},f=a=>{if(!a.product_id||!o.products)return null;const e=o.products.find(O=>O.id===a.product_id);if(!e)return null;const s=parseFloat(e.selling_price||e.price||0);if(s===0)return null;const c=parseFloat(a.unit_price||0);if(c===s)return{pct:0,standard:s,color:"text-emerald-500",bg:"bg-emerald-500/10",label:"Standard price"};const d=(c-s)/s*100;return Math.abs(d)<=5?{pct:d,standard:s,color:"text-amber-500",bg:"bg-amber-500/10",label:`${d>0?"+":""}${d.toFixed(1)}%`}:{pct:d,standard:s,color:"text-red-500",bg:"bg-red-500/10",label:`${d>0?"+":""}${d.toFixed(1)}%`}},B=()=>{o.salesOrder?l.put(route("sales.orders.update",o.salesOrder.id)):l.post(route("sales.orders.store"))};return(a,e)=>(u(),n(k,null,[g(r(M),{title:x.salesOrder?`Edit SO ${x.salesOrder.so_number}`:"New Sales Order"},null,8,["title"]),g(G,{title:x.salesOrder?"Edit Sales Order":"Create Sales Order"},{default:$(()=>[t("div",Y,[t("div",Z,[g(r(W),{href:a.route("sales.orders.index"),class:"p-2 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-800/50 dark:bg-slate-800 text-slate-500 dark:text-slate-400 hover:text-slate-900 dark:text-white transition-colors"},{default:$(()=>[g(r(H),{class:"h-5 w-5"})]),_:1},8,["href"]),t("h1",tt,m(x.salesOrder?`Edit ${x.salesOrder.so_number}`:"New Sales Order"),1)]),t("form",{onSubmit:R(B,["prevent"]),class:"space-y-6"},[t("div",et,[t("div",st,[t("div",lt,[e[20]||(e[20]=t("h3",{class:"text-sm font-medium text-slate-500 dark:text-slate-400 uppercase tracking-wider mb-4"},"Order Details",-1)),t("div",rt,[t("div",null,[e[13]||(e[13]=t("label",{class:"block text-sm font-medium text-slate-500 dark:text-slate-400 mb-2"},"SO Number",-1)),i(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>r(l).so_number=s),type:"text",class:"block w-full rounded-xl border-0 bg-slate-50 dark:bg-slate-800 py-2.5 px-4 text-slate-900 dark:text-white focus:ring-2 focus:ring-blue-500/50",required:""},null,512),[[p,r(l).so_number]])]),t("div",null,[e[15]||(e[15]=t("label",{class:"block text-sm font-medium text-slate-500 dark:text-slate-400 mb-2"},"Customer",-1)),i(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>r(l).customer_id=s),class:"block w-full rounded-xl border-0 bg-slate-50 dark:bg-slate-800 py-2.5 px-4 text-slate-900 dark:text-white focus:ring-2 focus:ring-blue-500/50",required:""},[e[14]||(e[14]=t("option",{value:"",disabled:""},"Select Customer",-1)),(u(!0),n(k,null,v(x.customers,s=>(u(),n("option",{key:s.id,value:s.id},m(s.name),9,at))),128))],512),[[S,r(l).customer_id]])]),t("div",null,[e[17]||(e[17]=t("label",{class:"block text-sm font-medium text-slate-500 dark:text-slate-400 mb-2"},"Warehouse",-1)),i(t("select",{"onUpdate:modelValue":e[2]||(e[2]=s=>r(l).warehouse_id=s),class:"block w-full rounded-xl border-0 bg-slate-50 dark:bg-slate-800 py-2.5 px-4 text-slate-900 dark:text-white focus:ring-2 focus:ring-blue-500/50",required:""},[e[16]||(e[16]=t("option",{value:"",disabled:""},"Select Warehouse",-1)),(u(!0),n(k,null,v(x.warehouses,s=>(u(),n("option",{key:s.id,value:s.id},m(s.name),9,ot))),128))],512),[[S,r(l).warehouse_id]])]),t("div",null,[e[18]||(e[18]=t("label",{class:"block text-sm font-medium text-slate-500 dark:text-slate-400 mb-2"},"Order Date",-1)),i(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>r(l).order_date=s),type:"date",class:"block w-full rounded-xl border-0 bg-slate-50 dark:bg-slate-800 py-2.5 px-4 text-slate-900 dark:text-white focus:ring-2 focus:ring-blue-500/50",required:""},null,512),[[p,r(l).order_date]])]),t("div",null,[e[19]||(e[19]=t("label",{class:"block text-sm font-medium text-slate-500 dark:text-slate-400 mb-2"},"Delivery Date",-1)),i(t("input",{"onUpdate:modelValue":e[4]||(e[4]=s=>r(l).delivery_date=s),type:"date",class:"block w-full rounded-xl border-0 bg-slate-50 dark:bg-slate-800 py-2.5 px-4 text-slate-900 dark:text-white focus:ring-2 focus:ring-blue-500/50"},null,512),[[p,r(l).delivery_date]])])])]),t("div",dt,[t("div",it,[e[22]||(e[22]=t("h3",{class:"text-sm font-medium text-slate-500 dark:text-slate-400 uppercase tracking-wider"},"Order Items",-1)),t("button",{type:"button",onClick:j,class:"text-sm text-blue-400 hover:text-blue-300 font-medium flex items-center gap-1"},[g(r(J),{class:"h-4 w-4"}),e[21]||(e[21]=z(" Add Item ",-1))])]),t("div",nt,[t("table",ut,[e[24]||(e[24]=t("thead",{class:"bg-white dark:bg-slate-950 text-slate-200 sticky top-0 z-10"},[t("tr",null,[t("th",{class:"px-4 py-3 min-w-[350px]"},"Product"),t("th",{class:"px-4 py-3 w-24"},"Qty"),t("th",{class:"px-4 py-3 w-32"},"Unit"),t("th",{class:"px-4 py-3 w-32"},"Price"),t("th",{class:"px-4 py-3 w-24"},"Disc %"),t("th",{class:"px-4 py-3 w-32 text-right"},"Subtotal"),t("th",{class:"px-4 py-3 w-10"})])],-1)),t("tbody",pt,[(u(!0),n(k,null,v(r(l).items,(s,c)=>(u(),n("tr",{key:c},[t("td",ct,[g(L,{modelValue:s.product_id,"onUpdate:modelValue":d=>s.product_id=d,options:F.value,placeholder:"Search Product...",onChange:d=>T(s,c)},null,8,["modelValue","onUpdate:modelValue","options","onChange"])]),t("td",xt,[i(t("input",{"onUpdate:modelValue":d=>s.qty=d,type:"number",step:"0.01",class:"block w-full rounded-lg border-0 bg-slate-50 dark:bg-slate-800 py-1.5 px-2 text-sm text-slate-900 dark:text-white focus:ring-1 focus:ring-blue-500",required:""},null,8,mt),[[p,s.qty]])]),t("td",bt,[i(t("select",{"onUpdate:modelValue":d=>s.unit_id=d,class:"block w-full rounded-lg border-0 bg-slate-50 dark:bg-slate-800 py-1.5 px-2 text-sm text-slate-900 dark:text-white focus:ring-1 focus:ring-blue-500"},[e[23]||(e[23]=t("option",{value:"",disabled:""},"Unit",-1)),(u(!0),n(k,null,v(x.units,d=>(u(),n("option",{key:d.id,value:d.id},m(d.code),9,gt))),128))],8,ft),[[S,s.unit_id]])]),t("td",_t,[i(t("input",{"onUpdate:modelValue":d=>s.unit_price=d,type:"number",step:"0.01",class:"block w-full rounded-lg border-0 bg-slate-50 dark:bg-slate-800 py-1.5 px-2 text-sm text-slate-900 dark:text-white focus:ring-1 focus:ring-blue-500 text-right",required:""},null,8,kt),[[p,s.unit_price]]),f(s)?(u(),n("div",yt,[t("span",{class:y(["inline-flex items-center rounded-full px-1.5 py-0.5 text-[10px] font-bold",[f(s).color,f(s).bg]])},m(f(s).label),3),f(s).pct!==0?(u(),n("span",{key:0,class:"text-[10px] text-slate-500 truncate",title:"Standard: Rp "+r(Q)(f(s).standard)}," Std: "+m(r(w)(f(s).standard)),9,vt)):V("",!0)])):V("",!0)]),t("td",wt,[i(t("input",{"onUpdate:modelValue":d=>s.discount_percent=d,type:"number",step:"0.01",min:"0",max:"100",class:"block w-full rounded-lg border-0 bg-slate-50 dark:bg-slate-800 py-1.5 px-2 text-sm text-slate-900 dark:text-white focus:ring-1 focus:ring-blue-500 text-center"},null,8,ht),[[p,s.discount_percent]])]),t("td",Ot,m(r(w)(U.value[c].subtotal)),1),t("td",St,[t("button",{type:"button",onClick:d=>I(c),class:"text-slate-500 hover:text-red-400 transition-colors"},[g(r(K),{class:"h-4 w-4"})],8,Vt)])]))),128))])])])]),t("div",Ut,[t("div",Dt,[t("div",qt,[e[25]||(e[25]=t("label",{class:"block text-sm font-medium text-slate-500 dark:text-slate-400"},"SO Number",-1)),i(t("input",{"onUpdate:modelValue":e[5]||(e[5]=s=>r(l).so_number=s),type:"text",class:"block w-full rounded-xl border-0 bg-slate-50 dark:bg-slate-800 py-2.5 px-4 text-slate-900 dark:text-white focus:ring-2 focus:ring-blue-500/50 sm:text-sm",readonly:""},null,512),[[p,r(l).so_number]])]),t("div",Ct,[e[26]||(e[26]=t("label",{class:"block text-sm font-medium text-slate-500 dark:text-slate-400"},"PO Number (Customer)",-1)),i(t("input",{"onUpdate:modelValue":e[6]||(e[6]=s=>r(l).customer_po_number=s),type:"text",class:"block w-full rounded-xl border-0 bg-slate-50 dark:bg-slate-800 py-2.5 px-4 text-slate-900 dark:text-white focus:ring-2 focus:ring-blue-500/50 sm:text-sm",placeholder:"PO-XXXXX"},null,512),[[p,r(l).customer_po_number]])]),t("div",null,[e[27]||(e[27]=t("label",{class:"block text-sm font-medium text-slate-500 dark:text-slate-400 mb-2"},"Notes",-1)),i(t("textarea",{"onUpdate:modelValue":e[7]||(e[7]=s=>r(l).notes=s),rows:"3",class:"block w-full rounded-xl border-0 bg-slate-50 dark:bg-slate-800 py-2.5 px-4 text-slate-900 dark:text-white focus:ring-2 focus:ring-blue-500/50 sm:text-sm",placeholder:"Additional notes..."},null,512),[[p,r(l).notes]])])]),t("div",$t,[t("div",Ft,[e[28]||(e[28]=t("span",{class:"text-slate-500 dark:text-slate-400"},"Subtotal",-1)),t("span",Nt,m(r(w)(h.value)),1)]),t("div",Pt,[e[29]||(e[29]=t("span",{class:"text-slate-500 dark:text-slate-400"},"Discount (%)",-1)),i(t("input",{"onUpdate:modelValue":e[8]||(e[8]=s=>r(l).discount_percent=s),type:"number",class:"w-16 rounded-lg border-0 bg-slate-50 dark:bg-slate-800 py-0.5 px-2 text-right text-xs text-slate-900 dark:text-white focus:ring-1 focus:ring-blue-500"},null,512),[[p,r(l).discount_percent]])]),t("div",At,[e[30]||(e[30]=t("span",{class:"text-slate-500 dark:text-slate-400"},"VAT (%)",-1)),i(t("input",{"onUpdate:modelValue":e[9]||(e[9]=s=>r(l).tax_percent=s),type:"number",class:"w-16 rounded-lg border-0 bg-slate-50 dark:bg-slate-800 py-0.5 px-2 text-right text-xs text-slate-900 dark:text-white focus:ring-1 focus:ring-blue-500"},null,512),[[p,r(l).tax_percent]])]),t("div",jt,[e[31]||(e[31]=t("span",{class:"text-slate-900 dark:text-white"},"Total",-1)),t("span",It,m(r(w)(A.value)),1)])])])]),t("div",Tt,[r(l).customer_id?(u(),n("div",Bt,[e[32]||(e[32]=t("h3",{class:"text-xs font-black text-slate-500 uppercase tracking-widest"},"Sold-to Party (Buyer)",-1)),t("div",Et,[t("div",Xt,m(x.customers.find(s=>s.id===r(l).customer_id)?.name),1),t("p",Mt,m(x.customers.find(s=>s.id===r(l).customer_id)?.full_address),1)])])):V("",!0),t("div",Wt,[t("div",Rt,[e[34]||(e[34]=t("h3",{class:"text-xs font-black text-slate-500 dark:text-slate-400 uppercase tracking-widest"},"Ship-to Party (Delivery)",-1)),t("label",zt,[t("div",{class:y(["relative inline-flex h-5 w-9 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out",b.value?"bg-emerald-600":"bg-slate-700"]),onClick:e[10]||(e[10]=s=>b.value=!b.value)},[t("span",{class:y(["pointer-events-none inline-block h-4 w-4 transform rounded-full bg-white shadow transition duration-200 ease-in-out",b.value?"translate-x-4":"translate-x-0"])},null,2)],2),e[33]||(e[33]=t("span",{class:"text-[10px] font-black uppercase tracking-tighter text-slate-500 group-hover:text-slate-600 dark:text-slate-300 transition-colors"},"Same as Buyer",-1))])]),t("div",Gt,[t("div",null,[e[35]||(e[35]=t("label",{class:"block text-sm font-medium text-slate-500 dark:text-slate-400 mb-2"},"Receiver Name",-1)),i(t("input",{"onUpdate:modelValue":e[11]||(e[11]=s=>r(l).shipping_name=s),type:"text",class:y(["block w-full rounded-xl border-0 bg-slate-50 dark:bg-slate-800 py-2.5 px-4 text-slate-900 dark:text-white focus:ring-2 focus:ring-blue-500/50 sm:text-sm",{"opacity-50 cursor-not-allowed":b.value}]),disabled:b.value,placeholder:"Receiver name..."},null,10,Lt),[[p,r(l).shipping_name]])]),t("div",null,[e[36]||(e[36]=t("label",{class:"block text-sm font-medium text-slate-500 dark:text-slate-400 mb-2"},"Shipping Address",-1)),i(t("textarea",{"onUpdate:modelValue":e[12]||(e[12]=s=>r(l).shipping_address=s),rows:"4",class:y(["block w-full rounded-xl border-0 bg-slate-50 dark:bg-slate-800 py-2.5 px-4 text-slate-900 dark:text-white focus:ring-2 focus:ring-blue-500/50 sm:text-sm",{"opacity-50 cursor-not-allowed":b.value}]),disabled:b.value,placeholder:"Detailed shipping address..."},null,10,Qt),[[p,r(l).shipping_address]])])])]),t("div",Ht,[t("button",{type:"submit",disabled:r(l).processing,class:"w-full rounded-xl bg-blue-600 px-4 py-3 text-sm font-bold text-white dark:text-white shadow-lg shadow-blue-500/25 hover:bg-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:ring-offset-slate-900 transition-all disabled:opacity-50 disabled:cursor-not-allowed"},[r(l).processing?(u(),n("span",Kt,"Saving...")):(u(),n("span",Yt,"Save Sales Order"))],8,Jt)])])])],32)])]),_:1},8,["title"])],64))}};export{we as default};
