import{p as U,c as d,b as p,u as r,h as R,d as k,e as t,l as y,j as v,y as j,f as c,o as n,F as x,g as b,t as u,i as h,v as f,G as A,D}from"./app-CVskXPlE.js";import{_ as I}from"./AppLayout-BPbSmNAp.js";import{a as w}from"./helpers-BjqMQcOq.js";import{r as T}from"./ArrowLeftIcon-CLhTKCJv.js";import{r as F}from"./PlusIcon-DfGQN_4v.js";import{r as $}from"./TrashIcon-DUIH6O6G.js";/* empty css            */import"./XMarkIcon-B0wnv3NP.js";import"./SunIcon-CH0hNqUR.js";import"./WrenchScrewdriverIcon-Ch0-x6ah.js";import"./CheckBadgeIcon-BrVRkF10.js";import"./ShoppingCartIcon-C3CFwejV.js";import"./CubeIcon-B3DTt87X.js";import"./TruckIcon-RPY9s92d.js";const B={class:"max-w-full px-4 sm:px-6 lg:px-8 mx-auto"},N={class:"grid grid-cols-1 xl:grid-cols-12 gap-6"},G={class:"xl:col-span-4 glass-card rounded-2xl p-6 space-y-4"},M=["value"],E=["value"],L=["value"],Q={class:"xl:col-span-8 glass-card rounded-2xl p-6"},W={class:"flex items-center justify-between mb-4"},z={class:"space-y-3 max-h-[600px] overflow-y-auto custom-scrollbar pr-2 relative"},H={class:"col-span-12 sm:col-span-4"},J=["value","onChange"],K=["value"],X={class:"col-span-4 sm:col-span-2"},Y=["onUpdate:modelValue"],Z={class:"col-span-4 sm:col-span-3"},ee=["onUpdate:modelValue"],te={class:"col-span-4 sm:col-span-2 text-right py-2.5"},se={class:"text-xs font-mono text-slate-600 dark:text-slate-300"},le={class:"col-span-4 sm:col-span-1 flex justify-end"},re=["onClick"],ae={class:"mt-6 pt-6 border-t border-slate-200 dark:border-slate-800"},oe={class:"flex justify-between items-center"},de={class:"text-xl font-bold text-slate-900 dark:text-white"},ne={class:"glass-card rounded-2xl p-6"},ie={class:"flex justify-end gap-3"},ue=["disabled"],qe={__name:"Create",props:{purchaseOrder:Object,purchaseOrders:Array,suppliers:Array,warehouses:Array,products:Array},setup(m){const g=m,l=U({purchase_order_id:g.purchaseOrder?.id||null,supplier_id:g.purchaseOrder?.supplier_id||"",warehouse_id:g.purchaseOrder?.warehouse_id||"",return_date:new Date().toISOString().split("T")[0],reason:"",items:g.purchaseOrder?.items?.map(a=>({product_id:a.product_id,name:a.product?.name||"Unknown",sku:a.product?.sku||"-",qty:a.qty,unit_price:a.unit_price}))||[]}),_=()=>{l.items.push({product_id:"",name:"",sku:"",qty:1,unit_price:0})},O=a=>{l.items.splice(a,1)},q=(a,e)=>{l.items[a].product_id=e.id,l.items[a].name=e.name,l.items[a].sku=e.sku},C=async a=>{if(a)try{const s=(await A.get(route("purchasing.purchase-returns.po-items",a))).data;l.supplier_id=s.supplier_id,l.warehouse_id=s.warehouse_id,s.items.length===0&&alert("No items available to return. Only items that have been received via Goods Receipt can be returned."),l.items=s.items.map(i=>({product_id:i.product_id,name:i.name,sku:i.sku,qty:parseFloat(i.returnable_qty),unit_price:parseFloat(i.unit_price)}))}catch(e){console.error("Error fetching PO Items:",e)}},S=D(()=>l.items.reduce((a,e)=>a+e.qty*e.unit_price,0)),P=()=>{l.post("/purchasing/returns")};return(a,e)=>(n(),d(x,null,[p(r(R),{title:"Create Purchase Return"}),p(I,{title:"Purchase Returns"},{default:k(()=>[t("div",B,[p(r(y),{href:"/purchasing/returns",class:"inline-flex items-center gap-2 mb-4 text-sm text-slate-500 dark:text-slate-400 hover:text-slate-900 dark:text-white"},{default:k(()=>[p(r(T),{class:"h-4 w-4"}),e[6]||(e[6]=v(" Back to List ",-1))]),_:1}),t("form",{onSubmit:j(P,["prevent"]),class:"space-y-6"},[t("div",N,[t("div",G,[e[14]||(e[14]=t("h3",{class:"text-lg font-semibold text-slate-900 dark:text-white mb-4"},"Return Info",-1)),t("div",null,[e[8]||(e[8]=t("label",{class:"block text-sm font-medium text-slate-500 dark:text-slate-400 mb-1"},"Purchase Order (Optional)",-1)),c(t("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>r(l).purchase_order_id=s),onChange:e[1]||(e[1]=s=>C(r(l).purchase_order_id)),class:"w-full rounded-xl border-0 bg-slate-50 dark:bg-slate-800 py-2.5 text-slate-900 dark:text-white focus:ring-2 focus:ring-blue-500/50"},[e[7]||(e[7]=t("option",{value:null},"Select PO (Optional)",-1)),(n(!0),d(x,null,b(m.purchaseOrders,s=>(n(),d("option",{key:s.id,value:s.id},u(s.po_number)+" - "+u(s.supplier?.name),9,M))),128))],544),[[h,r(l).purchase_order_id]])]),t("div",null,[e[10]||(e[10]=t("label",{class:"block text-sm font-medium text-slate-500 dark:text-slate-400 mb-1"},"Supplier",-1)),c(t("select",{"onUpdate:modelValue":e[2]||(e[2]=s=>r(l).supplier_id=s),class:"w-full rounded-xl border-0 bg-slate-50 dark:bg-slate-800 py-2.5 text-slate-900 dark:text-white focus:ring-2 focus:ring-blue-500/50",required:""},[e[9]||(e[9]=t("option",{value:""},"Select Supplier",-1)),(n(!0),d(x,null,b(m.suppliers,s=>(n(),d("option",{key:s.id,value:s.id},u(s.name),9,E))),128))],512),[[h,r(l).supplier_id]])]),t("div",null,[e[12]||(e[12]=t("label",{class:"block text-sm font-medium text-slate-500 dark:text-slate-400 mb-1"},"Warehouse",-1)),c(t("select",{"onUpdate:modelValue":e[3]||(e[3]=s=>r(l).warehouse_id=s),class:"w-full rounded-xl border-0 bg-slate-50 dark:bg-slate-800 py-2.5 text-slate-900 dark:text-white focus:ring-2 focus:ring-blue-500/50",required:""},[e[11]||(e[11]=t("option",{value:""},"Select Warehouse",-1)),(n(!0),d(x,null,b(m.warehouses,s=>(n(),d("option",{key:s.id,value:s.id},u(s.name),9,L))),128))],512),[[h,r(l).warehouse_id]])]),t("div",null,[e[13]||(e[13]=t("label",{class:"block text-sm font-medium text-slate-500 dark:text-slate-400 mb-1"},"Date",-1)),c(t("input",{type:"date","onUpdate:modelValue":e[4]||(e[4]=s=>r(l).return_date=s),class:"w-full rounded-xl border-0 bg-slate-50 dark:bg-slate-800 py-2.5 text-slate-900 dark:text-white focus:ring-2 focus:ring-blue-500/50",required:""},null,512),[[f,r(l).return_date]])])]),t("div",Q,[t("div",W,[e[16]||(e[16]=t("h3",{class:"text-lg font-semibold text-slate-900 dark:text-white"},"Items to Return",-1)),t("button",{type:"button",onClick:_,class:"text-sm font-medium text-blue-400 hover:text-blue-300 flex items-center gap-1"},[p(r(F),{class:"h-4 w-4"}),e[15]||(e[15]=v(" Add Item ",-1))])]),t("div",z,[e[22]||(e[22]=t("div",{class:"grid grid-cols-12 gap-3 px-3 py-2 mb-2 hidden sm:grid sticky top-0 z-10 bg-white dark:bg-slate-900 border-b border-slate-100 dark:border-slate-800"},[t("div",{class:"col-span-12 sm:col-span-4"},[t("span",{class:"text-[10px] font-bold text-slate-500 uppercase"},"Product")]),t("div",{class:"col-span-4 sm:col-span-2 text-right pr-2"},[t("span",{class:"text-[10px] font-bold text-slate-500 uppercase"},"Qty")]),t("div",{class:"col-span-4 sm:col-span-3 text-right pr-2"},[t("span",{class:"text-[10px] font-bold text-slate-500 uppercase"},"Price")]),t("div",{class:"col-span-4 sm:col-span-2 text-right pr-2"},[t("span",{class:"text-[10px] font-bold text-slate-500 uppercase"},"Total")]),t("div",{class:"col-span-4 sm:col-span-1"})],-1)),(n(!0),d(x,null,b(r(l).items,(s,i)=>(n(),d("div",{key:i,class:"grid grid-cols-12 gap-3 items-end bg-slate-50 dark:bg-slate-800/30 p-3 rounded-xl hover:bg-slate-50 dark:hover:bg-slate-800/50 dark:bg-slate-900 dark:bg-slate-800/50 transition-colors"},[t("div",H,[e[18]||(e[18]=t("label",{class:"block text-[10px] font-bold text-slate-500 uppercase mb-1 sm:hidden"},"Product",-1)),t("select",{value:s.product_id,onChange:o=>q(i,m.products.find(V=>V.id==o.target.value)),class:"w-full rounded-lg border-0 bg-slate-50 dark:bg-slate-800 py-2.5 text-xs text-slate-900 dark:text-white focus:ring-1 focus:ring-blue-500",required:""},[e[17]||(e[17]=t("option",{value:""},"Select Product",-1)),(n(!0),d(x,null,b(m.products,o=>(n(),d("option",{key:o.id,value:o.id},"["+u(o.sku)+"] "+u(o.name),9,K))),128))],40,J)]),t("div",X,[e[19]||(e[19]=t("label",{class:"block text-[10px] font-bold text-slate-500 uppercase mb-1 sm:hidden"},"Qty",-1)),c(t("input",{type:"number","onUpdate:modelValue":o=>s.qty=o,min:"1",step:"any",class:"w-full rounded-lg border-0 bg-slate-50 dark:bg-slate-800 py-2.5 text-xs text-slate-900 dark:text-white focus:ring-1 focus:ring-blue-500 text-right",required:""},null,8,Y),[[f,s.qty]])]),t("div",Z,[e[20]||(e[20]=t("label",{class:"block text-[10px] font-bold text-slate-500 uppercase mb-1 sm:hidden"},"Price",-1)),c(t("input",{type:"number","onUpdate:modelValue":o=>s.unit_price=o,step:"any",class:"w-full rounded-lg border-0 bg-slate-50 dark:bg-slate-800 py-2.5 text-xs text-slate-900 dark:text-white focus:ring-1 focus:ring-blue-500 text-right",required:""},null,8,ee),[[f,s.unit_price]])]),t("div",te,[e[21]||(e[21]=t("label",{class:"block text-[10px] font-bold text-slate-500 uppercase mb-1 sm:hidden"},"Total",-1)),t("span",se,u(r(w)(s.qty*s.unit_price)),1)]),t("div",le,[t("button",{type:"button",onClick:o=>O(i),class:"p-2 text-slate-500 hover:text-red-400 rounded-lg hover:bg-slate-700/50 transition-colors"},[p(r($),{class:"h-4 w-4"})],8,re)])]))),128))]),t("div",ae,[t("div",oe,[e[23]||(e[23]=t("span",{class:"text-slate-500 dark:text-slate-400 font-medium"},"Grand Total",-1)),t("span",de,u(r(w)(S.value)),1)])])])]),t("div",ne,[e[24]||(e[24]=t("label",{class:"block text-sm font-medium text-slate-500 dark:text-slate-400 mb-2"},"Reason for Return",-1)),c(t("textarea",{"onUpdate:modelValue":e[5]||(e[5]=s=>r(l).reason=s),rows:"3",class:"w-full rounded-xl border-0 bg-slate-50 dark:bg-slate-800 text-slate-900 dark:text-white focus:ring-2 focus:ring-blue-500/50",placeholder:"e.g. Defective items, wrong shipment..."},null,512),[[f,r(l).reason]])]),t("div",ie,[p(r(y),{href:"/purchasing/returns",class:"px-6 py-2.5 rounded-xl bg-slate-50 dark:bg-slate-800 text-sm font-semibold text-slate-600 dark:text-slate-300 hover:bg-slate-700"},{default:k(()=>[...e[25]||(e[25]=[v("Cancel",-1)])]),_:1}),t("button",{type:"submit",class:"px-6 py-2.5 rounded-xl bg-blue-600 text-sm font-semibold text-white dark:text-white hover:bg-blue-500 shadow-lg shadow-blue-900/20",disabled:r(l).processing},u(r(l).processing?"Saving...":"Save Return"),9,ue)])],32)])]),_:1})],64))}};export{qe as default};
