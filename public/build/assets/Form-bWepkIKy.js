import{f as E,m as X,q as C,c as n,a as g,u as a,h as M,w as F,b as e,l as R,t as b,i as W,j as i,v as p,o as u,F as y,g as v,k as S,d as z,n as k,e as V,B as _}from"./app-CqAsi7yr.js";import{_ as G}from"./AppLayout-DOsQ-AFe.js";import{_ as L}from"./SearchableSelect-B6aB45wm.js";import{a as Q,f as w}from"./helpers-DnzC1tLX.js";import{r as H}from"./ArrowLeftIcon-Cgkm0phd.js";import{r as J}from"./PlusIcon-CQlipS4B.js";import{r as K}from"./TrashIcon-DAriRt41.js";/* empty css            */import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./XMarkIcon-DByjCOdW.js";import"./SunIcon-DQ65_t9z.js";import"./WrenchScrewdriverIcon-B7Ina7OH.js";import"./DocumentPlusIcon-BHkLA8SB.js";import"./TruckIcon-ztmEnE91.js";import"./DocumentTextIcon-B0Kw4avi.js";import"./ShoppingCartIcon-DW8RbP_z.js";import"./MapPinIcon-tph_a9uB.js";import"./SparklesIcon-BUnC9XDM.js";import"./CubeIcon-PJce7BKH.js";import"./ClockIcon-B0Tykvke.js";import"./CheckCircleIcon-wohXqC3A.js";import"./ShieldCheckIcon-DkayqkYq.js";import"./transition-BB7JBRsa.js";const Y={class:"max-w-full px-4 sm:px-6 lg:px-8 mx-auto space-y-6"},Z={class:"flex items-center gap-4"},ee={class:"text-2xl font-bold text-slate-900 dark:text-white"},te={class:"grid grid-cols-1 lg:grid-cols-12 gap-6"},se={class:"lg:col-span-9 space-y-6"},le={class:"rounded-2xl glass-card p-6 space-y-4"},re={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},ae=["value"],de=["value"],oe={class:"rounded-2xl glass-card overflow-hidden"},ie={class:"p-4 border-b border-slate-200 dark:border-slate-800 flex justify-between items-center"},ne={class:"overflow-x-auto max-h-[600px] overflow-y-auto relative"},ue={class:"w-full text-left text-sm text-slate-500 dark:text-slate-400"},pe={class:"divide-y divide-slate-100 dark:divide-slate-800"},ce={class:"px-4 py-2"},xe={class:"px-4 py-2"},be=["onUpdate:modelValue"],me={class:"px-4 py-2"},fe=["onUpdate:modelValue"],ge=["value"],_e={class:"px-4 py-2"},ke=["onUpdate:modelValue"],ye={key:0,class:"mt-1 flex items-center gap-1"},ve=["title"],we={class:"px-4 py-2"},he=["onUpdate:modelValue"],Oe={class:"px-4 py-2 text-right font-medium text-slate-900 dark:text-white"},Se={class:"px-4 py-2 text-center"},Ve=["onClick","disabled","title"],qe={class:"flex justify-between items-start"},Ue={class:"w-1/2 space-y-4"},De={class:"space-y-2"},Ce={class:"space-y-2"},Fe={class:"w-1/3 space-y-3 bg-white dark:bg-slate-950 p-4 rounded-xl border border-slate-200 dark:border-slate-800"},$e={class:"flex justify-between text-sm"},Ne={class:"text-slate-900 dark:text-white font-medium"},Pe={class:"flex justify-between items-center text-sm"},Ae={class:"flex justify-between items-center text-sm"},je={class:"pt-3 border-t border-slate-200 dark:border-slate-800 flex justify-between text-base font-bold"},Ie={class:"text-emerald-400"},Te={class:"lg:col-span-3 space-y-6"},Be={key:0,class:"rounded-2xl bg-white dark:bg-slate-950/50 border border-slate-200 dark:border-slate-800 p-6 space-y-4"},Ee={class:"space-y-1"},Xe={class:"text-sm font-bold text-slate-900 dark:text-white"},Me={class:"text-xs text-slate-500 dark:text-slate-400 leading-relaxed"},Re={class:"rounded-2xl glass-card p-6 space-y-4"},We={class:"flex items-center justify-between mb-2"},ze={class:"flex items-center gap-2 cursor-pointer group"},Ge={class:"space-y-4"},Le=["disabled"],Qe=["disabled"],He={class:"flex items-center gap-4"},Je=["disabled"],Ke={key:0},Ye={key:1},wt={__name:"Form",props:{salesOrder:Object,soNumber:String,customers:Array,warehouses:Array,products:Array,units:Array,aiData:Object},setup(x){const d=x,l=E({so_number:d.salesOrder?.so_number||d.soNumber,customer_po_number:d.salesOrder?.customer_po_number||d.aiData?.po_number||"",customer_id:d.salesOrder?.customer_id||d.aiData?.matched_customer_id||"",warehouse_id:d.salesOrder?.warehouse_id||"",order_date:d.salesOrder?.order_date?new Date(d.salesOrder.order_date).toISOString().split("T")[0]:d.aiData?.po_date||new Date().toISOString().split("T")[0],delivery_date:d.salesOrder?.delivery_date?new Date(d.salesOrder.delivery_date).toISOString().split("T")[0]:d.aiData?.delivery_date||"",discount_percent:d.salesOrder?.discount_percent||0,tax_percent:d.salesOrder?.tax_percent||11,notes:d.salesOrder?.notes||(d.aiData?"Extracted via AI Gemini":""),shipping_name:d.salesOrder?.shipping_name||"",shipping_address:d.salesOrder?.shipping_address||"",items:d.salesOrder?.items?.map(r=>({id:r.id,product_id:r.product_id,qty:parseFloat(r.qty),qty_delivered:parseFloat(r.qty_delivered||0),unit_id:r.unit_id,unit_price:parseFloat(r.unit_price),discount_percent:parseFloat(r.discount_percent)}))||d.aiData?.items?.map(r=>({product_id:r.matched_product_id||"",qty:parseFloat(r.qty||1),qty_delivered:0,unit_id:d.products?.find(t=>t.id===r.matched_product_id)?.unit_id||"",unit_price:parseFloat(r.unit_price||0),discount_percent:0,description:r.description}))||[{product_id:"",qty:1,qty_delivered:0,unit_id:"",unit_price:0,discount_percent:0}]}),m=X(!d.salesOrder);C(()=>l.customer_id,r=>{if(m.value&&r){const t=d.customers.find(s=>s.id===r);t&&(l.shipping_name=t.name,l.shipping_address=t.full_address||"")}}),C(m,r=>{if(r&&l.customer_id){const t=d.customers.find(s=>s.id===l.customer_id);t&&(l.shipping_name=t.name,l.shipping_address=t.full_address||"")}});const $=_(()=>d.products?d.products.filter(r=>r&&!r.name.startsWith("SO-")).map(r=>({id:r.id,label:`[${r.sku||"#"+r.id}] ${r.name}`})):[]),q=_(()=>{const r=d.products||[];return l.items.map(t=>{const s=r.find(O=>O.id===t.product_id),c=(t.qty||0)*(t.unit_price||0),o=c*((t.discount_percent||0)/100),D=c-o;return{...t,product:s,subtotal:D}})}),h=_(()=>q.value.reduce((r,t)=>r+t.subtotal,0)),N=_(()=>h.value*((l.discount_percent||0)/100)),U=_(()=>h.value-N.value),P=_(()=>U.value*((l.tax_percent||0)/100)),A=_(()=>U.value+P.value),j=()=>{l.items.push({product_id:"",qty:1,qty_delivered:0,unit_id:"",unit_price:0,discount_percent:0})},I=r=>{l.items.splice(r,1)},T=(r,t)=>{if(!d.products)return;const s=d.products.find(c=>c.id===r.product_id);s&&(l.items[t].unit_id=s.unit?.id||s.sales_unit_id,l.items[t].unit_price=parseFloat(s.selling_price||s.price||0))},f=r=>{if(!r.product_id||!d.products)return null;const t=d.products.find(O=>O.id===r.product_id);if(!t)return null;const s=parseFloat(t.selling_price||t.price||0);if(s===0)return null;const c=parseFloat(r.unit_price||0);if(c===s)return{pct:0,standard:s,color:"text-emerald-500",bg:"bg-emerald-500/10",label:"Standard price"};const o=(c-s)/s*100;return Math.abs(o)<=5?{pct:o,standard:s,color:"text-amber-500",bg:"bg-amber-500/10",label:`${o>0?"+":""}${o.toFixed(1)}%`}:{pct:o,standard:s,color:"text-red-500",bg:"bg-red-500/10",label:`${o>0?"+":""}${o.toFixed(1)}%`}},B=()=>{d.salesOrder?l.put(route("sales.orders.update",d.salesOrder.id)):l.post(route("sales.orders.store"))};return(r,t)=>(u(),n(y,null,[g(a(M),{title:x.salesOrder?`Edit SO ${x.salesOrder.so_number}`:"New Sales Order"},null,8,["title"]),g(G,{title:x.salesOrder?"Edit Sales Order":"Create Sales Order"},{default:F(()=>[e("div",Y,[e("div",Z,[g(a(R),{href:r.route("sales.orders.index"),class:"p-2 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-800/50 dark:bg-slate-800 text-slate-500 dark:text-slate-400 hover:text-slate-900 dark:text-white transition-colors"},{default:F(()=>[g(a(H),{class:"h-5 w-5"})]),_:1},8,["href"]),e("h1",ee,b(x.salesOrder?`Edit ${x.salesOrder.so_number}`:"New Sales Order"),1)]),e("form",{onSubmit:W(B,["prevent"]),class:"space-y-6"},[e("div",te,[e("div",se,[e("div",le,[t[20]||(t[20]=e("h3",{class:"text-sm font-medium text-slate-500 dark:text-slate-400 uppercase tracking-wider mb-4"},"Order Details",-1)),e("div",re,[e("div",null,[t[13]||(t[13]=e("label",{class:"block text-sm font-medium text-slate-500 dark:text-slate-400 mb-2"},"SO Number",-1)),i(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>a(l).so_number=s),type:"text",class:"block w-full rounded-xl border-0 bg-slate-50 dark:bg-slate-800 py-2.5 px-4 text-slate-900 dark:text-white focus:ring-2 focus:ring-blue-500/50",required:""},null,512),[[p,a(l).so_number]])]),e("div",null,[t[15]||(t[15]=e("label",{class:"block text-sm font-medium text-slate-500 dark:text-slate-400 mb-2"},"Customer",-1)),i(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>a(l).customer_id=s),class:"block w-full rounded-xl border-0 bg-slate-50 dark:bg-slate-800 py-2.5 px-4 text-slate-900 dark:text-white focus:ring-2 focus:ring-blue-500/50",required:""},[t[14]||(t[14]=e("option",{value:"",disabled:""},"Select Customer",-1)),(u(!0),n(y,null,v(x.customers,s=>(u(),n("option",{key:s.id,value:s.id},b(s.name),9,ae))),128))],512),[[S,a(l).customer_id]])]),e("div",null,[t[17]||(t[17]=e("label",{class:"block text-sm font-medium text-slate-500 dark:text-slate-400 mb-2"},"Warehouse",-1)),i(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>a(l).warehouse_id=s),class:"block w-full rounded-xl border-0 bg-slate-50 dark:bg-slate-800 py-2.5 px-4 text-slate-900 dark:text-white focus:ring-2 focus:ring-blue-500/50",required:""},[t[16]||(t[16]=e("option",{value:"",disabled:""},"Select Warehouse",-1)),(u(!0),n(y,null,v(x.warehouses,s=>(u(),n("option",{key:s.id,value:s.id},b(s.name),9,de))),128))],512),[[S,a(l).warehouse_id]])]),e("div",null,[t[18]||(t[18]=e("label",{class:"block text-sm font-medium text-slate-500 dark:text-slate-400 mb-2"},"Order Date",-1)),i(e("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>a(l).order_date=s),type:"date",class:"block w-full rounded-xl border-0 bg-slate-50 dark:bg-slate-800 py-2.5 px-4 text-slate-900 dark:text-white focus:ring-2 focus:ring-blue-500/50",required:""},null,512),[[p,a(l).order_date]])]),e("div",null,[t[19]||(t[19]=e("label",{class:"block text-sm font-medium text-slate-500 dark:text-slate-400 mb-2"},"Delivery Date",-1)),i(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>a(l).delivery_date=s),type:"date",class:"block w-full rounded-xl border-0 bg-slate-50 dark:bg-slate-800 py-2.5 px-4 text-slate-900 dark:text-white focus:ring-2 focus:ring-blue-500/50"},null,512),[[p,a(l).delivery_date]])])])]),e("div",oe,[e("div",ie,[t[22]||(t[22]=e("h3",{class:"text-sm font-medium text-slate-500 dark:text-slate-400 uppercase tracking-wider"},"Order Items",-1)),e("button",{type:"button",onClick:j,class:"text-sm text-blue-400 hover:text-blue-300 font-medium flex items-center gap-1"},[g(a(J),{class:"h-4 w-4"}),t[21]||(t[21]=z(" Add Item ",-1))])]),e("div",ne,[e("table",ue,[t[24]||(t[24]=e("thead",{class:"bg-white dark:bg-slate-950 text-slate-200 sticky top-0 z-10"},[e("tr",null,[e("th",{class:"px-4 py-3 min-w-[350px]"},"Product"),e("th",{class:"px-4 py-3 w-24"},"Qty"),e("th",{class:"px-4 py-3 w-32"},"Unit"),e("th",{class:"px-4 py-3 w-32"},"Price"),e("th",{class:"px-4 py-3 w-24"},"Disc %"),e("th",{class:"px-4 py-3 w-32 text-right"},"Subtotal"),e("th",{class:"px-4 py-3 w-10"})])],-1)),e("tbody",pe,[(u(!0),n(y,null,v(a(l).items,(s,c)=>(u(),n("tr",{key:c},[e("td",ce,[g(L,{modelValue:s.product_id,"onUpdate:modelValue":o=>s.product_id=o,options:$.value,placeholder:"Search Product...",onChange:o=>T(s,c)},null,8,["modelValue","onUpdate:modelValue","options","onChange"])]),e("td",xe,[i(e("input",{"onUpdate:modelValue":o=>s.qty=o,type:"number",step:"0.01",class:"block w-full rounded-lg border-0 bg-slate-50 dark:bg-slate-800 py-1.5 px-2 text-sm text-slate-900 dark:text-white focus:ring-1 focus:ring-blue-500",required:""},null,8,be),[[p,s.qty]])]),e("td",me,[i(e("select",{"onUpdate:modelValue":o=>s.unit_id=o,class:"block w-full rounded-lg border-0 bg-slate-50 dark:bg-slate-800 py-1.5 px-2 text-sm text-slate-900 dark:text-white focus:ring-1 focus:ring-blue-500"},[t[23]||(t[23]=e("option",{value:"",disabled:""},"Unit",-1)),(u(!0),n(y,null,v(x.units,o=>(u(),n("option",{key:o.id,value:o.id},b(o.code),9,ge))),128))],8,fe),[[S,s.unit_id]])]),e("td",_e,[i(e("input",{"onUpdate:modelValue":o=>s.unit_price=o,type:"number",step:"0.01",class:"block w-full rounded-lg border-0 bg-slate-50 dark:bg-slate-800 py-1.5 px-2 text-sm text-slate-900 dark:text-white focus:ring-1 focus:ring-blue-500 text-right",required:""},null,8,ke),[[p,s.unit_price]]),f(s)?(u(),n("div",ye,[e("span",{class:k(["inline-flex items-center rounded-full px-1.5 py-0.5 text-[10px] font-bold",[f(s).color,f(s).bg]])},b(f(s).label),3),f(s).pct!==0?(u(),n("span",{key:0,class:"text-[10px] text-slate-500 truncate",title:"Standard: Rp "+a(Q)(f(s).standard)}," Std: "+b(a(w)(f(s).standard)),9,ve)):V("",!0)])):V("",!0)]),e("td",we,[i(e("input",{"onUpdate:modelValue":o=>s.discount_percent=o,type:"number",step:"0.01",min:"0",max:"100",class:"block w-full rounded-lg border-0 bg-slate-50 dark:bg-slate-800 py-1.5 px-2 text-sm text-slate-900 dark:text-white focus:ring-1 focus:ring-blue-500 text-center"},null,8,he),[[p,s.discount_percent]])]),e("td",Oe,b(a(w)(q.value[c].subtotal)),1),e("td",Se,[e("button",{type:"button",onClick:o=>I(c),class:k(["transition-colors",s.qty_delivered>0?"text-slate-300 cursor-not-allowed":"text-slate-500 hover:text-red-400"]),disabled:s.qty_delivered>0,title:s.qty_delivered>0?"Cannot delete delivered item":"Remove item"},[g(a(K),{class:"h-4 w-4"})],10,Ve)])]))),128))])])])]),e("div",qe,[e("div",Ue,[e("div",De,[t[25]||(t[25]=e("label",{class:"block text-sm font-medium text-slate-500 dark:text-slate-400"},"SO Number",-1)),i(e("input",{"onUpdate:modelValue":t[5]||(t[5]=s=>a(l).so_number=s),type:"text",class:"block w-full rounded-xl border-0 bg-slate-50 dark:bg-slate-800 py-2.5 px-4 text-slate-900 dark:text-white focus:ring-2 focus:ring-blue-500/50 sm:text-sm",readonly:""},null,512),[[p,a(l).so_number]])]),e("div",Ce,[t[26]||(t[26]=e("label",{class:"block text-sm font-medium text-slate-500 dark:text-slate-400"},"PO Number (Customer)",-1)),i(e("input",{"onUpdate:modelValue":t[6]||(t[6]=s=>a(l).customer_po_number=s),type:"text",class:"block w-full rounded-xl border-0 bg-slate-50 dark:bg-slate-800 py-2.5 px-4 text-slate-900 dark:text-white focus:ring-2 focus:ring-blue-500/50 sm:text-sm",placeholder:"PO-XXXXX"},null,512),[[p,a(l).customer_po_number]])]),e("div",null,[t[27]||(t[27]=e("label",{class:"block text-sm font-medium text-slate-500 dark:text-slate-400 mb-2"},"Notes",-1)),i(e("textarea",{"onUpdate:modelValue":t[7]||(t[7]=s=>a(l).notes=s),rows:"3",class:"block w-full rounded-xl border-0 bg-slate-50 dark:bg-slate-800 py-2.5 px-4 text-slate-900 dark:text-white focus:ring-2 focus:ring-blue-500/50 sm:text-sm",placeholder:"Additional notes..."},null,512),[[p,a(l).notes]])])]),e("div",Fe,[e("div",$e,[t[28]||(t[28]=e("span",{class:"text-slate-500 dark:text-slate-400"},"Subtotal",-1)),e("span",Ne,b(a(w)(h.value)),1)]),e("div",Pe,[t[29]||(t[29]=e("span",{class:"text-slate-500 dark:text-slate-400"},"Discount (%)",-1)),i(e("input",{"onUpdate:modelValue":t[8]||(t[8]=s=>a(l).discount_percent=s),type:"number",class:"w-16 rounded-lg border-0 bg-slate-50 dark:bg-slate-800 py-0.5 px-2 text-right text-xs text-slate-900 dark:text-white focus:ring-1 focus:ring-blue-500"},null,512),[[p,a(l).discount_percent]])]),e("div",Ae,[t[30]||(t[30]=e("span",{class:"text-slate-500 dark:text-slate-400"},"VAT (%)",-1)),i(e("input",{"onUpdate:modelValue":t[9]||(t[9]=s=>a(l).tax_percent=s),type:"number",class:"w-16 rounded-lg border-0 bg-slate-50 dark:bg-slate-800 py-0.5 px-2 text-right text-xs text-slate-900 dark:text-white focus:ring-1 focus:ring-blue-500"},null,512),[[p,a(l).tax_percent]])]),e("div",je,[t[31]||(t[31]=e("span",{class:"text-slate-900 dark:text-white"},"Total",-1)),e("span",Ie,b(a(w)(A.value)),1)])])])]),e("div",Te,[a(l).customer_id?(u(),n("div",Be,[t[32]||(t[32]=e("h3",{class:"text-xs font-black text-slate-500 uppercase tracking-widest"},"Sold-to Party (Buyer)",-1)),e("div",Ee,[e("div",Xe,b(x.customers.find(s=>s.id===a(l).customer_id)?.name),1),e("p",Me,b(x.customers.find(s=>s.id===a(l).customer_id)?.full_address),1)])])):V("",!0),e("div",Re,[e("div",We,[t[34]||(t[34]=e("h3",{class:"text-xs font-black text-slate-500 dark:text-slate-400 uppercase tracking-widest"},"Ship-to Party (Delivery)",-1)),e("label",ze,[e("div",{class:k(["relative inline-flex h-5 w-9 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out",m.value?"bg-emerald-600":"bg-slate-700"]),onClick:t[10]||(t[10]=s=>m.value=!m.value)},[e("span",{class:k(["pointer-events-none inline-block h-4 w-4 transform rounded-full bg-white shadow transition duration-200 ease-in-out",m.value?"translate-x-4":"translate-x-0"])},null,2)],2),t[33]||(t[33]=e("span",{class:"text-[10px] font-black uppercase tracking-tighter text-slate-500 group-hover:text-slate-600 dark:text-slate-300 transition-colors"},"Same as Buyer",-1))])]),e("div",Ge,[e("div",null,[t[35]||(t[35]=e("label",{class:"block text-sm font-medium text-slate-500 dark:text-slate-400 mb-2"},"Receiver Name",-1)),i(e("input",{"onUpdate:modelValue":t[11]||(t[11]=s=>a(l).shipping_name=s),type:"text",class:k(["block w-full rounded-xl border-0 bg-slate-50 dark:bg-slate-800 py-2.5 px-4 text-slate-900 dark:text-white focus:ring-2 focus:ring-blue-500/50 sm:text-sm",{"opacity-50 cursor-not-allowed":m.value}]),disabled:m.value,placeholder:"Receiver name..."},null,10,Le),[[p,a(l).shipping_name]])]),e("div",null,[t[36]||(t[36]=e("label",{class:"block text-sm font-medium text-slate-500 dark:text-slate-400 mb-2"},"Shipping Address",-1)),i(e("textarea",{"onUpdate:modelValue":t[12]||(t[12]=s=>a(l).shipping_address=s),rows:"4",class:k(["block w-full rounded-xl border-0 bg-slate-50 dark:bg-slate-800 py-2.5 px-4 text-slate-900 dark:text-white focus:ring-2 focus:ring-blue-500/50 sm:text-sm",{"opacity-50 cursor-not-allowed":m.value}]),disabled:m.value,placeholder:"Detailed shipping address..."},null,10,Qe),[[p,a(l).shipping_address]])])])]),e("div",He,[e("button",{type:"submit",disabled:a(l).processing,class:"w-full rounded-xl bg-blue-600 px-4 py-3 text-sm font-bold text-white dark:text-white shadow-lg shadow-blue-500/25 hover:bg-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:ring-offset-slate-900 transition-all disabled:opacity-50 disabled:cursor-not-allowed"},[a(l).processing?(u(),n("span",Ke,"Saving...")):(u(),n("span",Ye,"Save Sales Order"))],8,Je)])])])],32)])]),_:1},8,["title"])],64))}};export{wt as default};
