import{q as ue,x as C,w as ce,b as e,a as i,u as d,o as a,c as r,F as S,g as j,n as f,t as n,e as p,i as G,d as g,j as v,v as y,y as pe,k as W,m as b,B as xe,z as I,s as be}from"./app-DJj0I4_2.js";import{_ as me}from"./AppLayout-Cw3w-LyG.js";import{r as fe}from"./ArrowLeftIcon-VCuAU7vO.js";import{r as L}from"./SparklesIcon-DBwbTUJR.js";import{r as R}from"./CheckCircleIcon-1YcH0Cdr.js";import{r as ge}from"./EyeIcon-Dk9vhwAr.js";import{b as ve,a as J,c as _e}from"./WrenchScrewdriverIcon-6yyOC9IM.js";import{r as M}from"./DocumentIcon-ChS4X5X-.js";import{r as he}from"./CloudArrowUpIcon-6x1ftfQ2.js";import{r as E}from"./ExclamationTriangleIcon-DdKlUXw5.js";import{r as V}from"./PencilIcon-CpuSDUaU.js";import{r as K}from"./PlusIcon-CJJHgbuH.js";import{r as ke}from"./TrashIcon-CWDWjfV3.js";import{r as ye}from"./ArrowDownTrayIcon-DUUh1LGL.js";import{r as we}from"./QuestionMarkCircleIcon-CUw1VJlG.js";import{r as Pe}from"./XMarkIcon-DcXZMoax.js";/* empty css            */import"./SunIcon-6nfYrQKj.js";import"./DocumentPlusIcon-DUtjUjGf.js";import"./TruckIcon-DzH80bEU.js";import"./DocumentTextIcon-DkRtcxc6.js";import"./ShoppingCartIcon-BkrPzDVf.js";import"./MapPinIcon-ZV1BRRjL.js";import"./CubeIcon-DnZluuQo.js";import"./ClockIcon-B_Wtk2zb.js";import"./ShieldCheckIcon-DSHebIc3.js";const Ue={class:"max-w-full mx-auto px-4"},Ce={class:"mb-8"},Oe={class:"flex items-center gap-4 mb-4"},Se={href:"/sales/orders",class:"p-2 rounded-xl bg-slate-100 dark:bg-slate-800 text-slate-500 hover:text-slate-700 dark:hover:text-white transition-colors"},je={class:"flex items-center gap-3"},Ie={class:"p-3 rounded-2xl bg-gradient-to-br from-amber-500/20 to-orange-500/20 text-amber-500"},Re={"aria-label":"Progress",class:"mt-6"},Ae={class:"flex items-center"},Fe={class:"flex items-center"},De={key:1,class:"text-sm font-bold"},Ne={class:"ml-3 hidden sm:block"},$e={class:"text-xs text-slate-500"},Le={key:0,class:"bg-white dark:bg-slate-900 rounded-3xl border border-slate-200 dark:border-slate-800 p-6 shadow-xl"},Me={class:"flex items-center justify-between mb-4"},Ee={class:"flex items-center gap-2"},Ve=["href"],qe={class:"rounded-2xl border border-slate-200 dark:border-slate-700 overflow-hidden bg-slate-100 dark:bg-slate-800"},Te=["src"],ze=["src"],Be={key:2,class:"w-full h-[600px] flex items-center justify-center text-slate-400"},Ge={class:"text-center"},We={class:"bg-white dark:bg-slate-900 rounded-3xl border border-slate-200 dark:border-slate-800 p-6 shadow-xl"},Je={key:0,class:"flex flex-col items-center py-8"},Ke={class:"p-5 rounded-full bg-slate-50 dark:bg-slate-800 group-hover:bg-blue-500/10 transition-colors"},He={class:"text-center"},Qe={class:"text-lg font-semibold text-slate-700 dark:text-slate-200"},Ye={key:0,class:"mt-6 w-full p-4 rounded-xl bg-red-500/10 border border-red-500/20 flex items-center gap-3 text-red-500"},Xe={class:"text-sm font-medium"},Ze=["disabled"],et={key:1,class:"flex flex-col items-center py-16"},tt={class:"relative"},st={class:"absolute inset-0 flex items-center justify-center"},lt={class:"mt-12 w-full max-w-xs space-y-4"},at={class:"flex items-center gap-3"},rt={class:"flex items-center gap-3"},ot={key:2,class:"space-y-5"},dt={class:"bg-emerald-500/10 border border-emerald-500/20 p-4 rounded-2xl flex items-center gap-3 text-emerald-500"},nt={class:"text-sm font-bold"},it={class:"grid grid-cols-3 gap-4"},ut={class:"space-y-2"},ct={class:"text-[10px] font-bold text-slate-400 uppercase tracking-widest flex items-center gap-1"},pt={class:"space-y-2"},xt={class:"text-[10px] font-bold text-slate-400 uppercase tracking-widest flex items-center gap-1"},bt={class:"space-y-2"},mt={class:"text-[10px] font-bold text-slate-400 uppercase tracking-widest flex items-center gap-1"},ft={class:"rounded-2xl border border-slate-200 dark:border-slate-700 flex flex-col",style:{"max-height":"400px"}},gt={class:"overflow-y-auto flex-1"},vt={class:"min-w-full"},_t={class:"divide-y divide-slate-200 dark:divide-slate-700"},ht={class:"px-2 py-2 text-center w-[4%]"},kt={class:"text-sm font-bold text-slate-400"},yt={class:"px-2 py-2 w-[20%]"},wt=["onUpdate:modelValue"],Pt={class:"px-2 py-2 w-[12%]"},Ut=["onUpdate:modelValue"],Ct={class:"px-2 py-2 text-center w-[8%]"},Ot={key:0},St={key:1,class:"text-xs text-slate-400"},jt={class:"px-2 py-2 w-[6%]"},It=["onUpdate:modelValue"],Rt={class:"px-2 py-2 w-[12%]"},At=["onUpdate:modelValue"],Ft={class:"px-2 py-2 w-[18%]"},Dt={key:0,class:"space-y-1"},Nt={class:"flex items-center gap-2 text-xs"},$t={class:"font-bold text-blue-500"},Lt={class:"flex items-center gap-2 text-xs"},Mt={class:"font-bold text-emerald-500"},Et={key:0,class:"mt-1"},Vt={key:1},qt={key:1,class:"text-xs text-slate-400 italic"},Tt={class:"px-2 py-2 text-center w-[8%]"},zt={class:"flex items-center justify-center gap-1"},Bt=["onClick"],Gt=["onClick"],Wt={key:0,class:"bg-white dark:bg-slate-900"},Jt={class:"p-3 bg-slate-50 dark:bg-slate-800/50 border-t border-slate-200 dark:border-slate-700"},Kt={class:"flex gap-4 pt-4"},Ht=["disabled"],Qt=["disabled"],Yt=["disabled"],Xt={key:3,class:"space-y-5"},Zt={class:"flex items-center justify-between"},es={class:"flex gap-2"},ts={key:0,class:"px-2 py-1 text-xs font-bold bg-emerald-500/20 text-emerald-600 rounded-full"},ss={key:1,class:"px-2 py-1 text-xs font-bold bg-amber-500/20 text-amber-600 rounded-full"},ls={key:2,class:"px-2 py-1 text-xs font-bold bg-red-500/20 text-red-600 rounded-full"},as={class:"space-y-4 max-h-96 overflow-y-auto pr-2"},rs={class:"flex items-start justify-between"},os={class:"flex-1"},ds={class:"flex items-center gap-2"},ns={class:"font-bold text-slate-900 dark:text-white"},is={key:0,class:"text-xs text-slate-400"},us={class:"mt-2 grid grid-cols-3 gap-4 text-xs"},cs={class:"ml-1 font-bold text-slate-700 dark:text-slate-200"},ps={key:0,class:"mt-3 p-2 rounded-lg bg-white/50 dark:bg-slate-900/50 text-xs"},xs={class:"flex gap-4 pt-4"},bs={class:"mt-8 flex items-center justify-between"},ms={href:"/guide/ai-po-extractor.html",target:"_blank",class:"inline-flex items-center gap-1.5 text-sm text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 font-semibold transition-colors"},fs={key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm"},gs={class:"bg-white dark:bg-slate-900 rounded-2xl shadow-xl w-full max-w-md overflow-hidden"},vs={class:"p-4 border-b border-slate-200 dark:border-slate-800 flex justify-between items-center bg-slate-50 dark:bg-slate-800/50"},_s={class:"p-6 space-y-4"},hs={class:"grid grid-cols-2 gap-4"},ks=["value"],ys={class:"p-4 bg-slate-50 dark:bg-slate-800/50 border-t border-slate-200 dark:border-slate-800 flex justify-end gap-3"},ws=["disabled"],Ps={key:0},Us={key:1},Xs={__name:"POExtractor",props:{customers:Array,units:Array,categories:Array},setup(H){const A=H,F=b(!1),u=b({name:"",sku:"",unit_id:"",category_id:"",selling_price:0,type:"product",product_type:"finished_good",itemIndex:null}),O=b(!1),Q=(l,t)=>{if(u.value={name:l.description,sku:"",unit_id:"",category_id:"",selling_price:l.po_price||0,type:"product",product_type:"finished_good",itemIndex:t},l.unit&&A.units){const s=l.unit.trim().toLowerCase(),m=A.units.find(x=>x.name.toLowerCase()===s||x.code&&x.code.toLowerCase()===s);m&&(u.value.unit_id=m.id)}if(l.description){const s=l.description.trim().split(/\s+/)[0];s&&s.length>=3&&(u.value.sku=s)}F.value=!0},D=()=>{F.value=!1,u.value.itemIndex=null},Y=async()=>{if(!u.value.name||!u.value.unit_id){alert("Please fill Name and Unit");return}O.value=!0;try{const l=await I.post("/sales/po-extractor/store-product",u.value);if(l.data.success){const t=l.data.product;if(u.value.itemIndex!==null){const s=o.value.items[u.value.itemIndex];s.matched_product_id=t.id,s.matched_product_name=t.name,s.matched_sku=t.sku,s.db_price=t.selling_price,s.current_stock=t.current_stock}D()}}catch(l){alert("Failed to register product: "+(l.response?.data?.message||l.message))}finally{O.value=!1}},_=b(null),q=b(null),h=b(null),N=b(!1),P=b(!1),k=b(null),U=b(null),w=b(null),c=b(1),o=b({po_number:"",po_date:"",customer_name:"",items:[]});ue(U,l=>{l&&(o.value={po_number:l.po_number||"",po_date:l.po_date||"",customer_name:l.customer_name||"",items:(l.items||[]).map(t=>({description:t.description||"",qty:t.qty||0,unit:t.unit||"Pcs",unit_price:t.unit_price||0,po_price:t.po_price||t.unit_price||0,db_price:t.db_price||0,current_stock:t.current_stock||0,price_mismatch:t.price_mismatch||!1,matched_product_id:t.matched_product_id||null,matched_product_name:t.matched_product_name||"",matched_sku:t.matched_sku||""}))})},{deep:!0});const X=()=>{o.value.items.push({description:"",qty:1,unit:"Pcs",unit_price:0,matched_product_id:null,matched_product_name:"",matched_sku:"",match_status:"NO_MATCH"})},Z=l=>{o.value.items.splice(l,1)},T=xe(()=>{if(!_.value)return null;const l=_.value.type;return l==="application/pdf"?"pdf":l.startsWith("image/")?"image":"unknown"}),ee=()=>{_.value&&(h.value&&URL.revokeObjectURL(h.value),h.value=URL.createObjectURL(_.value))},te=()=>{h.value&&(URL.revokeObjectURL(h.value),h.value=null)},z=l=>{const t=l.target.files?.[0]||l.dataTransfer?.files?.[0];t&&(_.value=t,k.value=null,ee())},se=()=>{q.value.click()},le=()=>{te(),_.value=null,k.value=null,U.value=null,w.value=null,c.value=1},ae=async()=>{if(!_.value)return;N.value=!0,c.value=2,k.value=null;const l=new FormData;l.append("file",_.value);try{const t=await I.post("/sales/orders/ai-extract",l,{headers:{"Content-Type":"multipart/form-data"}});t.data.success?(U.value=t.data.data,c.value=3):(k.value=t.data.message||"Failed to extract data from PO.",c.value=1)}catch(t){k.value=t.response?.data?.message||"Failed to extract data from PO using AI. Please check your API configuration.",c.value=1}finally{N.value=!1}},re=async()=>{if(!(!o.value?.items||o.value.items.length===0)){P.value=!0,k.value=null;try{const l=o.value.items.map(s=>({product_id:s.matched_product_id||null,product_name:s.description||s.matched_product_name||"Unknown",qty:s.qty||0,unit_price:s.unit_price||0})),t=await I.post("/sales/orders/analyze-fulfillment",{items:l});t.data.success?(w.value={items:t.data.items,summary:t.data.summary},c.value=4):k.value=t.data.message||"Failed to analyze fulfillment."}catch(l){k.value=l.response?.data?.message||"Failed to analyze fulfillment."}finally{P.value=!1}}},B=()=>{if(!o.value||o.value.items.length===0)return;const l={...U.value,po_number:o.value.po_number,po_date:o.value.po_date,customer_name:o.value.customer_name,items:o.value.items};be.post("/sales/orders/create-from-ai",{data:l})},oe=l=>l==="ok"?"bg-emerald-500/10 border-emerald-500/20":l==="warning"?"bg-amber-500/10 border-amber-500/20":"bg-red-500/10 border-red-500/20",de=l=>l==="ok"?R:l==="warning"?E:E,ne=l=>l==="ok"?"text-emerald-500":l==="warning"?"text-amber-500":"text-red-500",$=[{id:1,name:"Upload",description:"Upload PO document"},{id:2,name:"Processing",description:"AI analyzing"},{id:3,name:"Review",description:"Verify extracted data"},{id:4,name:"Fulfillment",description:"Stock analysis"}],ie=async()=>{if(!(!o.value||o.value.items.length===0))try{const l=await I.post("/sales/po-extractor/export",o.value,{responseType:"blob"}),t=window.URL.createObjectURL(new Blob([l.data])),s=document.createElement("a");s.href=t,s.setAttribute("download",`PO_Extraction_${o.value.po_number||"Draft"}.xlsx`),document.body.appendChild(s),s.click(),s.remove(),window.URL.revokeObjectURL(t)}catch(l){if(console.error(l),l.response&&l.response.data instanceof Blob){const t=await l.response.data.text();try{const s=JSON.parse(t);alert("Export Failed: "+(s.message||JSON.stringify(s)))}catch{alert("Export Failed: "+t.substring(0,100))}}else alert("Failed to export Excel.")}};return(l,t)=>(a(),C(me,{title:"AI PO Extractor"},{default:ce(()=>[e("div",Ue,[e("div",Ce,[e("div",Oe,[e("a",Se,[i(d(fe),{class:"h-5 w-5"})]),e("div",je,[e("div",Ie,[i(d(L),{class:"h-8 w-8"})]),t[10]||(t[10]=e("div",null,[e("h1",{class:"text-2xl font-bold text-slate-900 dark:text-white"},"AI Purchase Order Extractor"),e("p",{class:"text-sm text-slate-500"},"Powered by Gemini AI - Extract PO data automatically")],-1))])]),e("nav",Re,[e("ol",Ae,[(a(),r(S,null,j($,(s,m)=>e("li",{key:s.id,class:f([m!==$.length-1?"flex-1":"","relative"])},[e("div",Fe,[e("div",{class:f(["relative z-10 flex h-10 w-10 items-center justify-center rounded-full border-2 transition-all duration-300",c.value>s.id?"border-emerald-500 bg-emerald-500 text-white":c.value===s.id?"border-blue-500 bg-blue-500 text-white":"border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-800 text-slate-500"])},[c.value>s.id?(a(),C(d(R),{key:0,class:"h-5 w-5"})):(a(),r("span",De,n(s.id),1))],2),e("div",Ne,[e("p",{class:f(["text-sm font-bold",c.value>=s.id?"text-slate-900 dark:text-white":"text-slate-400"])},n(s.name),3),e("p",$e,n(s.description),1)])]),m!==$.length-1?(a(),r("div",{key:0,class:f(["absolute top-5 left-10 -ml-px h-0.5 w-full transition-colors duration-300",c.value>s.id?"bg-emerald-500":"bg-slate-200 dark:bg-slate-700"])},null,2)):p("",!0)],2)),64))])])]),e("div",{class:f(["grid gap-6",c.value>=3&&h.value?"lg:grid-cols-2":"lg:grid-cols-1 max-w-2xl mx-auto"])},[c.value>=3&&h.value?(a(),r("div",Le,[e("div",Me,[e("div",Ee,[i(d(ge),{class:"h-5 w-5 text-slate-500"}),t[11]||(t[11]=e("span",{class:"text-sm font-bold text-slate-700 dark:text-slate-300"},"Original Document",-1))]),e("a",{href:h.value,target:"_blank",class:"p-2 rounded-xl text-slate-400 hover:text-slate-600 hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors",title:"Open in new tab"},[i(d(ve),{class:"h-5 w-5"})],8,Ve)]),e("div",qe,[T.value==="pdf"?(a(),r("iframe",{key:0,src:h.value,class:"w-full h-[600px]",title:"PO Document Preview"},null,8,Te)):T.value==="image"?(a(),r("img",{key:1,src:h.value,class:"w-full h-[600px] object-contain",alt:"PO Document Preview"},null,8,ze)):(a(),r("div",Be,[e("div",Ge,[i(d(M),{class:"h-16 w-16 mx-auto mb-3"}),t[12]||(t[12]=e("p",{class:"text-sm"},"Preview not available for this file type",-1))])]))])])):p("",!0),e("div",We,[c.value===1?(a(),r("div",Je,[e("div",{onClick:se,onDragover:t[0]||(t[0]=G(()=>{},["prevent"])),onDrop:G(z,["prevent"]),class:"w-full h-64 border-2 border-dashed border-slate-200 dark:border-slate-700 rounded-3xl flex flex-col items-center justify-center gap-4 cursor-pointer hover:border-blue-500/50 hover:bg-blue-500/5 transition-all group"},[e("div",Ke,[i(d(he),{class:"h-12 w-12 text-slate-400 group-hover:text-blue-500 transition-colors"})]),e("div",He,[e("p",Qe,n(_.value?_.value.name:"Click to upload or drag & drop"),1),t[13]||(t[13]=e("p",{class:"text-sm text-slate-500 mt-1"},"PDF or Image (Max 5MB)",-1))]),e("input",{ref_key:"fileInput",ref:q,type:"file",class:"hidden",accept:"application/pdf,image/png,image/jpeg,image/jpg,image/gif,image/webp",onChange:z},null,544)],32),k.value?(a(),r("div",Ye,[i(d(E),{class:"h-5 w-5 shrink-0"}),e("span",Xe,n(k.value),1)])):p("",!0),e("button",{onClick:ae,disabled:!_.value||N.value,class:"mt-8 w-full py-4 px-6 rounded-2xl bg-gradient-to-r from-blue-600 to-indigo-600 text-white font-bold shadow-lg shadow-blue-500/25 dark:shadow-blue-500/10 hover:shadow-xl transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-3 text-lg"},[i(d(L),{class:"h-6 w-6"}),t[14]||(t[14]=g(" Start AI Extraction ",-1))],8,Ze)])):p("",!0),c.value===2?(a(),r("div",et,[e("div",tt,[t[15]||(t[15]=e("div",{class:"w-28 h-28 rounded-full border-4 border-slate-100 dark:border-slate-800 border-t-blue-500 animate-spin"},null,-1)),e("div",st,[i(d(L),{class:"h-10 w-10 text-amber-500 animate-pulse"})])]),t[19]||(t[19]=e("h4",{class:"mt-10 text-xl font-bold text-slate-900 dark:text-white"},"AI is reading your document...",-1)),t[20]||(t[20]=e("p",{class:"mt-3 text-sm text-slate-500 text-center max-w-sm"}," Gemini is identifying products, quantities, and customer details. This may take a moment. ",-1)),e("div",lt,[e("div",at,[i(d(R),{class:"h-6 w-6 text-emerald-500"}),t[16]||(t[16]=e("span",{class:"text-sm font-semibold text-slate-400"},"File Uploaded",-1))]),e("div",rt,[i(d(J),{class:"h-6 w-6 text-blue-500 animate-spin"}),t[17]||(t[17]=e("span",{class:"text-sm font-semibold text-slate-700 dark:text-slate-200"},"Processing with Multimodal Vision",-1))]),t[18]||(t[18]=e("div",{class:"flex items-center gap-3"},[e("div",{class:"h-6 w-6 rounded-full border-2 border-slate-200 dark:border-slate-700"}),e("span",{class:"text-sm font-semibold text-slate-400"},"Matching with Product Catalog")],-1))])])):p("",!0),c.value===3?(a(),r("div",ot,[e("div",dt,[i(d(R),{class:"h-6 w-6"}),e("div",nt,"Extraction Successful! AI found "+n(U.value?.items?.length||0)+" items. You can edit the data below.",1)]),e("div",it,[e("div",ut,[e("label",ct,[i(d(V),{class:"h-3 w-3"}),t[21]||(t[21]=g(" Customer PO Number ",-1))]),v(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>o.value.po_number=s),type:"text",class:"w-full px-4 py-2.5 rounded-xl bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 text-slate-900 dark:text-white text-sm font-medium focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all",placeholder:"Enter PO Number..."},null,512),[[y,o.value.po_number]])]),e("div",pt,[e("label",xt,[i(d(V),{class:"h-3 w-3"}),t[22]||(t[22]=g(" Customer Name ",-1))]),v(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>o.value.customer_name=s),type:"text",class:"w-full px-4 py-2.5 rounded-xl bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 text-slate-900 dark:text-white text-sm font-medium focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all",placeholder:"Enter Customer Name..."},null,512),[[y,o.value.customer_name]])]),e("div",bt,[e("label",mt,[i(d(V),{class:"h-3 w-3"}),t[23]||(t[23]=g(" PO Date ",-1))]),v(e("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>o.value.po_date=s),type:"date",class:"w-full px-4 py-2.5 rounded-xl bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 text-slate-900 dark:text-white text-sm font-medium focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all"},null,512),[[y,o.value.po_date]])])]),e("div",ft,[t[29]||(t[29]=e("table",{class:"min-w-full"},[e("thead",{class:"bg-slate-100 dark:bg-slate-800"},[e("tr",null,[e("th",{class:"px-2 py-3 text-center text-[10px] font-bold text-slate-500 uppercase tracking-wider w-[4%]"},"No"),e("th",{class:"px-2 py-3 text-left text-[10px] font-bold text-slate-500 uppercase tracking-wider w-[20%]"},"Description"),e("th",{class:"px-2 py-3 text-center text-[10px] font-bold text-slate-500 uppercase tracking-wider w-[12%]"},"Qty"),e("th",{class:"px-2 py-3 text-center text-[10px] font-bold text-slate-500 uppercase tracking-wider w-[8%]"},"Stock"),e("th",{class:"px-2 py-3 text-center text-[10px] font-bold text-slate-500 uppercase tracking-wider w-[6%]"},"Unit"),e("th",{class:"px-2 py-3 text-left text-[10px] font-bold text-slate-500 uppercase tracking-wider w-[12%]"},"PO Price"),e("th",{class:"px-2 py-3 text-left text-[10px] font-bold text-slate-500 uppercase tracking-wider w-[18%]"},"Price Comparison"),e("th",{class:"px-2 py-3 text-center text-[10px] font-bold text-slate-500 uppercase tracking-wider w-[8%]"},"Act")])])],-1)),e("div",gt,[e("table",vt,[e("tbody",_t,[(a(!0),r(S,null,j(o.value.items,(s,m)=>(a(),r("tr",{key:m,class:"bg-white dark:bg-slate-900 hover:bg-slate-50 dark:hover:bg-slate-800/50 transition-colors"},[e("td",ht,[e("span",kt,n(m+1),1)]),e("td",yt,[v(e("input",{"onUpdate:modelValue":x=>s.description=x,type:"text",class:"w-full px-2 py-1.5 rounded-lg bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 text-sm text-slate-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none",placeholder:"Product..."},null,8,wt),[[y,s.description]])]),e("td",Pt,[v(e("input",{"onUpdate:modelValue":x=>s.qty=x,type:"number",min:"1",class:"w-full px-2 py-1.5 rounded-lg bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 text-sm text-slate-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none text-center"},null,8,Ut),[[y,s.qty,void 0,{number:!0}]])]),e("td",Ct,[s.current_stock>0?(a(),r("div",Ot,[e("span",{class:f(["px-2 py-1 rounded-lg text-xs font-bold",s.current_stock>=s.qty?"bg-emerald-500/10 text-emerald-600":"bg-red-500/10 text-red-600"])},n(Number(s.current_stock).toLocaleString("id-ID")),3)])):(a(),r("span",St,"-"))]),e("td",jt,[v(e("input",{"onUpdate:modelValue":x=>s.unit=x,type:"text",class:"w-full px-1 py-1.5 rounded-lg bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 text-sm text-slate-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none text-center",placeholder:"Pcs"},null,8,It),[[y,s.unit]])]),e("td",Rt,[v(e("input",{"onUpdate:modelValue":x=>s.unit_price=x,type:"number",min:"0",class:"w-full px-2 py-1.5 rounded-lg bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 text-sm text-slate-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none"},null,8,At),[[y,s.unit_price,void 0,{number:!0}]])]),e("td",Ft,[s.db_price>0?(a(),r("div",Dt,[e("div",Nt,[t[24]||(t[24]=e("span",{class:"text-slate-400 w-12"},"PO:",-1)),e("span",$t,"Rp "+n(Number(s.po_price||0).toLocaleString("id-ID")),1)]),e("div",Lt,[t[25]||(t[25]=e("span",{class:"text-slate-400 w-12"},"Master:",-1)),e("span",Mt,"Rp "+n(Number(s.db_price||0).toLocaleString("id-ID")),1)]),s.po_price&&s.db_price&&Math.abs(s.po_price-s.db_price)>.01?(a(),r("div",Et,[e("span",{class:f(["px-2 py-0.5 rounded-full text-[10px] font-bold",s.po_price>s.db_price?"bg-emerald-500/10 text-emerald-600":"bg-red-500/10 text-red-600"])},n(s.po_price>s.db_price?"â†‘":"â†“")+" Rp "+n(Math.abs(s.po_price-s.db_price).toLocaleString("id-ID"))+" ("+n((Math.abs(s.po_price-s.db_price)/s.db_price*100).toFixed(1))+"%) ",3)])):s.po_price&&s.db_price?(a(),r("div",Vt,[...t[26]||(t[26]=[e("span",{class:"px-2 py-0.5 rounded-full text-[10px] font-bold bg-emerald-500/10 text-emerald-600"},"âœ“ Match",-1)])])):p("",!0)])):(a(),r("span",qt,"No match"))]),e("td",Tt,[e("div",zt,[s.matched_product_id?p("",!0):(a(),r("button",{key:0,onClick:x=>Q(s,m),class:"p-1.5 rounded-lg bg-blue-500/10 text-blue-500 hover:bg-blue-500/20 transition-colors",title:"Register new product"},[i(d(K),{class:"h-4 w-4"})],8,Bt)),e("button",{onClick:x=>Z(m),class:"p-1.5 rounded-lg bg-red-500/10 text-red-500 hover:bg-red-500/20 transition-colors",title:"Remove item"},[i(d(ke),{class:"h-4 w-4"})],8,Gt)])])]))),128)),o.value.items.length===0?(a(),r("tr",Wt,[...t[27]||(t[27]=[e("td",{colspan:"8",class:"px-4 py-8 text-center text-slate-400"},' No items. Click "Add Item" to add a new row. ',-1)])])):p("",!0)])])]),e("div",Jt,[e("button",{onClick:X,class:"w-full py-2.5 rounded-xl border-2 border-dashed border-slate-300 dark:border-slate-600 text-slate-500 hover:border-blue-500 hover:text-blue-500 transition-all flex items-center justify-center gap-2 text-sm font-medium"},[i(d(K),{class:"h-4 w-4"}),t[28]||(t[28]=g(" Add Item ",-1))])])]),t[32]||(t[32]=e("div",{class:"p-4 rounded-xl bg-blue-500/10 border border-blue-500/20 text-sm text-blue-600 dark:text-blue-400"},[g(" âœï¸ "),e("strong",null,"Edit Mode:"),g(" Anda dapat mengedit semua data di atas sebelum Generate Draft SO. Perubahan yang anda buat akan langsung digunakan untuk membuat Sales Order. ")],-1)),e("div",Kt,[e("button",{onClick:le,class:"py-3 px-6 rounded-2xl bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-300 font-bold hover:bg-slate-200 transition-all"}," Try Again "),e("button",{onClick:ie,disabled:o.value.items.length===0,class:"py-3 px-6 rounded-2xl bg-emerald-100 dark:bg-emerald-900/30 text-emerald-600 dark:text-emerald-400 font-bold hover:bg-emerald-200 dark:hover:bg-emerald-900/50 transition-all flex items-center justify-center gap-2"},[i(d(ye),{class:"h-5 w-5"}),t[30]||(t[30]=g(" Export Excel ",-1))],8,Ht),e("button",{onClick:re,disabled:P.value||o.value.items.length===0,class:"flex-1 py-3 px-6 rounded-2xl bg-amber-500 text-white font-bold shadow-lg shadow-amber-500/25 hover:bg-amber-400 transition-all flex items-center justify-center gap-2 disabled:opacity-50"},[P.value?(a(),C(d(J),{key:1,class:"h-5 w-5 animate-spin"})):(a(),C(d(_e),{key:0,class:"h-5 w-5"})),g(" "+n(P.value?"Analyzing...":"Analyze Fulfillment"),1)],8,Qt),e("button",{onClick:B,disabled:o.value.items.length===0,class:"flex-1 py-3 px-6 rounded-2xl bg-blue-600 text-white font-bold shadow-lg shadow-blue-500/25 hover:bg-blue-500 transition-all flex items-center justify-center gap-2 disabled:opacity-50"},[i(d(M),{class:"h-5 w-5"}),t[31]||(t[31]=g(" Generate Draft SO ",-1))],8,Yt)])])):p("",!0),c.value===4?(a(),r("div",Xt,[e("div",Zt,[t[33]||(t[33]=e("div",null,[e("h3",{class:"text-lg font-bold text-slate-900 dark:text-white"},"Fulfillment Analysis"),e("p",{class:"text-xs text-slate-500 dark:text-slate-400"},"Stock check & recommendations")],-1)),e("div",es,[w.value?.summary?.items_ok>0?(a(),r("span",ts,n(w.value.summary.items_ok)+" OK ",1)):p("",!0),w.value?.summary?.items_warning>0?(a(),r("span",ss,n(w.value.summary.items_warning)+" Warning ",1)):p("",!0),w.value?.summary?.items_critical>0?(a(),r("span",ls,n(w.value.summary.items_critical)+" Critical ",1)):p("",!0)])]),e("div",as,[(a(!0),r(S,null,j(w.value?.items,(s,m)=>(a(),r("div",{key:m,class:f(["p-4 rounded-2xl border",oe(s.priority)])},[e("div",rs,[e("div",os,[e("div",ds,[(a(),C(pe(de(s.priority)),{class:f(["h-5 w-5",ne(s.priority)])},null,8,["class"])),e("span",ns,n(s.product_name),1),s.product_sku?(a(),r("span",is,"("+n(s.product_sku)+")",1)):p("",!0)]),e("div",us,[e("div",null,[t[34]||(t[34]=e("span",{class:"text-slate-400"},"Ordered:",-1)),e("span",cs,n(s.required_qty),1)]),e("div",null,[t[35]||(t[35]=e("span",{class:"text-slate-400"},"Current Stock:",-1)),e("span",{class:f(["ml-1 font-bold",s.current_stock>=s.required_qty?"text-emerald-500":"text-red-500"])},n(s.current_stock),3)]),e("div",null,[t[36]||(t[36]=e("span",{class:"text-slate-400"},"Shortage:",-1)),e("span",{class:f(["ml-1 font-bold",s.gap<0?"text-red-500":"text-emerald-500"])},n(s.gap<0?Math.abs(s.gap):0),3)])]),s.recommendation?(a(),r("div",ps,[e("span",{class:f(["font-medium",s.recommendation.type==="success"?"text-emerald-600":"",s.recommendation.type==="purchase"?"text-blue-600":"",s.recommendation.type==="manufacture"?"text-purple-600":"",s.recommendation.type==="warning"?"text-amber-600":""])}," ðŸ’¡ "+n(s.recommendation.message),3)])):p("",!0)])])],2))),128))]),e("div",xs,[e("button",{onClick:t[4]||(t[4]=s=>c.value=3),class:"py-3 px-6 rounded-2xl bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-300 font-bold hover:bg-slate-200 transition-all"}," Back "),e("button",{onClick:B,class:"flex-1 py-3 px-6 rounded-2xl bg-blue-600 text-white font-bold shadow-lg shadow-blue-500/25 hover:bg-blue-500 transition-all flex items-center justify-center gap-2"},[i(d(M),{class:"h-5 w-5"}),t[37]||(t[37]=g(" Proceed to Generate SO ",-1))])])])):p("",!0)])],2),e("div",bs,[e("a",ms,[i(d(we),{class:"h-4 w-4"}),t[38]||(t[38]=g(" User Guide ",-1))]),t[39]||(t[39]=e("p",{class:"text-xs text-slate-500 dark:text-slate-400 font-medium"}," Tip: Best results come from high-resolution images or clear PDF documents. ",-1))])]),F.value?(a(),r("div",fs,[e("div",gs,[e("div",vs,[t[40]||(t[40]=e("h3",{class:"font-bold text-slate-900 dark:text-white"},"Register New Product",-1)),e("button",{onClick:D,class:"text-slate-500 hover:text-slate-700 dark:hover:text-slate-300"},[i(d(Pe),{class:"h-5 w-5"})])]),e("div",_s,[e("div",null,[t[41]||(t[41]=e("label",{class:"block text-xs font-bold text-slate-500 uppercase mb-1"},"Product Name",-1)),v(e("input",{"onUpdate:modelValue":t[5]||(t[5]=s=>u.value.name=s),type:"text",class:"w-full px-3 py-2 rounded-lg bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 text-sm placeholder-slate-400 dark:placeholder-slate-500 text-slate-900 dark:text-white focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"Product Name"},null,512),[[y,u.value.name]])]),e("div",null,[t[42]||(t[42]=e("label",{class:"block text-xs font-bold text-slate-500 uppercase mb-1"},"SKU (Optional)",-1)),v(e("input",{"onUpdate:modelValue":t[6]||(t[6]=s=>u.value.sku=s),type:"text",class:"w-full px-3 py-2 rounded-lg bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 text-sm placeholder-slate-400 dark:placeholder-slate-500 text-slate-900 dark:text-white focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"Leave empty to auto-generate"},null,512),[[y,u.value.sku]])]),e("div",hs,[e("div",null,[t[44]||(t[44]=e("label",{class:"block text-xs font-bold text-slate-500 uppercase mb-1"},"Unit",-1)),v(e("select",{"onUpdate:modelValue":t[7]||(t[7]=s=>u.value.unit_id=s),class:"w-full px-3 py-2 rounded-lg bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 text-sm placeholder-slate-400 dark:placeholder-slate-500 text-slate-900 dark:text-white focus:ring-2 focus:ring-blue-500 outline-none"},[t[43]||(t[43]=e("option",{value:"",disabled:""},"Select Unit",-1)),(a(!0),r(S,null,j(A.units,s=>(a(),r("option",{key:s.id,value:s.id},n(s.name),9,ks))),128))],512),[[W,u.value.unit_id]])]),e("div",null,[t[46]||(t[46]=e("label",{class:"block text-xs font-bold text-slate-500 uppercase mb-1"},"Type",-1)),v(e("select",{"onUpdate:modelValue":t[8]||(t[8]=s=>u.value.product_type=s),class:"w-full px-3 py-2 rounded-lg bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 text-sm placeholder-slate-400 dark:placeholder-slate-500 text-slate-900 dark:text-white focus:ring-2 focus:ring-blue-500 outline-none"},[...t[45]||(t[45]=[e("option",{value:"finished_good"},"Finished Good",-1),e("option",{value:"raw_material"},"Raw Material",-1),e("option",{value:"spare_part"},"Spare Part",-1)])],512),[[W,u.value.product_type]])])]),e("div",null,[t[47]||(t[47]=e("label",{class:"block text-xs font-bold text-slate-500 uppercase mb-1"},"Selling Price",-1)),v(e("input",{"onUpdate:modelValue":t[9]||(t[9]=s=>u.value.selling_price=s),type:"number",class:"w-full px-3 py-2 rounded-lg bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 text-sm placeholder-slate-400 dark:placeholder-slate-500 text-slate-900 dark:text-white focus:ring-2 focus:ring-blue-500 outline-none"},null,512),[[y,u.value.selling_price,void 0,{number:!0}]])])]),e("div",ys,[e("button",{onClick:D,class:"px-4 py-2 rounded-lg text-slate-600 hover:bg-slate-200 dark:text-slate-300 dark:hover:bg-slate-700 font-bold text-sm transition-colors"}," Cancel "),e("button",{onClick:Y,disabled:O.value,class:"px-4 py-2 rounded-lg bg-blue-600 hover:bg-blue-700 text-white font-bold text-sm transition-colors flex items-center gap-2"},[O.value?(a(),r("span",Ps,"Saving...")):(a(),r("span",Us,"Save Product"))],8,ws)])])])):p("",!0)]),_:1}))}};export{Xs as default};
