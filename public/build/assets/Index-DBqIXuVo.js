import{m as u,C as me,f as be,q as ve,c as i,a as c,u as l,h as ge,w as T,b as t,j as M,v as q,n as x,d as m,t as n,o as r,F as L,g as Z,e as d,x as b,T as ee,p as ke,M as fe,s as he,B as A}from"./app-IVoQJucO.js";import{z as ye,h as O,_ as we}from"./AppLayout-CB6itj69.js";import{_ as _e}from"./Pagination-CDFUMz4_.js";import{a as I}from"./helpers-DnzC1tLX.js";import{C as Ce,a as ze,L as Ae,P as $e,b as Se,B as Ie,p as De,c as je,d as Be,i as Fe,f as U}from"./index-BO1RD2kY.js";import{r as Re}from"./MagnifyingGlassIcon-DsL3jw1f.js";import{d as Te}from"./SunIcon-CYbLoLnh.js";import{r as te}from"./ArrowUpTrayIcon-QTbFRtlD.js";import{r as H}from"./SparklesIcon-CkSh7JIs.js";import{r as Me}from"./ArrowLeftCircleIcon-DfI3ICCK.js";import{r as se}from"./XMarkIcon-D_woVOUk.js";import{r as N}from"./ChevronUpIcon-j3BRxtpQ.js";import{r as Le}from"./UserIcon-B5EIQRfb.js";/* empty css            */import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./WrenchScrewdriverIcon-BFnYhfSI.js";import"./DocumentPlusIcon-DG_g0Qf-.js";import"./TruckIcon-B37qipaX.js";import"./DocumentTextIcon-Bwhp7UlT.js";import"./ShoppingCartIcon-C8LltAfz.js";import"./MapPinIcon-3JoXjwIr.js";import"./CubeIcon-C_ydCMqF.js";import"./ClockIcon-C7llT3BY.js";import"./CheckCircleIcon-BsWlH7Rj.js";import"./ShieldCheckIcon-Dg1cl82W.js";const Oe={class:"p-4 sm:p-6 lg:p-8"},Ne={class:"glass-card rounded-2xl overflow-hidden p-6"},Ee={class:"flex flex-col md:flex-row justify-between items-center mb-6 gap-4"},Pe={class:"flex gap-4 w-full md:w-auto"},Ve={class:"relative w-full md:w-64"},qe={class:"flex items-center gap-3"},Ue={class:"flex items-center bg-slate-200 dark:bg-slate-700 rounded-lg p-0.5"},He=["href"],Ge=["disabled"],Qe={key:0,class:"rounded-2xl p-6 mb-6 border border-slate-200 dark:border-slate-700/50 shadow-lg bg-white/50 dark:bg-slate-800/30"},We={class:"flex items-center gap-2 mb-4 text-sm"},Je={key:0,class:"text-slate-400"},Ke=["onClick"],Xe={key:0,class:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6"},Ye={class:"bg-violet-50 dark:bg-violet-900/30 border border-violet-200 dark:border-violet-800 rounded-xl p-4 text-center"},Ze={class:"text-2xl font-black text-violet-700 dark:text-violet-300 mt-1"},et={class:"bg-emerald-50 dark:bg-emerald-900/30 border border-emerald-200 dark:border-emerald-800 rounded-xl p-4 text-center"},tt={class:"text-2xl font-black text-emerald-700 dark:text-emerald-300 mt-1"},st={class:"relative",style:{height:"380px"}},at={key:0,class:"absolute inset-0 flex items-center justify-center bg-white/60 dark:bg-slate-900/60 z-10 rounded-xl"},lt={key:4,class:"flex items-center justify-center h-full text-slate-400"},rt={key:1,class:"text-center text-[10px] text-slate-400 mt-3 italic"},ot={key:0,class:"rounded-2xl p-6 mb-6 border border-violet-200 dark:border-violet-800/50 shadow-xl bg-gradient-to-br from-violet-50/80 to-purple-50/50 dark:from-violet-950/30 dark:to-purple-950/20 backdrop-blur-sm"},it={class:"flex items-center justify-between mb-4"},nt={class:"flex items-center gap-2"},dt={class:"flex items-center gap-2"},ct={key:0,class:"flex flex-col items-center justify-center py-12 gap-4"},ut={class:"relative"},pt=["innerHTML"],xt={class:"rounded-2xl glass-card overflow-hidden"},mt={class:"overflow-x-auto overflow-y-auto max-h-[600px]"},bt={class:"w-full text-left text-sm text-slate-600 dark:text-slate-400"},vt={class:"bg-slate-50 dark:bg-slate-700/50 text-xs uppercase font-semibold text-slate-500 dark:text-slate-300"},gt={class:"border-b border-slate-200 dark:border-slate-700"},kt={class:"flex items-center gap-1"},ft={key:0,class:"text-blue-600 dark:text-blue-400"},ht={class:"flex items-center gap-1"},yt={key:0,class:"text-blue-600 dark:text-blue-400"},wt={class:"flex items-center gap-1"},_t={key:0,class:"text-blue-600 dark:text-blue-400"},Ct={class:"flex items-center justify-end gap-1"},zt={key:0,class:"text-blue-600 dark:text-blue-400"},At={class:"divide-y divide-slate-100 dark:divide-slate-800"},$t={class:"px-4 py-2 whitespace-nowrap text-sm text-slate-600 dark:text-slate-400 uppercase font-medium"},St={class:"px-4 py-2"},It={class:"text-sm font-semibold text-slate-900 dark:text-white"},Dt={class:"text-[10px] text-slate-500 font-mono tracking-tight"},jt={class:"px-4 py-2"},Bt={class:"text-sm font-medium text-slate-900 dark:text-white"},Ft={class:"text-[10px] text-slate-500 font-mono tracking-tight"},Rt={class:"px-4 py-2 text-right font-mono text-sm text-slate-900 dark:text-white"},Tt={class:"px-4 py-2 text-right font-mono text-sm"},Mt={class:"px-4 py-2 text-center"},Lt={class:"flex flex-col items-center"},Ot={class:"w-12 h-1 bg-slate-100 dark:bg-slate-800 rounded-full overflow-hidden mt-0.5"},Nt={class:"px-4 py-2"},Et=["title"],Pt={key:0,class:"text-[9px] text-slate-500 uppercase flex items-center gap-1"},Vt={class:"px-4 py-2 text-sm text-slate-500 font-mono"},qt=["title"],Ut={key:0},Ht={class:"mt-6"},Gt={key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-slate-950/80 backdrop-blur-sm"},Qt={class:"bg-white dark:bg-slate-800 rounded-2xl w-full max-w-md p-6 shadow-2xl border border-slate-200 dark:border-slate-700"},Wt={class:"flex items-center justify-between mb-6"},Jt={class:"mb-4"},Kt={class:"mb-6"},Xt={class:"flex flex-col items-center justify-center border-2 border-dashed border-slate-200 dark:border-slate-700 rounded-xl p-8 hover:border-blue-500/50 transition-all relative group bg-slate-50/50 dark:bg-slate-900/50"},Yt={class:"flex flex-col items-center transition-transform group-hover:scale-105 duration-300"},Zt={class:"p-3 rounded-full bg-blue-50 dark:bg-blue-900/30 mb-3"},es={class:"text-sm text-slate-600 dark:text-slate-300 font-semibold mb-1"},ts={class:"mt-4 z-30 relative py-1 px-3 rounded-lg bg-blue-50 dark:bg-blue-900/40 border border-blue-100 dark:border-blue-800/50"},ss=["href"],as={key:0,class:"text-red-500 text-xs mt-2 font-medium"},ls={class:"flex items-center gap-3"},rs=["disabled"],Bs={__name:"Index",props:{forecasts:Object,filters:Object},setup(D){Ce.register(ze,Ae,$e,Se,Ie,De,je,Be,Fe);const j=D,f=u(j.filters.search||""),h=u(j.filters.month||""),y=u(j.filters.sort||"period"),k=u(j.filters.direction||"desc"),E=u(!1),_=u("chart"),v=u("summary"),o=u(null),B=u(!1),g=u([{label:"All Customers",level:"summary"}]),$=u(null),C=u(null),S=async()=>{B.value=!0;try{const s=new URLSearchParams({search:f.value||"",level:v.value,month:h.value||""});$.value&&s.set("customer_id",$.value),C.value&&s.set("product_id",C.value);const e=await fetch(route("sales.planning.forecast.chart-data")+"?"+s.toString());o.value=await e.json()}catch(s){console.error("Chart fetch error:",s)}finally{B.value=!1}},G=s=>{v.value==="summary"?(v.value="customer",$.value=s.id,g.value.push({label:s.name,level:"customer",id:s.id}),S()):v.value==="customer"&&(v.value="item",C.value=s.id,g.value.push({label:s.name,level:"item",id:s.id}),S())},Q=s=>{const e=g.value[s];g.value=g.value.slice(0,s+1),v.value=e.level,e.level==="summary"?($.value=null,C.value=null):e.level==="customer"&&(C.value=null),S()};me(()=>{S()});const W=A(()=>{if(!o.value||o.value.level!=="summary")return null;const s=o.value.data;return{labels:s.map(e=>e.name),datasets:[{label:"Forecast",data:s.map(e=>e.forecast),backgroundColor:"rgba(139,92,246,0.7)",borderRadius:4,barThickness:22},{label:"Actual (Order)",data:s.map(e=>e.actual),backgroundColor:"rgba(16,185,129,0.8)",borderRadius:4,barThickness:22}]}}),J=A(()=>{if(!o.value||o.value.level!=="customer")return null;const s=o.value.data;return{labels:s.map(e=>e.name),datasets:[{label:"Forecast",data:s.map(e=>e.forecast),backgroundColor:"rgba(139,92,246,0.7)",borderRadius:4},{label:"Actual (Order)",data:s.map(e=>e.actual),backgroundColor:"rgba(16,185,129,0.8)",borderRadius:4}]}}),K=A(()=>{if(!o.value||o.value.level!=="item")return null;const s=o.value.data;return{labels:s.map(e=>e.label),datasets:[{type:"bar",label:"Forecast",data:s.map(e=>e.forecast),backgroundColor:"rgba(139,92,246,0.4)",borderRadius:3,order:2},{type:"bar",label:"Actual",data:s.map(e=>e.actual),backgroundColor:"rgba(16,185,129,0.7)",borderRadius:3,order:2},{type:"line",label:"Cum. Forecast",data:s.map(e=>e.cum_forecast),borderColor:"#8b5cf6",borderDash:[6,3],borderWidth:2,pointRadius:3,pointBackgroundColor:"#8b5cf6",fill:!1,tension:.3,order:1},{type:"line",label:"Cum. Actual",data:s.map(e=>e.cum_actual),borderColor:"#10b981",borderWidth:2.5,pointRadius:4,pointBackgroundColor:"#10b981",fill:!1,tension:.3,order:1}]}}),ae=A(()=>({responsive:!0,maintainAspectRatio:!1,indexAxis:"y",onClick:(s,e)=>{e.length&&o.value&&G(o.value.data[e[0].index])},plugins:{legend:{position:"top",labels:{color:"#64748b",font:{size:11,weight:"bold"}}},tooltip:{padding:10}},scales:{x:{grid:{color:"rgba(0,0,0,0.06)"},ticks:{color:"#64748b",font:{size:10}}},y:{grid:{display:!1},ticks:{color:"#334155",font:{size:11,weight:"600"}}}}})),le=A(()=>({responsive:!0,maintainAspectRatio:!1,onClick:(s,e)=>{e.length&&o.value&&G(o.value.data[e[0].index])},plugins:{legend:{position:"top",labels:{color:"#64748b",font:{size:11,weight:"bold"}}},tooltip:{padding:10}},scales:{x:{grid:{display:!1},ticks:{color:"#334155",font:{size:10,weight:"600"},maxRotation:45}},y:{grid:{color:"rgba(0,0,0,0.06)"},ticks:{color:"#64748b",font:{size:10}}}}})),re=A(()=>({responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top",labels:{color:"#64748b",font:{size:11,weight:"bold"}}},tooltip:{padding:10}},scales:{x:{grid:{display:!1},ticks:{color:"#334155",font:{size:10},maxRotation:45}},y:{grid:{color:"rgba(0,0,0,0.06)"},ticks:{color:"#64748b",font:{size:10}}}}})),w=u(!1),z=u(""),P=u(!1),X=async()=>{w.value=!0,P.value=!0,z.value="";try{const s=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content"),a=await(await fetch(route("sales.planning.forecast.analyze"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":s,Accept:"application/json"},body:JSON.stringify({search:f.value,month:h.value})})).json();a.error?z.value=`### ⚠️ Error
${a.error}`:z.value=a.analysis||"Tidak ada hasil analisis dari AI."}catch(s){z.value=`### ⚠️ Connection Error
Gagal menghubungi server. Pastikan koneksi internet stabil.`,console.error(s)}finally{w.value=!1}},oe=s=>s?s.replace(/### (.+)/g,'<h3 class="text-base font-bold text-slate-800 dark:text-slate-200 mt-5 mb-2">$1</h3>').replace(/## (.+)/g,'<h2 class="text-lg font-bold text-slate-900 dark:text-white mt-6 mb-3">$1</h2>').replace(/\*\*(.+?)\*\*/g,'<strong class="font-semibold">$1</strong>').replace(/\*(.+?)\*/g,"<em>$1</em>").replace(/^- (.+)/gm,'<li class="ml-4 text-sm text-slate-600 dark:text-slate-400">$1</li>').replace(/(<li.*<\/li>\n?)+/g,'<ul class="list-disc space-y-1 my-2">$&</ul>').replace(/\n{2,}/g,"<br/><br/>").replace(/\n/g,"<br/>"):"",ie=u(null),p=be({file:null,sales_name:""}),F=s=>{y.value===s?k.value=k.value==="asc"?"desc":"asc":(y.value=s,k.value="asc"),Y()},Y=()=>{he.get(route("sales.planning.forecast.index"),{search:f.value,month:h.value,sort:y.value,direction:k.value},{preserveState:!0,replace:!0})};ve([f,h],()=>{Y(),S()});const ne=()=>{E.value=!0},V=()=>{E.value=!1,p.reset()},de=()=>{p.file&&p.post(route("sales.planning.forecast.import"),{onSuccess:()=>V()})},ce=s=>s>=90?"#10b981":s>=75?"#3b82f6":s>=50?"#f59e0b":"#ef4444",ue=s=>s>=90?"text-emerald-600 dark:text-emerald-400":s>=75?"text-blue-600 dark:text-blue-400":s>=50?"text-amber-600 dark:text-amber-400":"text-red-600 dark:text-red-400",pe=s=>s?new Date(s).toLocaleDateString("id-ID",{year:"numeric",month:"long"}):"",xe=s=>s?new Date(s).toLocaleDateString("id-ID",{day:"2-digit",month:"short"}):"";return(s,e)=>(r(),i(L,null,[c(l(ge),{title:"Sales Forecast"}),c(we,{title:"Sales Forecast"},{header:T(()=>[...e[12]||(e[12]=[t("h2",{class:"font-semibold text-xl text-slate-800 dark:text-slate-200 leading-tight"}," Sales Forecast ",-1)])]),default:T(()=>[t("div",Oe,[t("div",Ne,[t("div",Ee,[t("div",Pe,[t("div",Ve,[M(t("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>f.value=a),type:"text",placeholder:"Search Customer / Product...",class:"w-full pl-10 pr-4 py-2 rounded-lg border border-slate-300 dark:border-slate-600 dark:bg-slate-700 dark:text-white focus:ring-blue-500 focus:border-blue-500"},null,512),[[q,f.value]]),c(l(Re),{class:"w-5 h-5 text-slate-400 absolute left-3 top-2.5"})]),M(t("input",{"onUpdate:modelValue":e[1]||(e[1]=a=>h.value=a),type:"month",class:"rounded-lg border border-slate-300 dark:border-slate-600 dark:bg-slate-700 dark:text-white focus:ring-blue-500 focus:border-blue-500"},null,512),[[q,h.value]])]),t("div",qe,[t("div",Ue,[t("button",{onClick:e[2]||(e[2]=a=>_.value="chart"),class:x([_.value==="chart"?"bg-white dark:bg-slate-900 text-slate-900 dark:text-white shadow-sm":"text-slate-500 dark:text-slate-400 hover:text-slate-700","px-3 py-1.5 rounded-md text-xs font-bold uppercase tracking-wider transition-all flex items-center gap-1"])},[c(l(Te),{class:"w-3.5 h-3.5"}),e[13]||(e[13]=m(" Chart ",-1))],2),t("button",{onClick:e[3]||(e[3]=a=>_.value="table"),class:x([_.value==="table"?"bg-white dark:bg-slate-900 text-slate-900 dark:text-white shadow-sm":"text-slate-500 dark:text-slate-400 hover:text-slate-700","px-3 py-1.5 rounded-md text-xs font-bold uppercase tracking-wider transition-all flex items-center gap-1"])},[c(l(ye),{class:"w-3.5 h-3.5"}),e[14]||(e[14]=m(" Table ",-1))],2)]),t("a",{href:s.route("sales.planning.forecast.export",{search:f.value,month:h.value}),class:"flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors text-sm"},[...e[15]||(e[15]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[t("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),t("polyline",{points:"7 10 12 15 17 10"}),t("line",{x1:"12",y1:"15",x2:"12",y2:"3"})],-1),m(" Export ",-1)])],8,He),t("button",{onClick:ne,class:"flex items-center gap-2 bg-emerald-600 hover:bg-emerald-700 text-white px-4 py-2 rounded-lg transition-colors text-sm"},[c(l(te),{class:"w-4 h-4"}),e[16]||(e[16]=m(" Import ",-1))]),t("button",{onClick:X,disabled:w.value,class:"flex items-center gap-2 bg-gradient-to-r from-violet-600 to-purple-600 hover:from-violet-700 hover:to-purple-700 text-white px-4 py-2 rounded-lg transition-all text-sm shadow-md hover:shadow-lg disabled:opacity-50"},[c(l(H),{class:x(["w-4 h-4",{"animate-spin":w.value}])},null,8,["class"]),m(" "+n(w.value?"Analyzing...":"AI Analysis"),1)],8,Ge)])]),_.value==="chart"?(r(),i("div",Qe,[t("div",We,[(r(!0),i(L,null,Z(g.value,(a,R)=>(r(),i(L,{key:R},[R>0?(r(),i("span",Je,"/")):d("",!0),t("button",{onClick:os=>Q(R),class:x([R===g.value.length-1?"text-violet-600 dark:text-violet-400 font-bold":"text-slate-500 hover:text-violet-600 dark:hover:text-slate-300","transition-colors"])},n(a.label),11,Ke)],64))),128)),g.value.length>1?(r(),i("button",{key:0,onClick:e[4]||(e[4]=a=>Q(g.value.length-2)),class:"ml-2 p-1 rounded-full hover:bg-slate-200 dark:hover:bg-slate-700 transition-colors"},[c(l(Me),{class:"w-5 h-5 text-slate-400"})])):d("",!0)]),o.value&&o.value.kpi?(r(),i("div",Xe,[t("div",Ye,[e[17]||(e[17]=t("p",{class:"text-[10px] text-violet-500 dark:text-violet-400 font-bold uppercase tracking-wider"},"Total Forecast",-1)),t("p",Ze,n(l(I)(o.value.kpi.total_forecast)),1)]),t("div",et,[e[18]||(e[18]=t("p",{class:"text-[10px] text-emerald-500 dark:text-emerald-400 font-bold uppercase tracking-wider"},"Total Actual (Order)",-1)),t("p",tt,n(l(I)(o.value.kpi.total_actual)),1)]),t("div",{class:x(["border rounded-xl p-4 text-center",o.value.kpi.achievement>=90?"bg-green-50 dark:bg-green-900/30 border-green-200 dark:border-green-800":o.value.kpi.achievement>=70?"bg-amber-50 dark:bg-amber-900/30 border-amber-200 dark:border-amber-800":"bg-red-50 dark:bg-red-900/30 border-red-200 dark:border-red-800"])},[t("p",{class:x(["text-[10px] font-bold uppercase tracking-wider",o.value.kpi.achievement>=90?"text-green-500":o.value.kpi.achievement>=70?"text-amber-500":"text-red-500"])},"Achievement",2),t("p",{class:x(["text-2xl font-black mt-1",o.value.kpi.achievement>=90?"text-green-700 dark:text-green-300":o.value.kpi.achievement>=70?"text-amber-700 dark:text-amber-300":"text-red-700 dark:text-red-300"])},n(o.value.kpi.achievement)+"%",3)],2),t("div",{class:x(["border rounded-xl p-4 text-center",o.value.kpi.gap<0?"bg-red-50 dark:bg-red-900/30 border-red-200 dark:border-red-800":"bg-slate-50 dark:bg-slate-800/50 border-slate-200 dark:border-slate-700"])},[t("p",{class:x(["text-[10px] font-bold uppercase tracking-wider",o.value.kpi.gap<0?"text-red-500":"text-slate-500"])},"Gap",2),t("p",{class:x(["text-2xl font-black mt-1",o.value.kpi.gap<0?"text-red-700 dark:text-red-300":"text-slate-700 dark:text-slate-300"])},n(l(I)(o.value.kpi.gap)),3)],2)])):d("",!0),t("div",st,[B.value?(r(),i("div",at,[...e[19]||(e[19]=[t("div",{class:"flex items-center gap-3 text-slate-500"},[t("svg",{class:"animate-spin h-6 w-6",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4",fill:"none"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]),t("span",{class:"text-sm font-medium"},"Loading chart data...")],-1)])])):d("",!0),v.value==="summary"&&W.value?(r(),b(l(U),{key:"fc-summary",data:W.value,options:ae.value},null,8,["data","options"])):v.value==="customer"&&J.value?(r(),b(l(U),{key:"fc-customer-"+$.value,data:J.value,options:le.value},null,8,["data","options"])):v.value==="item"&&K.value?(r(),b(l(U),{key:"fc-item-"+C.value,data:K.value,options:re.value},null,8,["data","options"])):B.value?d("",!0):(r(),i("div",lt,[...e[20]||(e[20]=[t("p",{class:"text-sm"},"No forecast data available.",-1)])]))]),v.value!=="item"?(r(),i("p",rt,"Click a bar to drill down into details")):d("",!0)])):d("",!0),c(ee,{"enter-active-class":"transition-all duration-300 ease-out","enter-from-class":"opacity-0 -translate-y-4 scale-95","enter-to-class":"opacity-100 translate-y-0 scale-100","leave-active-class":"transition-all duration-200 ease-in","leave-from-class":"opacity-100 translate-y-0 scale-100","leave-to-class":"opacity-0 -translate-y-2 scale-95"},{default:T(()=>[P.value?(r(),i("div",ot,[t("div",it,[t("div",nt,[c(l(H),{class:"w-5 h-5 text-violet-600 dark:text-violet-400"}),e[21]||(e[21]=t("h3",{class:"text-sm font-bold text-violet-800 dark:text-violet-300 uppercase tracking-wider"},"AI Forecast Analysis",-1))]),t("div",dt,[w.value?d("",!0):(r(),i("button",{key:0,onClick:X,class:"text-xs text-violet-600 dark:text-violet-400 hover:text-violet-800 font-medium flex items-center gap-1 transition-colors"},[...e[22]||(e[22]=[t("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1),m(" Re-analyze ",-1)])])),t("button",{onClick:e[5]||(e[5]=a=>P.value=!1),class:"p-1 rounded-full hover:bg-violet-200 dark:hover:bg-violet-800 transition-colors"},[c(l(se),{class:"w-4 h-4 text-violet-500"})])])]),w.value?(r(),i("div",ct,[t("div",ut,[e[23]||(e[23]=t("div",{class:"w-12 h-12 rounded-full border-4 border-violet-200 dark:border-violet-800 border-t-violet-600 dark:border-t-violet-400 animate-spin"},null,-1)),c(l(H),{class:"w-5 h-5 text-violet-600 absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2"})]),e[24]||(e[24]=t("div",{class:"text-center"},[t("p",{class:"text-sm font-medium text-violet-700 dark:text-violet-300"},"AI sedang menganalisis data forecast..."),t("p",{class:"text-xs text-violet-500 dark:text-violet-400 mt-1"},"Ini mungkin memerlukan beberapa detik")],-1))])):z.value?(r(),i("div",{key:1,class:"prose prose-sm dark:prose-invert max-w-none text-slate-700 dark:text-slate-300 leading-relaxed",innerHTML:oe(z.value)},null,8,pt)):d("",!0)])):d("",!0)]),_:1}),M(t("div",xt,[t("div",mt,[t("table",bt,[t("thead",vt,[t("tr",gt,[t("th",{onClick:e[6]||(e[6]=a=>F("period")),class:"sticky top-0 z-20 bg-slate-100 dark:bg-slate-950 px-4 py-3 cursor-pointer hover:bg-slate-200 dark:hover:bg-slate-900 transition-colors group text-left text-xs font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wider shadow-sm"},[t("div",kt,[e[25]||(e[25]=m(" Period ",-1)),y.value==="period"?(r(),i("span",ft,[k.value==="asc"?(r(),b(l(N),{key:0,class:"h-3 w-3"})):(r(),b(l(O),{key:1,class:"h-3 w-3"}))])):d("",!0)])]),t("th",{onClick:e[7]||(e[7]=a=>F("customer_name")),class:"sticky top-0 z-20 bg-slate-100 dark:bg-slate-950 px-4 py-3 cursor-pointer hover:bg-slate-200 dark:hover:bg-slate-900 transition-colors group text-left text-xs font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wider shadow-sm"},[t("div",ht,[e[26]||(e[26]=m(" Customer ",-1)),y.value==="customer_name"?(r(),i("span",yt,[k.value==="asc"?(r(),b(l(N),{key:0,class:"h-3 w-3"})):(r(),b(l(O),{key:1,class:"h-3 w-3"}))])):d("",!0)])]),t("th",{onClick:e[8]||(e[8]=a=>F("product_name")),class:"sticky top-0 z-20 bg-slate-100 dark:bg-slate-950 px-4 py-3 cursor-pointer hover:bg-slate-200 dark:hover:bg-slate-900 transition-colors group text-left text-xs font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wider shadow-sm"},[t("div",wt,[e[27]||(e[27]=m(" Product ",-1)),y.value==="product_name"?(r(),i("span",_t,[k.value==="asc"?(r(),b(l(N),{key:0,class:"h-3 w-3"})):(r(),b(l(O),{key:1,class:"h-3 w-3"}))])):d("",!0)])]),t("th",{onClick:e[9]||(e[9]=a=>F("qty_forecast")),class:"sticky top-0 z-20 bg-slate-100 dark:bg-slate-950 px-4 py-3 text-right cursor-pointer hover:bg-slate-200 dark:hover:bg-slate-900 transition-colors group text-xs font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wider shadow-sm"},[t("div",Ct,[e[28]||(e[28]=m(" Qty Forecast ",-1)),y.value==="qty_forecast"?(r(),i("span",zt,[k.value==="asc"?(r(),b(l(N),{key:0,class:"h-3 w-3"})):(r(),b(l(O),{key:1,class:"h-3 w-3"}))])):d("",!0)])]),e[29]||(e[29]=t("th",{class:"sticky top-0 z-20 bg-slate-100 dark:bg-slate-950 px-4 py-3 text-right text-xs font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wider shadow-sm"},"Qty PO (Actual)",-1)),e[30]||(e[30]=t("th",{class:"sticky top-0 z-20 bg-slate-100 dark:bg-slate-950 px-4 py-3 text-center text-xs font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wider shadow-sm"},"Accuracy",-1)),e[31]||(e[31]=t("th",{class:"sticky top-0 z-20 bg-slate-100 dark:bg-slate-950 px-4 py-3 text-left text-xs font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wider shadow-sm"},"Sales Name",-1)),e[32]||(e[32]=t("th",{class:"sticky top-0 z-20 bg-slate-100 dark:bg-slate-950 px-4 py-3 text-left text-xs font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wider shadow-sm"},"Unit",-1)),e[33]||(e[33]=t("th",{class:"sticky top-0 z-20 bg-slate-100 dark:bg-slate-950 px-4 py-3 text-left text-xs font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wider shadow-sm"},"Notes",-1))])]),t("tbody",At,[(r(!0),i(L,null,Z(D.forecasts.data,a=>(r(),i("tr",{key:a.id,class:"hover:bg-slate-50 dark:hover:bg-slate-800/50 dark:bg-slate-800/30 transition-colors"},[t("td",$t,n(pe(a.period)),1),t("td",St,[t("div",It,n(a.customer?.name),1),t("div",Dt,n(a.customer?.code),1)]),t("td",jt,[t("div",Bt,n(a.product?.name),1),t("div",Ft,n(a.product?.sku),1)]),t("td",Rt,n(l(I)(a.qty_forecast)),1),t("td",Tt,[t("span",{class:x({"text-blue-500 font-bold":a.qty_actual>0,"text-slate-400":a.qty_actual===0})},n(l(I)(a.qty_actual)),3)]),t("td",Mt,[t("div",Lt,[t("span",{class:x([ue(a.accuracy),"font-bold text-[10px] tracking-tighter"])},n(a.accuracy)+"% ",3),t("div",Ot,[t("div",{class:"h-full transition-all duration-500",style:ke({width:a.accuracy+"%",backgroundColor:ce(a.accuracy)})},null,4)])])]),t("td",Nt,[t("div",{class:"text-sm font-medium text-slate-900 dark:text-white truncate max-w-[120px]",title:a.sales_name},n(a.sales_name||"-"),9,Et),a.created_by?(r(),i("div",Pt,[c(l(Le),{class:"w-2.5 h-2.5"}),m(" "+n(a.created_by_user?.name||"User")+" • "+n(xe(a.created_at)),1)])):d("",!0)]),t("td",Vt,n(a.product?.unit?.code),1),t("td",{class:"px-4 py-2 text-[11px] italic text-slate-500 dark:text-slate-400 line-clamp-1 truncate max-w-[150px]",title:a.notes},n(a.notes||"-"),9,qt)]))),128)),D.forecasts.data.length===0?(r(),i("tr",Ut,[...e[34]||(e[34]=[t("td",{colspan:"9",class:"px-4 py-12 text-center text-slate-500 whitespace-nowrap"}," No forecast data found. Import Excel to get started. ",-1)])])):d("",!0)])])])],512),[[fe,_.value==="table"]]),t("div",Ht,[c(_e,{links:D.forecasts.links},null,8,["links"])])])]),c(ee,{"enter-active-class":"transition duration-200 ease-out","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"transition duration-150 ease-in","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:T(()=>[E.value?(r(),i("div",Gt,[t("div",Qt,[t("div",Wt,[e[35]||(e[35]=t("h3",{class:"text-xl font-bold text-slate-900 dark:text-white"}," Import Forecast Data ",-1)),t("button",{onClick:V,class:"text-slate-500 hover:text-slate-900 dark:text-white transition-colors"},[c(l(se),{class:"h-6 w-6"})])]),t("div",Jt,[e[36]||(e[36]=t("label",{class:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1"},"Sales Name",-1)),M(t("input",{"onUpdate:modelValue":e[10]||(e[10]=a=>l(p).sales_name=a),type:"text",placeholder:"Enter salesperson name",class:"w-full rounded-lg border border-slate-300 dark:border-slate-600 dark:bg-slate-700 dark:text-white focus:ring-blue-500 focus:border-blue-500"},null,512),[[q,l(p).sales_name]])]),t("div",Kt,[e[39]||(e[39]=t("label",{class:"block text-sm font-medium text-slate-500 dark:text-slate-400 mb-3"},"Excel/CSV File",-1)),t("div",Xt,[t("input",{type:"file",ref_key:"fileInput",ref:ie,onChange:e[11]||(e[11]=a=>l(p).file=a.target.files[0]),class:"absolute inset-0 opacity-0 cursor-pointer z-20",accept:".xlsx,.xls,.csv"},null,544),t("div",Yt,[t("div",Zt,[c(l(te),{class:"h-8 w-8 text-blue-600 dark:text-blue-400"})]),t("p",es,n(l(p).file?l(p).file.name:"Click or drag file to upload"),1),e[37]||(e[37]=t("p",{class:"text-xs text-slate-500"},"Maximum size: 2MB",-1))]),t("div",ts,[t("a",{href:s.route("sales.planning.forecast.template"),class:"flex items-center gap-1.5 text-xs font-bold text-blue-600 dark:text-blue-400 hover:underline"},[...e[38]||(e[38]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-3.5 w-3.5",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1),m(" Download Template ",-1)])],8,ss)])]),l(p).errors.file?(r(),i("div",as,n(l(p).errors.file),1)):d("",!0)]),t("div",ls,[t("button",{onClick:de,disabled:!l(p).file||l(p).processing,class:"flex-1 rounded-xl bg-blue-600 py-3 text-sm font-bold text-white hover:bg-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-all shadow-lg shadow-blue-500/20"},n(l(p).processing?"Importing...":"Start Import"),9,rs),t("button",{onClick:V,class:"flex-1 rounded-xl bg-slate-100 dark:bg-slate-700 py-3 text-sm font-bold text-slate-600 dark:text-slate-200 hover:bg-slate-200 dark:hover:bg-slate-600 transition-all font-mono uppercase tracking-wider"}," Cancel ")])])])):d("",!0)]),_:1})]),_:1})],64))}};export{Bs as default};
