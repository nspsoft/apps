import{f as P,c as u,a as n,u as o,h as A,w as f,b as e,l as y,d as k,i as F,j as i,v as p,o as c,F as x,g as h,t as b,k as w,B as _}from"./app-IVoQJucO.js";import{_ as $}from"./AppLayout-CB6itj69.js";import{_ as D}from"./SearchableSelect-CIDcHpK6.js";import{f as N}from"./helpers-DnzC1tLX.js";import{r as j}from"./ArrowLeftIcon-B_kbiwSh.js";import{r as I}from"./PlusIcon-BRjHjXno.js";import{r as M}from"./TrashIcon-C7R2rb67.js";/* empty css            */import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./XMarkIcon-D_woVOUk.js";import"./SunIcon-CYbLoLnh.js";import"./WrenchScrewdriverIcon-BFnYhfSI.js";import"./DocumentPlusIcon-DG_g0Qf-.js";import"./TruckIcon-B37qipaX.js";import"./DocumentTextIcon-Bwhp7UlT.js";import"./ShoppingCartIcon-C8LltAfz.js";import"./MapPinIcon-3JoXjwIr.js";import"./SparklesIcon-CkSh7JIs.js";import"./CubeIcon-C_ydCMqF.js";import"./ClockIcon-C7llT3BY.js";import"./CheckCircleIcon-BsWlH7Rj.js";import"./ShieldCheckIcon-Dg1cl82W.js";import"./transition-BmjqPrOh.js";const B={class:"max-w-full px-4 sm:px-6 lg:px-8 mx-auto"},E={class:"grid grid-cols-1 xl:grid-cols-12 gap-6"},T={class:"xl:col-span-4 glass-card rounded-2xl p-6 space-y-4"},L=["value"],Q=["value"],W={class:"xl:col-span-8 glass-card rounded-2xl p-6"},z={class:"flex items-center justify-between mb-4"},G={class:"space-y-3 max-h-[600px] overflow-y-auto custom-scrollbar pr-2 relative"},H={class:"col-span-12 sm:col-span-4"},J={class:"col-span-4 sm:col-span-2"},K=["onUpdate:modelValue"],R={class:"col-span-4 sm:col-span-3"},X=["onUpdate:modelValue","onChange"],Y={class:"col-span-4 sm:col-span-2"},Z=["onUpdate:modelValue"],tt={class:"col-span-4 sm:col-span-1 flex justify-end"},et=["onClick"],st={class:"mt-6 pt-6 border-t border-slate-200 dark:border-slate-800"},lt={class:"flex justify-between items-center"},rt={class:"text-xl font-bold text-slate-900 dark:text-white"},ot={class:"glass-card rounded-2xl p-6"},at={class:"flex justify-end gap-3"},dt=["disabled"],At={__name:"Form",props:{purchaseOrder:Object,poNumber:String,suppliers:Array,warehouses:Array,products:Array,units:Array},setup(g){const a=g,O=_(()=>!a.products||!Array.isArray(a.products)?[]:a.products.map(r=>({id:r.id,label:`[${r.code||r.sku||"-"}] ${r.name}`,...r}))),v=_(()=>!!a.purchaseOrder?.id),l=P({po_number:a.poNumber||a.purchaseOrder?.po_number,supplier_id:a.purchaseOrder?.supplier_id||"",warehouse_id:a.purchaseOrder?.warehouse_id||"",order_date:a.purchaseOrder?.order_date||new Date().toISOString().split("T")[0],expected_date:a.purchaseOrder?.expected_date||"",notes:a.purchaseOrder?.notes||"",items:a.purchaseOrder?.items?.map(r=>({id:r.id,product_id:r.product_id,qty:parseFloat(r.qty),unit_price:Math.round(parseFloat(r.unit_price||0)),discount_percent:parseFloat(r.discount_percent||0),unit_id:r.unit_id,description:r.description||""}))||[{product_id:"",qty:1,unit_price:0,discount_percent:0,unit_id:null,description:""}]}),V=()=>{l.items.push({product_id:"",qty:1,unit_price:0,discount_percent:0,unit_id:null,description:""})},U=r=>{l.items.splice(r,1)},S=(r,t)=>{t&&(l.items[r].product_id=t.id,l.items[r].unit_price=Math.round(parseFloat(t.cost_price||0)),l.items[r].unit_id=t.unit_id,l.items[r].description||(l.items[r].description=t.description||t.name||""))},q=_(()=>l.items.reduce((r,t)=>{const s=(t.qty||0)*(t.unit_price||0),m=s*((t.discount_percent||0)/100);return r+(s-m)},0)),C=()=>{v.value?l.put(route("purchasing.orders.update",a.purchaseOrder.id)):l.post(route("purchasing.orders.store"))};return(r,t)=>(c(),u(x,null,[n(o(A),{title:v.value?"Edit Purchase Order":"Create Purchase Order"},null,8,["title"]),n($,{title:"Purchase Orders"},{default:f(()=>[e("div",B,[n(o(y),{href:"/purchasing/orders",class:"inline-flex items-center gap-2 mb-4 text-sm text-slate-500 dark:text-slate-400 hover:text-slate-900 dark:text-white"},{default:f(()=>[n(o(j),{class:"h-4 w-4"}),t[6]||(t[6]=k(" Back to List ",-1))]),_:1}),e("form",{onSubmit:F(C,["prevent"]),class:"space-y-6"},[e("div",E,[e("div",T,[t[14]||(t[14]=e("h3",{class:"text-lg font-semibold text-slate-900 dark:text-white mb-4"},"Order Info",-1)),e("div",null,[t[7]||(t[7]=e("label",{class:"block text-sm font-medium text-slate-500 dark:text-slate-400 mb-1"},"PO Number",-1)),i(e("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=s=>o(l).po_number=s),class:"w-full rounded-xl border-0 bg-slate-50 dark:bg-slate-900 dark:bg-slate-800/50 py-2.5 text-slate-500 dark:text-slate-400 cursor-not-allowed",disabled:""},null,512),[[p,o(l).po_number]])]),e("div",null,[t[9]||(t[9]=e("label",{class:"block text-sm font-medium text-slate-500 dark:text-slate-400 mb-1"},"Supplier",-1)),i(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>o(l).supplier_id=s),class:"w-full rounded-xl border-0 bg-slate-50 dark:bg-slate-800 py-2.5 text-slate-900 dark:text-white focus:ring-2 focus:ring-blue-500/50",required:""},[t[8]||(t[8]=e("option",{value:""},"Select Supplier",-1)),(c(!0),u(x,null,h(g.suppliers,s=>(c(),u("option",{key:s.id,value:s.id},b(s.name),9,L))),128))],512),[[w,o(l).supplier_id]])]),e("div",null,[t[11]||(t[11]=e("label",{class:"block text-sm font-medium text-slate-500 dark:text-slate-400 mb-1"},"Warehouse",-1)),i(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>o(l).warehouse_id=s),class:"w-full rounded-xl border-0 bg-slate-50 dark:bg-slate-800 py-2.5 text-slate-900 dark:text-white focus:ring-2 focus:ring-blue-500/50",required:""},[t[10]||(t[10]=e("option",{value:""},"Select Warehouse",-1)),(c(!0),u(x,null,h(g.warehouses,s=>(c(),u("option",{key:s.id,value:s.id},b(s.name),9,Q))),128))],512),[[w,o(l).warehouse_id]])]),e("div",null,[t[12]||(t[12]=e("label",{class:"block text-sm font-medium text-slate-500 dark:text-slate-400 mb-1"},"Order Date",-1)),i(e("input",{type:"date","onUpdate:modelValue":t[3]||(t[3]=s=>o(l).order_date=s),class:"w-full rounded-xl border-0 bg-slate-50 dark:bg-slate-800 py-2.5 text-slate-900 dark:text-white focus:ring-2 focus:ring-blue-500/50",required:""},null,512),[[p,o(l).order_date]])]),e("div",null,[t[13]||(t[13]=e("label",{class:"block text-sm font-medium text-slate-500 dark:text-slate-400 mb-1"},"Expected Date",-1)),i(e("input",{type:"date","onUpdate:modelValue":t[4]||(t[4]=s=>o(l).expected_date=s),class:"w-full rounded-xl border-0 bg-slate-50 dark:bg-slate-800 py-2.5 text-slate-900 dark:text-white focus:ring-2 focus:ring-blue-500/50"},null,512),[[p,o(l).expected_date]])])]),e("div",W,[e("div",z,[t[16]||(t[16]=e("h3",{class:"text-lg font-semibold text-slate-900 dark:text-white"},"Items",-1)),e("button",{type:"button",onClick:V,class:"text-sm font-medium text-blue-400 hover:text-blue-300 flex items-center gap-1"},[n(o(I),{class:"h-4 w-4"}),t[15]||(t[15]=k(" Add Item ",-1))])]),e("div",G,[t[21]||(t[21]=e("div",{class:"grid grid-cols-12 gap-3 px-3 py-2 mb-2 hidden sm:grid sticky top-0 z-10 bg-white dark:bg-slate-900 border-b border-slate-100 dark:border-slate-800"},[e("div",{class:"col-span-12 sm:col-span-4"},[e("span",{class:"text-[10px] font-bold text-slate-500 uppercase"},"Product")]),e("div",{class:"col-span-4 sm:col-span-2 text-right pr-2"},[e("span",{class:"text-[10px] font-bold text-slate-500 uppercase"},"Qty")]),e("div",{class:"col-span-4 sm:col-span-3 text-right pr-2"},[e("span",{class:"text-[10px] font-bold text-slate-500 uppercase"},"Price")]),e("div",{class:"col-span-4 sm:col-span-2 text-right pr-2"},[e("span",{class:"text-[10px] font-bold text-slate-500 uppercase"},"Disc %")]),e("div",{class:"col-span-4 sm:col-span-1"})],-1)),(c(!0),u(x,null,h(o(l).items,(s,m)=>(c(),u("div",{key:m,class:"grid grid-cols-12 gap-3 items-end bg-slate-50 dark:bg-slate-800/30 p-3 rounded-xl hover:bg-slate-50 dark:hover:bg-slate-800/50 dark:bg-slate-900 dark:bg-slate-800/50 transition-colors"},[e("div",H,[t[17]||(t[17]=e("label",{class:"block text-[10px] font-bold text-slate-500 uppercase mb-1 sm:hidden"},"Product",-1)),n(D,{modelValue:s.product_id,"onUpdate:modelValue":d=>s.product_id=d,options:O.value,onChange:d=>S(m,d),placeholder:"Search Product..."},null,8,["modelValue","onUpdate:modelValue","options","onChange"])]),e("div",J,[t[18]||(t[18]=e("label",{class:"block text-[10px] font-bold text-slate-500 uppercase mb-1 sm:hidden"},"Qty",-1)),i(e("input",{type:"number","onUpdate:modelValue":d=>s.qty=d,min:"0.0001",step:"any",class:"w-full rounded-lg border-0 bg-slate-50 dark:bg-slate-800 py-2.5 text-xs text-slate-900 dark:text-white focus:ring-1 focus:ring-blue-500 text-right",required:""},null,8,K),[[p,s.qty]])]),e("div",R,[t[19]||(t[19]=e("label",{class:"block text-[10px] font-bold text-slate-500 uppercase mb-1 sm:hidden"},"Price",-1)),i(e("input",{type:"number","onUpdate:modelValue":d=>s.unit_price=d,onChange:d=>s.unit_price=Math.round(s.unit_price),step:"any",class:"w-full rounded-lg border-0 bg-slate-50 dark:bg-slate-800 py-2.5 text-xs text-slate-900 dark:text-white focus:ring-1 focus:ring-blue-500 text-right",required:""},null,40,X),[[p,s.unit_price]])]),e("div",Y,[t[20]||(t[20]=e("label",{class:"block text-[10px] font-bold text-slate-500 uppercase mb-1 sm:hidden"},"Disc %",-1)),i(e("input",{type:"number","onUpdate:modelValue":d=>s.discount_percent=d,min:"0",max:"100",step:"any",class:"w-full rounded-lg border-0 bg-slate-50 dark:bg-slate-800 py-2.5 text-xs text-slate-900 dark:text-white focus:ring-1 focus:ring-blue-500 text-right"},null,8,Z),[[p,s.discount_percent]])]),e("div",tt,[e("button",{type:"button",onClick:d=>U(m),class:"p-2 text-slate-500 hover:text-red-400 rounded-lg hover:bg-slate-700/50 transition-colors"},[n(o(M),{class:"h-4 w-4"})],8,et)])]))),128))]),e("div",st,[e("div",lt,[t[22]||(t[22]=e("span",{class:"text-slate-500 dark:text-slate-400 font-medium"},"Grand Total",-1)),e("span",rt,b(o(N)(q.value)),1)])])])]),e("div",ot,[t[23]||(t[23]=e("label",{class:"block text-sm font-medium text-slate-500 dark:text-slate-400 mb-2"},"Notes",-1)),i(e("textarea",{"onUpdate:modelValue":t[5]||(t[5]=s=>o(l).notes=s),rows:"3",class:"w-full rounded-xl border-0 bg-slate-50 dark:bg-slate-800 text-slate-900 dark:text-white focus:ring-2 focus:ring-blue-500/50",placeholder:"Optional notes..."},null,512),[[p,o(l).notes]])]),e("div",at,[n(o(y),{href:"/purchasing/orders",class:"px-6 py-2.5 rounded-xl bg-slate-50 dark:bg-slate-800 text-sm font-semibold text-slate-600 dark:text-slate-300 hover:bg-slate-700"},{default:f(()=>[...t[24]||(t[24]=[k("Cancel",-1)])]),_:1}),e("button",{type:"submit",class:"px-6 py-2.5 rounded-xl bg-blue-600 text-sm font-semibold text-white dark:text-white hover:bg-blue-500 shadow-lg shadow-blue-900/20",disabled:o(l).processing},b(o(l).processing?"Saving...":"Save Purchase Order"),9,dt)])],32)])]),_:1})],64))}};export{At as default};
