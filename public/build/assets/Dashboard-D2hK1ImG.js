import{r as u,w as L,a as N,c as d,b as o,u as r,h as j,d as _,o as i,e as t,t as l,k,F as y,g as A,B as F,n as p,f as B,v as z,D as I,G as P}from"./app-4JM5Q7Bz.js";import{_ as V}from"./AppLayout-CZ_34682.js";import{C as $,c as M,L as O,B as T,p as U,a as q,b as E,f as G}from"./index-BbyWG3Hf.js";import{b as H}from"./SunIcon-DGTVQmNn.js";import{r as R}from"./TruckIcon-f3zA02q_.js";import{r as J}from"./ClockIcon-CTlyPPog.js";import{r as K}from"./CalendarDaysIcon-B6KamO8i.js";import{r as Q}from"./XMarkIcon-DdWPYkX3.js";/* empty css            */import"./WrenchScrewdriverIcon-BG2Mj286.js";import"./CheckBadgeIcon-B3ZSWPVA.js";import"./ShoppingCartIcon-CMY99rVh.js";import"./CubeIcon-Dr5km-T0.js";const W={class:"flex justify-between items-center"},X={class:"flex items-center gap-2"},Y={key:0,class:"py-12"},Z={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},tt={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"},et={class:"bg-white dark:bg-slate-800 overflow-hidden shadow-xl sm:rounded-xl p-6 relative"},st={class:"flex justify-between items-start z-10 relative"},at={class:"text-3xl font-bold text-slate-900 dark:text-white mt-2"},lt={class:"p-3 bg-emerald-100 dark:bg-emerald-900/30 rounded-lg"},ot={class:"bg-white dark:bg-slate-800 overflow-hidden shadow-xl sm:rounded-xl p-6 relative"},dt={class:"flex justify-between items-start z-10 relative"},rt={class:"text-3xl font-bold text-slate-900 dark:text-white mt-2"},it={class:"p-3 bg-blue-100 dark:bg-blue-900/30 rounded-lg"},nt={class:"bg-white dark:bg-slate-800 overflow-hidden shadow-xl sm:rounded-xl p-6 relative"},ct={class:"flex justify-between items-start z-10 relative"},ut={class:"text-3xl font-bold text-red-600 dark:text-red-400 mt-2"},xt={class:"p-3 bg-red-100 dark:bg-red-900/30 rounded-lg"},mt={class:"bg-white dark:bg-slate-800 overflow-hidden shadow-xl sm:rounded-xl p-6 relative"},ht={class:"flex justify-between items-start z-10 relative"},bt={class:"text-3xl font-bold text-yellow-600 dark:text-yellow-400 mt-2"},gt={class:"p-3 bg-yellow-100 dark:bg-yellow-900/30 rounded-lg"},pt={class:"grid grid-cols-1 lg:grid-cols-3 gap-8"},vt={class:"lg:col-span-3 bg-white dark:bg-slate-800 overflow-hidden shadow-xl sm:rounded-xl p-6"},ft={class:"h-80 cursor-pointer"},_t={key:1,class:"fixed inset-0 z-50 overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true"},kt={class:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},yt={class:"inline-block align-bottom bg-white dark:bg-slate-800 rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-5xl sm:w-full"},wt={class:"px-4 pt-5 pb-4 sm:p-6 pb-4 bg-white dark:bg-slate-800"},Dt={class:"flex justify-between items-center mb-4"},Ct={class:"text-lg font-bold text-slate-900 dark:text-white"},St={key:0,class:"py-12 text-center"},Lt={key:1,class:"overflow-x-auto rounded-lg border border-slate-200 dark:border-slate-700"},Nt={class:"w-full text-left text-sm text-slate-600 dark:text-slate-400"},jt={class:"divide-y divide-slate-200 dark:divide-slate-700"},At={class:"px-4 py-3"},Ft={class:"font-medium text-slate-900 dark:text-white"},Bt={class:"text-xs text-slate-500"},zt={class:"px-4 py-3 text-right font-mono"},It={class:"px-4 py-3 text-right font-mono text-blue-600 dark:text-blue-400"},Pt={class:"px-4 py-3 text-right"},Vt={class:"flex items-center justify-end gap-2"},$t={class:"w-16 bg-slate-200 dark:bg-slate-700 rounded-full h-2"},Xt={__name:"Dashboard",props:{chartData:Array,stats:Object,month:String},setup(n){$.register(M,O,T,U,q,E);const c=n,x=u(c.month),m=u(!1),h=u([]),b=u(null),g=u(!1);L(x,s=>{N.get(route("planning.dashboard"),{month:s},{preserveState:!0,replace:!0})});const w=(s,e)=>{if(console.log("Chart Clicked",{event:s,elements:e}),e.length>0){const a=e[0].index,f=c.chartData[a];console.log("Selected Customer",f),D(f)}},D=async s=>{if(s){console.log("Opening details for",s.customer),b.value=s,m.value=!0,g.value=!0,h.value=[];try{const e=await P.get(route("planning.dashboard.details"),{params:{customer_id:s.id,month:x.value}});console.log("Details Data fetched",e.data),h.value=e.data}catch(e){console.error("Failed to fetch details:",e)}finally{g.value=!1}}},v=()=>{m.value=!1,b.value=null},C={responsive:!0,maintainAspectRatio:!1,onClick:w,interaction:{mode:"index",intersect:!1},onHover:(s,e)=>{s.native&&s.native.target&&(s.native.target.style.cursor=e.length>0?"pointer":"default")},plugins:{legend:{position:"top"},title:{display:!0,text:"Forecast vs Actual by Customer (Click bar to see items)"},tooltip:{mode:"index",intersect:!1,callbacks:{afterBody:s=>`
ðŸ‘‰ Click to see per-item accuracy`}}}},S=I(()=>c.chartData?{labels:c.chartData.map(s=>s.customer||"Unknown"),datasets:[{label:"Forecast",backgroundColor:"#10b981",data:c.chartData.map(s=>Number(s.forecast||0))},{label:"Actual",backgroundColor:"#3b82f6",data:c.chartData.map(s=>Number(s.actual||0))}]}:{labels:[],datasets:[]});return(s,e)=>(i(),d(y,null,[o(r(j),{title:"Sales Planning Dashboard"}),o(V,{title:"Sales Planning Dashboard"},{header:_(()=>[t("div",W,[e[2]||(e[2]=t("h2",{class:"font-semibold text-xl text-slate-800 dark:text-slate-200 leading-tight"}," Sales Planning Dashboard ",-1)),t("div",X,[e[1]||(e[1]=t("span",{class:"text-sm text-slate-500"},"Period:",-1)),B(t("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>x.value=a),type:"month",class:"rounded-lg border border-slate-300 dark:border-slate-600 dark:bg-slate-700 dark:text-white focus:ring-blue-500 focus:border-blue-500 text-sm"},null,512),[[z,x.value]])])])]),default:_(()=>[n.stats?(i(),d("div",Y,[t("div",Z,[t("div",tt,[t("div",et,[t("div",st,[t("div",null,[e[3]||(e[3]=t("p",{class:"text-sm font-medium text-slate-500 dark:text-slate-400"},"Total Forecast",-1)),t("p",at,l(Number(n.stats.total_forecast_qty).toLocaleString("id-ID")),1)]),t("div",lt,[o(r(H),{class:"w-6 h-6 text-emerald-600 dark:text-emerald-400"})])])]),t("div",ot,[t("div",dt,[t("div",null,[e[4]||(e[4]=t("p",{class:"text-sm font-medium text-slate-500 dark:text-slate-400"},"Total Actual",-1)),t("p",rt,l(Number(n.stats.total_actual_qty).toLocaleString("id-ID")),1)]),t("div",it,[o(r(R),{class:"w-6 h-6 text-blue-600 dark:text-blue-400"})])])]),t("div",nt,[t("div",ct,[t("div",null,[e[5]||(e[5]=t("p",{class:"text-sm font-medium text-slate-500 dark:text-slate-400"},"Delayed Schedules",-1)),t("p",ut,l(n.stats.delayed_schedules),1)]),t("div",xt,[o(r(J),{class:"w-6 h-6 text-red-600 dark:text-red-400"})])])]),t("div",mt,[t("div",ht,[t("div",null,[e[6]||(e[6]=t("p",{class:"text-sm font-medium text-slate-500 dark:text-slate-400"},"Upcoming (7 Days)",-1)),t("p",bt,l(n.stats.upcoming_schedules),1)]),t("div",gt,[o(r(K),{class:"w-6 h-6 text-yellow-600 dark:text-yellow-400"})])])])]),t("div",pt,[t("div",vt,[e[7]||(e[7]=t("h3",{class:"text-lg font-semibold text-slate-800 dark:text-slate-200 mb-4"},"Forecast vs Actual Performance",-1)),t("div",ft,[o(r(G),{data:S.value,options:C},null,8,["data"])])])])])])):k("",!0),m.value?(i(),d("div",_t,[t("div",kt,[t("div",{class:"fixed inset-0 bg-slate-900 bg-opacity-75 transition-opacity","aria-hidden":"true",onClick:v}),e[10]||(e[10]=t("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true"},"â€‹",-1)),t("div",yt,[t("div",wt,[t("div",Dt,[t("h3",Ct," Item Accuracy: "+l(b.value?.customer),1),t("button",{onClick:v,class:"text-slate-400 hover:text-slate-500"},[o(r(Q),{class:"w-6 h-6"})])]),g.value?(i(),d("div",St,[...e[8]||(e[8]=[t("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-4 border-slate-300 border-t-blue-600"},null,-1),t("p",{class:"mt-2 text-slate-500"},"Loading item data...",-1)])])):(i(),d("div",Lt,[t("table",Nt,[e[9]||(e[9]=t("thead",{class:"bg-slate-50 dark:bg-slate-700/50 text-xs uppercase font-semibold text-slate-500 dark:text-slate-300"},[t("tr",null,[t("th",{class:"px-4 py-3"},"Product Item"),t("th",{class:"px-4 py-3 text-right"},"Forecast"),t("th",{class:"px-4 py-3 text-right"},"Actual"),t("th",{class:"px-4 py-3 text-right"},"Achievement %"),t("th",{class:"px-4 py-3 text-right"},"Variance")])],-1)),t("tbody",jt,[(i(!0),d(y,null,A(h.value,a=>(i(),d("tr",{key:a.product_id,class:"hover:bg-slate-50 dark:hover:bg-slate-700/50"},[t("td",At,[t("div",Ft,l(a.name),1),t("div",Bt,l(a.sku),1)]),t("td",zt,l(Number(a.forecast).toLocaleString("id-ID"))+" "+l(a.unit),1),t("td",It,l(Number(a.actual).toLocaleString("id-ID"))+" "+l(a.unit),1),t("td",Pt,[t("div",Vt,[t("div",$t,[t("div",{class:p(["h-2 rounded-full",a.achievement>=100?"bg-emerald-500":a.achievement>=80?"bg-blue-500":"bg-red-500"]),style:F({width:Math.min(a.achievement,100)+"%"})},null,6)]),t("span",{class:p(["font-bold",a.achievement>=100?"text-emerald-500":a.achievement>=80?"text-blue-500":"text-red-500"])},l(a.achievement.toFixed(1))+"% ",3)])]),t("td",{class:p(["px-4 py-3 text-right font-mono",a.variance>=0?"text-emerald-600":"text-red-600"])},l(a.variance>0?"+":"")+l(Number(a.variance).toLocaleString("id-ID")),3)]))),128))])])]))])])])])):k("",!0)]),_:1})],64))}};export{Xt as default};
