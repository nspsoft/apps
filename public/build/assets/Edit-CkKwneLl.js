import{p as S,q as Q,c as u,b as i,u as o,h as j,d as g,e as t,l as v,j as f,y as F,f as p,o as c,F as k,g as y,t as b,i as N,v as x,k as P,D as h}from"./app-Bw0H9ESC.js";import{_ as D}from"./AppLayout-3pCOLbDy.js";import{_ as I}from"./SearchableSelect-CKVezNIi.js";import{a as _}from"./helpers-BjqMQcOq.js";import{r as T}from"./ArrowLeftIcon-bekBS0nw.js";import{r as A}from"./PlusIcon-Do9sa5h-.js";import{r as B}from"./TrashIcon-COMUNzPk.js";/* empty css            */import"./XMarkIcon-C7UzD_1X.js";import"./SunIcon-B4CySSBA.js";import"./WrenchScrewdriverIcon-DHxM4v6h.js";import"./CheckBadgeIcon-D_9l_0HZ.js";import"./ShoppingCartIcon-N-hkVahq.js";import"./CubeIcon-DrmTRc40.js";import"./TruckIcon-BJDri2b6.js";import"./transition-DxpzGklN.js";const E={class:"max-w-full px-4 sm:px-6 lg:px-8 mx-auto"},M={class:"grid grid-cols-1 xl:grid-cols-12 gap-6"},O={class:"xl:col-span-4 glass-card rounded-2xl p-6 space-y-4"},z=["value"],L=["value"],W={class:"xl:col-span-8 glass-card rounded-2xl p-6"},G={class:"flex items-center justify-between mb-4"},H={class:"space-y-2 max-h-[600px] overflow-y-auto custom-scrollbar relative pr-2"},J={class:"col-span-12 sm:col-span-5"},K={class:"col-span-4 sm:col-span-2"},R=["onUpdate:modelValue"],X={class:"col-span-4 sm:col-span-2"},Y=["onUpdate:modelValue"],Z={class:"col-span-4 sm:col-span-2"},tt={class:"w-full text-xs text-slate-900 dark:text-white font-bold text-right truncate"},et={class:"col-span-12 sm:col-span-1 flex justify-end"},st=["onClick"],lt={class:"mt-4 pt-4 border-t border-slate-200 dark:border-slate-800 flex justify-end"},ot={class:"text-right"},at={class:"text-xl font-bold text-slate-900 dark:text-white"},dt={class:"glass-card rounded-2xl p-6"},it={class:"flex justify-end gap-3"},rt=["disabled"],Vt={__name:"Edit",props:{quotation:Object,customers:Array,products:Array},setup(n){const d=n,l=S({customer_id:"",quotation_date:"",valid_until:"",notes:"",items:[]});Q(()=>{l.customer_id=d.quotation.customer_id,l.quotation_date=d.quotation.quotation_date.split("T")[0],l.valid_until=d.quotation.valid_until.split("T")[0],l.notes=d.quotation.notes,d.quotation.items&&d.quotation.items.length>0?l.items=d.quotation.items.map(a=>({product_id:a.product_id,qty:parseFloat(a.qty),unit_price:parseFloat(a.unit_price)})):l.items=[{product_id:"",qty:1,unit_price:0}]});const w=h(()=>d.products?d.products.filter(a=>a&&!a.name.startsWith("SO-")).map(a=>({id:a.id,label:`[${a.sku||"#"+a.id}] ${a.name}`})):[]),q=()=>{l.items.push({product_id:"",qty:1,unit_price:0})},V=(a,e)=>{if(!d.products)return;const s=d.products.find(m=>m.id===a.product_id);s&&(l.items[e].unit_price=parseFloat(s.selling_price||s.price||0))},C=a=>{l.items.splice(a,1)},U=h(()=>l.items.reduce((a,e)=>a+e.qty*e.unit_price,0)),$=()=>{l.put(`/sales/quotations/${d.quotation.id}`)};return(a,e)=>(c(),u(k,null,[i(o(j),{title:`Edit Quotation ${n.quotation.number}`},null,8,["title"]),i(D,{title:"Quotations"},{default:g(()=>[t("div",E,[i(o(v),{href:`/sales/quotations/${n.quotation.id}`,class:"inline-flex items-center gap-2 mb-4 text-sm text-slate-500 dark:text-slate-400 hover:text-slate-900 dark:text-white"},{default:g(()=>[i(o(T),{class:"h-4 w-4"}),e[4]||(e[4]=f(" Back to Detail ",-1))]),_:1},8,["href"]),t("form",{onSubmit:F($,["prevent"]),class:"space-y-6"},[t("div",M,[t("div",O,[e[10]||(e[10]=t("h3",{class:"text-lg font-semibold text-slate-900 dark:text-white mb-4"},"Edit Quotation Info",-1)),t("div",null,[e[5]||(e[5]=t("label",{class:"block text-sm font-medium text-slate-500 dark:text-slate-400 mb-1"},"Quotation Number",-1)),t("input",{type:"text",value:n.quotation.number,class:"w-full rounded-xl border-0 bg-slate-50 dark:bg-slate-900 dark:bg-slate-800/50 py-2.5 text-slate-500 dark:text-slate-400 cursor-not-allowed",disabled:""},null,8,z)]),t("div",null,[e[7]||(e[7]=t("label",{class:"block text-sm font-medium text-slate-500 dark:text-slate-400 mb-1"},"Customer",-1)),p(t("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>o(l).customer_id=s),class:"w-full rounded-xl border-0 bg-slate-50 dark:bg-slate-800 py-2.5 text-slate-900 dark:text-white focus:ring-2 focus:ring-blue-500/50",required:""},[e[6]||(e[6]=t("option",{value:""},"Select Customer",-1)),(c(!0),u(k,null,y(n.customers,s=>(c(),u("option",{key:s.id,value:s.id},b(s.name),9,L))),128))],512),[[N,o(l).customer_id]])]),t("div",null,[e[8]||(e[8]=t("label",{class:"block text-sm font-medium text-slate-500 dark:text-slate-400 mb-1"},"Quotation Date",-1)),p(t("input",{type:"date","onUpdate:modelValue":e[1]||(e[1]=s=>o(l).quotation_date=s),class:"w-full rounded-xl border-0 bg-slate-50 dark:bg-slate-800 py-2.5 text-slate-900 dark:text-white focus:ring-2 focus:ring-blue-500/50",required:""},null,512),[[x,o(l).quotation_date]])]),t("div",null,[e[9]||(e[9]=t("label",{class:"block text-sm font-medium text-slate-500 dark:text-slate-400 mb-1"},"Valid Until",-1)),p(t("input",{type:"date","onUpdate:modelValue":e[2]||(e[2]=s=>o(l).valid_until=s),class:"w-full rounded-xl border-0 bg-slate-50 dark:bg-slate-800 py-2.5 text-slate-900 dark:text-white focus:ring-2 focus:ring-blue-500/50",required:""},null,512),[[x,o(l).valid_until]])])]),t("div",W,[t("div",G,[e[12]||(e[12]=t("h3",{class:"text-lg font-semibold text-slate-900 dark:text-white"},"Items",-1)),t("button",{type:"button",onClick:q,class:"text-sm font-medium text-blue-400 hover:text-blue-300 flex items-center gap-1"},[i(o(A),{class:"h-4 w-4"}),e[11]||(e[11]=f(" Add Item ",-1))])]),t("div",H,[e[17]||(e[17]=t("div",{class:"hidden sm:grid grid-cols-12 gap-3 px-3 py-2 bg-slate-50 dark:bg-slate-900 dark:bg-slate-800/50 rounded-lg sticky top-0 z-10"},[t("div",{class:"col-span-5 text-[10px] font-bold text-slate-500 uppercase tracking-widest"},"Product"),t("div",{class:"col-span-2 text-[10px] font-bold text-slate-500 uppercase tracking-widest text-center"},"Qty"),t("div",{class:"col-span-2 text-[10px] font-bold text-slate-500 uppercase tracking-widest text-right"},"Unit Price"),t("div",{class:"col-span-2 text-[10px] font-bold text-slate-500 uppercase tracking-widest text-right"},"Subtotal"),t("div",{class:"col-span-1"})],-1)),(c(!0),u(k,null,y(o(l).items,(s,m)=>(c(),u("div",{key:m,class:"grid grid-cols-12 gap-3 items-center bg-slate-50 dark:bg-slate-800/10 p-2 rounded-xl hover:bg-slate-50 dark:hover:bg-slate-800/50 dark:bg-slate-800/30 transition-colors"},[t("div",J,[e[13]||(e[13]=t("label",{class:"sm:hidden block text-[10px] font-bold text-slate-500 uppercase mb-1"},"Product",-1)),i(I,{modelValue:s.product_id,"onUpdate:modelValue":r=>s.product_id=r,options:w.value,placeholder:"Search Product...",onChange:r=>V(s,m)},null,8,["modelValue","onUpdate:modelValue","options","onChange"])]),t("div",K,[e[14]||(e[14]=t("label",{class:"sm:hidden block text-[10px] font-bold text-slate-500 uppercase mb-1 text-center"},"Qty",-1)),p(t("input",{type:"number","onUpdate:modelValue":r=>s.qty=r,min:"0.0001",step:"any",class:"w-full rounded-lg border-0 bg-slate-50 dark:bg-slate-800 py-2.5 text-xs text-slate-900 dark:text-white focus:ring-1 focus:ring-blue-500 text-center",required:""},null,8,R),[[x,s.qty]])]),t("div",X,[e[15]||(e[15]=t("label",{class:"sm:hidden block text-[10px] font-bold text-slate-500 uppercase mb-1 text-right"},"Price",-1)),p(t("input",{type:"number","onUpdate:modelValue":r=>s.unit_price=r,step:"any",class:"w-full rounded-lg border-0 bg-slate-50 dark:bg-slate-800 py-2.5 text-xs text-slate-900 dark:text-white focus:ring-1 focus:ring-blue-500 text-right",required:""},null,8,Y),[[x,s.unit_price]])]),t("div",Z,[e[16]||(e[16]=t("label",{class:"sm:hidden block text-[10px] font-bold text-slate-500 uppercase mb-1 text-right"},"Subtotal",-1)),t("div",tt,b(o(_)(s.qty*s.unit_price)),1)]),t("div",et,[o(l).items.length>1?(c(),u("button",{key:0,type:"button",onClick:r=>C(m),class:"p-2 text-slate-600 hover:text-red-400"},[i(o(B),{class:"h-4 w-4"})],8,st)):P("",!0)])]))),128))]),t("div",lt,[t("div",ot,[e[18]||(e[18]=t("p",{class:"text-sm text-slate-500 dark:text-slate-400"},"Total",-1)),t("p",at,b(o(_)(U.value)),1)])])])]),t("div",dt,[e[19]||(e[19]=t("label",{class:"block text-sm font-medium text-slate-500 dark:text-slate-400 mb-2"},"Notes",-1)),p(t("textarea",{"onUpdate:modelValue":e[3]||(e[3]=s=>o(l).notes=s),rows:"2",class:"w-full rounded-xl border-0 bg-slate-50 dark:bg-slate-800 text-slate-900 dark:text-white focus:ring-2 focus:ring-blue-500/50",placeholder:"Optional notes..."},null,512),[[x,o(l).notes]])]),t("div",it,[i(o(v),{href:`/sales/quotations/${n.quotation.id}`,class:"px-6 py-2.5 rounded-xl bg-slate-50 dark:bg-slate-800 text-sm font-semibold text-slate-600 dark:text-slate-300 hover:bg-slate-700"},{default:g(()=>[...e[20]||(e[20]=[f("Cancel",-1)])]),_:1},8,["href"]),t("button",{type:"submit",class:"px-6 py-2.5 rounded-xl bg-blue-600 text-sm font-semibold text-white dark:text-white hover:bg-blue-500 shadow-lg shadow-blue-900/20",disabled:o(l).processing},b(o(l).processing?"Saving Changes...":"Save Changes"),9,rt)])],32)])]),_:1})],64))}};export{Vt as default};
