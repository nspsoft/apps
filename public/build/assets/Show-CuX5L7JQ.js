import{f as Q,c as i,a as b,u as l,h as H,w as _,b as e,l as S,t as n,n as m,d as y,o as d,e as v,x as D,y as R,p as J,F as w,g as I,j as f,k as K,v as k,B as q,s as A}from"./app-zJsw02vx.js";import{_ as Y}from"./AppLayout-D4BpQC0B.js";import{a as O}from"./helpers-DzPfLsau.js";import{r as W}from"./ArrowLeftIcon-BN2kMKgd.js";import{r as X}from"./PrinterIcon-BAxWU_Dw.js";import{r as T}from"./DocumentTextIcon-Bgyb8RGC.js";import{a as Z,r as ee}from"./DocumentPlusIcon-pDB4SSRv.js";import{r as C}from"./CubeIcon-CZD74TpM.js";import{r as F}from"./TruckIcon-DHPnLxIR.js";import{r as $}from"./MapPinIcon-CsgHsumu.js";import{r as te}from"./TrashIcon-XrsR0Tep.js";import{r as re}from"./CheckCircleIcon-BYy8QWv7.js";/* empty css            */import"./XMarkIcon-DfeFp9AX.js";import"./SunIcon-zdIWEs-R.js";import"./WrenchScrewdriverIcon-D_aAqD7I.js";import"./ShoppingCartIcon-BP7AbJ38.js";import"./SparklesIcon-Otaa2E01.js";import"./ClockIcon-C-qVshqO.js";import"./ShieldCheckIcon-6jFN3elY.js";const se={class:"max-w-7xl mx-auto"},le={class:"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-6"},ae={class:"flex items-center gap-4"},de={class:"flex items-center gap-3"},oe={class:"text-2xl font-bold text-slate-900 dark:text-white"},ie={class:"text-slate-500 text-sm mt-1"},ne={class:"flex items-center gap-3"},ce=["href"],ue=["disabled"],be=["disabled"],xe={class:"mb-8 px-4 md:px-8"},pe={class:"relative flex items-center justify-between"},me={key:0,class:"absolute inset-0 w-10 h-10 m-auto rounded-full bg-blue-400 animate-ping opacity-25 z-0"},ve={class:"absolute -bottom-8 flex flex-col items-center whitespace-nowrap"},ge={key:0,class:"text-[8px] font-bold text-blue-400 italic"},he={class:"grid grid-cols-1 lg:grid-cols-12 gap-6 mt-12"},fe={class:"lg:col-span-4 space-y-6"},ye={class:"rounded-2xl glass-card p-6 shadow-sm"},ke={class:"space-y-5"},_e=["value"],we={key:1,class:"text-sm font-medium text-slate-900 dark:text-white bg-slate-50 dark:bg-slate-900 dark:bg-slate-800/50 px-3 py-2.5 rounded-xl border border-slate-200 dark:border-slate-800"},Oe={key:0},Se={key:1,class:"text-sm font-medium text-slate-900 dark:text-white bg-slate-50 dark:bg-slate-900 dark:bg-slate-800/50 px-3 py-2.5 rounded-xl border border-slate-200 dark:border-slate-800"},De={key:1,class:"text-sm font-medium text-slate-900 dark:text-white bg-slate-50 dark:bg-slate-900 dark:bg-slate-800/50 px-3 py-2.5 rounded-xl border border-slate-200 dark:border-slate-800"},Ie={class:"pt-4 border-t border-slate-200 dark:border-slate-800/50"},Ce={class:"text-sm text-slate-900 dark:text-white font-bold"},Ve={class:"text-xs text-slate-500 dark:text-slate-400 mt-1 leading-relaxed"},Ne={class:"lg:col-span-8 space-y-6"},Re={class:"rounded-2xl glass-card overflow-hidden shadow-sm"},qe={class:"px-6 py-4 border-b border-slate-200 dark:border-slate-800 bg-slate-50 dark:bg-slate-800/20 flex items-center justify-between"},Ae={class:"text-[10px] font-bold text-slate-500 uppercase"},Te={class:"overflow-x-auto"},Fe={class:"w-full text-left"},$e={class:"divide-y divide-slate-100 dark:divide-slate-800"},Ue={class:"px-6 py-4"},Be={class:"text-sm font-bold text-slate-900 dark:text-white"},Ee={class:"text-[10px] text-slate-500 font-mono tracking-tight"},Me={class:"px-6 py-4 text-center text-sm text-slate-500 dark:text-slate-400 font-medium"},Pe={class:"px-6 py-4 text-center text-sm text-amber-500 font-bold bg-amber-500/5"},je={class:"px-6 py-4 text-center text-sm text-emerald-500 font-bold bg-emerald-500/5"},Ge={class:"px-6 py-4 text-center"},Le={key:0,class:"flex flex-col items-center gap-1"},ze=["onUpdate:modelValue","max"],Qe={key:0,class:"text-[9px] font-bold text-red-500 uppercase tracking-tight animate-pulse"},He={key:1,class:"text-[9px] text-slate-500 uppercase font-medium"},Je={key:1,class:"text-sm font-bold text-blue-400 bg-blue-400/10 px-3 py-1.5 rounded-xl border border-blue-400/20"},Ke={class:"px-6 py-4 text-xs font-bold text-slate-500"},Ye={class:"px-6 py-4"},We=["onUpdate:modelValue"],Xe={key:1,class:"text-[10px] text-slate-500 dark:text-slate-400 italic"},Ze={class:"px-6 py-4 text-right"},et=["onClick"],tt={class:"rounded-2xl glass-card p-6 shadow-sm"},rt={class:"flex items-center gap-3 mb-4"},st={key:0,class:"text-sm text-slate-500 dark:text-slate-400 italic bg-slate-50 dark:bg-slate-800/30 p-4 rounded-xl border border-slate-200 dark:border-slate-800/50"},lt={key:1,class:"text-xs text-slate-600 italic"},St={__name:"Show",props:{deliveryOrder:Object,vehicles:Array},setup(a){const u=a,o=Q({vehicle_id:u.deliveryOrder.vehicle_id||"",vehicle_number:u.deliveryOrder.vehicle_number||"",driver_name:u.deliveryOrder.driver_name||"",delivery_date:u.deliveryOrder.delivery_date?new Date(u.deliveryOrder.delivery_date).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],items:u.deliveryOrder.items.map(r=>({id:r.id,qty_delivered:parseFloat(r.qty_delivered),notes:r.notes||""}))}),U=()=>{const r=u.vehicles.find(t=>t.id===o.vehicle_id);r?(o.vehicle_number=r.license_plate,o.driver_name=r.driver_name||""):(o.vehicle_number="",o.driver_name="")},B=()=>{o.put(route("sales.deliveries.update-items",u.deliveryOrder.id),{preserveScroll:!0,onSuccess:()=>alert("Delivery updated successfully.")})},E=()=>{confirm("Are you sure you want to complete this delivery? This will reduce stock and update the Sales Order.")&&o.post(route("sales.deliveries.complete",u.deliveryOrder.id))},M=r=>{confirm("Yakin ingin menghapus item ini dari pengiriman sekarang? Item ini akan tetap tersedia untuk pengiriman berikutnya.")&&A.delete(route("sales.deliveries.destroy-item",r),{preserveScroll:!0})},P=r=>{confirm(`Update status delivery ini menjadi '${r.toUpperCase()}'?`)&&A.patch(route("sales.deliveries.update-status",u.deliveryOrder.id),{status:r},{preserveScroll:!0,onError:t=>alert("Gagal update status: "+JSON.stringify(t)),onSuccess:()=>{}})},g=r=>{const t=parseFloat(r.sales_order_item?.qty||0),s=parseFloat(r.sales_order_item?.qty_delivered||0),c=parseFloat(r.sales_order_item?.qty_returned||0),h=parseFloat(r.sales_order_item?.reserved_qty||0),N=s-c;if(u.deliveryOrder.status==="delivered")return t-(N-parseFloat(r.qty_delivered));const z=h-parseFloat(r.qty_delivered);return t-N-z},j=r=>r?new Date(r).toLocaleDateString("id-ID",{day:"2-digit",month:"long",year:"numeric"}):"-",G=r=>({draft:"bg-slate-500/20 text-slate-500 dark:text-slate-400 border-slate-500/30",picking:"bg-amber-500/20 text-amber-500 border-amber-500/30",packed:"bg-blue-500/20 text-blue-500 border-blue-500/30",shipped:"bg-purple-500/20 text-purple-400 border-purple-500/30",delivered:"bg-teal-500/20 text-teal-400 border-teal-500/30",completed:"bg-emerald-500/20 text-emerald-400 border-emerald-500/30",cancelled:"bg-red-500/20 text-red-400 border-red-500/30"})[r]||"bg-slate-500/20 text-slate-500 dark:text-slate-400 border-slate-500/30",V=[{label:"CREATE DO",status:"draft",icon:Z},{label:"LOADING",status:["picking","packed"],icon:C},{label:"SHIPPING",status:"shipped",icon:F},{label:"ARRIVED",status:"delivered",icon:$},{label:"VERIFIED",status:"completed",icon:ee}],x=q(()=>{const r=u.deliveryOrder.status;return r==="draft"?0:["picking","packed"].includes(r)?1:r==="shipped"?2:r==="delivered"?3:r==="completed"?4:-1}),p=q(()=>{switch(u.deliveryOrder.status){case"draft":return{label:"START LOADING",target:"picking",icon:C,color:"bg-gradient-to-r from-amber-600 to-amber-500 hover:from-amber-500 hover:to-amber-400 shadow-amber-500/30"};case"picking":return{label:"FINISH PACKING",target:"packed",icon:C,color:"bg-gradient-to-r from-blue-600 to-blue-500 hover:from-blue-500 hover:to-blue-400 shadow-blue-500/30"};case"packed":return{label:"SHIP ORDER",target:"shipped",icon:F,color:"bg-gradient-to-r from-indigo-600 to-indigo-500 hover:from-indigo-500 hover:to-indigo-400 shadow-indigo-500/30"};case"shipped":return{label:"ARRIVED AT LOCATION",target:"delivered",icon:$,color:"bg-gradient-to-r from-teal-600 to-teal-500 hover:from-teal-500 hover:to-teal-400 shadow-teal-500/30"};case"delivered":return{label:"CONFIRM & VERIFY",target:"completed",icon:re,color:"bg-gradient-to-r from-emerald-600 to-emerald-500 hover:from-emerald-500 hover:to-emerald-400 shadow-emerald-500/30"};default:return null}}),L=()=>{p.value&&(p.value.target==="completed"?E():P(p.value.target))};return(r,t)=>(d(),i(w,null,[b(l(H),{title:`Delivery Order ${a.deliveryOrder.do_number}`},null,8,["title"]),b(Y,{title:"Delivery Order Details"},{default:_(()=>[e("div",se,[e("div",le,[e("div",ae,[b(l(S),{href:r.route("sales.deliveries.index"),class:"p-2 rounded-xl bg-slate-50 dark:bg-slate-800 text-slate-500 dark:text-slate-400 hover:text-slate-900 dark:text-white transition-colors"},{default:_(()=>[b(l(W),{class:"h-5 w-5"})]),_:1},8,["href"]),e("div",null,[e("div",de,[e("h1",oe,n(a.deliveryOrder.do_number),1),e("span",{class:m(["px-2.5 py-0.5 rounded-full text-xs font-medium border uppercase",G(a.deliveryOrder.status)])},n(a.deliveryOrder.status),3)]),e("p",ie,[t[4]||(t[4]=y(" Reference: ",-1)),b(l(S),{href:r.route("sales.orders.show",a.deliveryOrder.sales_order_id),class:"text-blue-400 hover:underline font-medium"},{default:_(()=>[y(n(a.deliveryOrder.sales_order?.so_number),1)]),_:1},8,["href"])])])]),e("div",ne,[e("a",{href:r.route("sales.deliveries.print",a.deliveryOrder.id),target:"_blank",class:"flex items-center gap-2 rounded-xl bg-slate-50 dark:bg-slate-800 px-4 py-2.5 text-sm font-medium text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors border border-slate-200 dark:border-slate-700"},[b(l(X),{class:"h-4 w-4"}),t[5]||(t[5]=y(" Print SJ ",-1))],8,ce),a.deliveryOrder.status==="draft"?(d(),i("button",{key:0,onClick:B,disabled:!l(o).isDirty||l(o).processing,class:m(["flex items-center gap-2 rounded-xl px-4 py-2.5 text-sm font-semibold transition-all shadow-lg disabled:opacity-30 disabled:grayscale disabled:cursor-not-allowed",l(o).isDirty?"bg-blue-600 text-white hover:bg-blue-500 shadow-blue-500/20":"bg-slate-100 dark:bg-slate-800 text-slate-400 dark:text-slate-600 border border-slate-200 dark:border-slate-700"])}," Save Changes ",10,ue)):v("",!0),p.value?(d(),i("button",{key:1,onClick:L,disabled:l(o).isDirty||l(o).processing,class:m(["flex items-center gap-2 rounded-xl px-6 py-2.5 text-sm font-black uppercase tracking-wide text-white shadow-lg transition-all hover:scale-105 active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100",p.value.color])},[(d(),D(R(p.value.icon),{class:"h-5 w-5"})),y(" "+n(p.value.label),1)],10,be)):v("",!0),a.deliveryOrder.status==="completed"?(d(),D(l(S),{key:2,href:r.route("sales.deliveries.create-invoice",a.deliveryOrder.id),method:"post",as:"button",class:"flex items-center gap-2 rounded-xl bg-indigo-600 px-4 py-2.5 text-sm font-medium text-white hover:bg-indigo-500 transition-colors shadow-lg shadow-indigo-500/20"},{default:_(()=>[b(l(T),{class:"h-4 w-4"}),t[6]||(t[6]=y(" Create Invoice (This SJ) ",-1))]),_:1},8,["href"])):v("",!0)])]),e("div",xe,[e("div",pe,[t[7]||(t[7]=e("div",{class:"absolute left-0 top-1/2 -mt-px w-full h-0.5 bg-slate-100 dark:bg-slate-800"},null,-1)),e("div",{class:"absolute left-0 top-1/2 -mt-px h-0.5 bg-blue-500 transition-all duration-500",style:J({width:`${x.value/(V.length-1)*100}%`})},null,4),(d(),i(w,null,I(V,(s,c)=>e("div",{key:c,class:"relative flex flex-col items-center group"},[c===x.value?(d(),i("div",me)):v("",!0),e("div",{class:m(["w-10 h-10 rounded-full flex items-center justify-center border-4 transition-all duration-500 z-10 shadow-sm",[c<x.value?"bg-emerald-500 border-white dark:border-slate-900 text-white scale-100":c===x.value?"bg-blue-500 border-white dark:border-slate-900 text-white scale-125 shadow-lg shadow-blue-500/50 animate-pulse":"bg-white dark:bg-slate-900 border-slate-100 dark:border-slate-800 text-slate-300 dark:text-slate-700 scale-90 opacity-60"]])},[(d(),D(R(s.icon),{class:m(["w-5 h-5 transition-transform duration-500",{"rotate-12":c===x.value}])},null,8,["class"]))],2),e("div",ve,[e("span",{class:m(["text-[10px] font-black uppercase tracking-widest transition-all duration-500",[c<x.value?"text-emerald-500":c===x.value?"text-blue-500 scale-110":"text-slate-400 dark:text-slate-600"]])},n(s.label),3),c===1&&["picking","packed"].includes(a.deliveryOrder.status)?(d(),i("span",ge," ("+n(a.deliveryOrder.status)+") ",1)):v("",!0)])])),64))])]),e("div",he,[e("div",fe,[e("div",ye,[t[15]||(t[15]=e("h3",{class:"text-xs font-bold text-slate-500 uppercase tracking-widest mb-6"},"Delivery Information",-1)),e("div",ke,[e("div",null,[t[10]||(t[10]=e("label",{class:"block text-[10px] font-bold text-slate-500 uppercase tracking-tighter mb-1.5"},"No Truk (Vehicle)",-1)),a.deliveryOrder.status==="draft"?f((d(),i("select",{key:0,"onUpdate:modelValue":t[0]||(t[0]=s=>l(o).vehicle_id=s),onChange:U,class:"w-full rounded-xl border-0 bg-slate-50 dark:bg-slate-800 text-sm text-slate-900 dark:text-white focus:ring-2 focus:ring-blue-500/50"},[t[8]||(t[8]=e("option",{value:""},"-- Pilih Armada --",-1)),(d(!0),i(w,null,I(a.vehicles,s=>(d(),i("option",{key:s.id,value:s.id},n(s.license_plate)+" - "+n(s.vehicle_type),9,_e))),128)),t[9]||(t[9]=e("option",{value:"manual"},"-- Input Manual --",-1))],544)),[[K,l(o).vehicle_id]]):(d(),i("div",we,n(a.deliveryOrder.vehicle_number||"-"),1))]),l(o).vehicle_id==="manual"?(d(),i("div",Oe,[t[11]||(t[11]=e("label",{class:"block text-[10px] font-bold text-slate-500 uppercase tracking-tighter mb-1.5"},"Input No Truk Manual",-1)),f(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>l(o).vehicle_number=s),type:"text",placeholder:"e.g. B 1234 ABC",class:"w-full rounded-xl border-0 bg-slate-50 dark:bg-slate-800 text-sm text-slate-900 dark:text-white focus:ring-2 focus:ring-blue-500/50"},null,512),[[k,l(o).vehicle_number]])])):v("",!0),e("div",null,[t[12]||(t[12]=e("label",{class:"block text-[10px] font-bold text-slate-500 uppercase tracking-tighter mb-1.5"},"Sopir (Driver)",-1)),a.deliveryOrder.status==="draft"?f((d(),i("input",{key:0,"onUpdate:modelValue":t[2]||(t[2]=s=>l(o).driver_name=s),type:"text",placeholder:"e.g. Ahmad Sudarto",class:"w-full rounded-xl border-0 bg-slate-50 dark:bg-slate-800 text-sm text-slate-900 dark:text-white focus:ring-2 focus:ring-blue-500/50"},null,512)),[[k,l(o).driver_name]]):(d(),i("div",Se,n(a.deliveryOrder.driver_name||"-"),1))]),e("div",null,[t[13]||(t[13]=e("label",{class:"block text-[10px] font-bold text-slate-500 uppercase tracking-tighter mb-1.5"},"Tanggal Kirim",-1)),a.deliveryOrder.status==="draft"?f((d(),i("input",{key:0,"onUpdate:modelValue":t[3]||(t[3]=s=>l(o).delivery_date=s),type:"date",class:"w-full rounded-xl border-0 bg-slate-50 dark:bg-slate-800 text-sm text-slate-900 dark:text-white focus:ring-2 focus:ring-blue-500/50"},null,512)),[[k,l(o).delivery_date]]):(d(),i("div",De,n(j(a.deliveryOrder.delivery_date)),1))]),e("div",Ie,[t[14]||(t[14]=e("div",{class:"text-[10px] font-bold text-slate-500 uppercase tracking-tighter mb-1"},"Customer",-1)),e("div",Ce,n(a.deliveryOrder.sales_order?.customer?.name),1),e("div",Ve,n(a.deliveryOrder.shipping_address||a.deliveryOrder.sales_order?.shipping_address),1)])])])]),e("div",Ne,[e("div",Re,[e("div",qe,[t[16]||(t[16]=e("h3",{class:"text-xs font-bold text-slate-900 dark:text-white uppercase tracking-widest"},"Items to Deliver",-1)),e("div",Ae,"Warehouse: "+n(a.deliveryOrder.warehouse?.name),1)]),e("div",Te,[e("table",Fe,[t[17]||(t[17]=e("thead",null,[e("tr",{class:"bg-slate-50 dark:bg-slate-800/30"},[e("th",{class:"px-6 py-3 text-[10px] font-bold text-slate-500 uppercase tracking-tighter"},"Product"),e("th",{class:"px-6 py-3 text-[10px] font-bold text-slate-500 uppercase text-center tracking-tighter"},"SO Qty"),e("th",{class:"px-6 py-3 text-[10px] font-bold text-slate-500 uppercase text-center tracking-tighter"},"Sisa SO"),e("th",{class:"px-6 py-3 text-[10px] font-bold text-slate-500 uppercase text-center tracking-tighter"},"Qty Stock"),e("th",{class:"px-6 py-3 text-[10px] font-bold text-slate-500 uppercase text-center tracking-tighter"},"Send Qty"),e("th",{class:"px-6 py-3 text-[10px] font-bold text-slate-500 uppercase tracking-tighter"},"UOM"),e("th",{class:"px-6 py-3 text-[10px] font-bold text-slate-500 uppercase tracking-tighter"},"Remarks"),e("th",{class:"px-6 py-3 text-[10px] font-bold text-slate-500 uppercase text-right tracking-tighter"})])],-1)),e("tbody",$e,[(d(!0),i(w,null,I(a.deliveryOrder.items,(s,c)=>(d(),i("tr",{key:s.id,class:"hover:bg-slate-50 dark:hover:bg-slate-800/50 dark:bg-slate-800/10 transition-colors"},[e("td",Ue,[e("div",Be,n(s.product?.name),1),e("div",Ee,n(s.product?.sku),1)]),e("td",Me,n(l(O)(s.sales_order_item?.qty||s.qty_ordered)),1),e("td",Pe,n(l(O)(g(s))),1),e("td",je,n(l(O)(s.current_stock||0)),1),e("td",Ge,[a.deliveryOrder.status==="draft"?(d(),i("div",Le,[f(e("input",{"onUpdate:modelValue":h=>l(o).items[c].qty_delivered=h,type:"number",step:"any",min:"0",max:g(s),class:m(["w-24 rounded-xl border-0 bg-slate-50 dark:bg-slate-800 text-sm font-bold text-center focus:ring-2 focus:ring-blue-500/50",{"text-blue-400":l(o).items[c].qty_delivered<=g(s),"text-red-500 ring-2 ring-red-500/50 bg-red-500/10":l(o).items[c].qty_delivered>g(s)}])},null,10,ze),[[k,l(o).items[c].qty_delivered]]),l(o).items[c].qty_delivered>g(s)?(d(),i("div",Qe," Melebihi Sisa! ")):(d(),i("div",He," Max: "+n(g(s)),1))])):(d(),i("span",Je,n(l(O)(s.qty_delivered)),1))]),e("td",Ke,n(s.unit?.code||"PCS"),1),e("td",Ye,[a.deliveryOrder.status==="draft"?f((d(),i("input",{key:0,"onUpdate:modelValue":h=>l(o).items[c].notes=h,type:"text",placeholder:"catatan...",class:"w-full rounded-lg border-0 bg-slate-50 dark:bg-slate-800 text-[10px] text-slate-900 dark:text-white focus:ring-1 focus:ring-blue-500/50 py-1.5"},null,8,We)),[[k,l(o).items[c].notes]]):(d(),i("div",Xe,n(s.notes||"-"),1))]),e("td",Ze,[a.deliveryOrder.status==="draft"?(d(),i("button",{key:0,onClick:h=>M(s.id),class:"text-slate-500 hover:text-red-500 transition-colors p-2 rounded-xl hover:bg-red-500/10 group",title:"Remove Item"},[b(l(te),{class:"h-4 w-4 group-hover:scale-110 transition-transform"})],8,et)):v("",!0)])]))),128))])])])]),e("div",tt,[e("div",rt,[b(l(T),{class:"h-5 w-5 text-slate-500"}),t[18]||(t[18]=e("h3",{class:"text-xs font-bold text-slate-900 dark:text-white uppercase tracking-widest"},"Internal Notes",-1))]),a.deliveryOrder.notes?(d(),i("p",st,' "'+n(a.deliveryOrder.notes)+'" ',1)):(d(),i("p",lt,"No notes added to this delivery order."))])])])])]),_:1})],64))}};export{St as default};
